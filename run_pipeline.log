2025-09-27 11:09:52,998 INFO === RUN PIPELINE START 2025-09-27T09:09:52.998176 UTC ===
2025-09-27 11:09:52,998 INFO Stage=fetch attempt 1/2
2025-09-27 11:09:52,998 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:09:54,810 INFO Salida (1_fetch_indicators.py): returncode=1 (t=1.8s)
2025-09-27 11:09:54,810 WARNING stderr: Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 411, in <module>
    main()
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 308, in main
    cfg = load_config("config.yaml")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 126, in load_config
    user_cfg = yaml.safe_load(fh) or {}
               ^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\__init__.py", line 125, in safe_load
    return load(stream, SafeLoader)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\__init__.py", line 81, in load
    return loader.get_single_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\composer.py", line 39, in get_single_node
    if not self.check_event(StreamEndEvent):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\parser.py", line 98, in check_event
    self.current_event = self.state()
                         ^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\parser.py", line 171, in parse_document_start
    raise ParserError(None, None,
yaml.parser.ParserError: expected '<document start>', but found '<block mapping start>'
  in "config.yaml", line 2, column 1
2025-09-27 11:09:54,810 WARNING Stage fetch fallo con code=1
2025-09-27 11:09:54,811 INFO Reintentando en 5s...
2025-09-27 11:09:59,811 INFO Stage=fetch attempt 2/2
2025-09-27 11:09:59,811 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:10:00,766 INFO Salida (1_fetch_indicators.py): returncode=1 (t=1.0s)
2025-09-27 11:10:00,766 WARNING stderr: Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 411, in <module>
    main()
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 308, in main
    cfg = load_config("config.yaml")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 126, in load_config
    user_cfg = yaml.safe_load(fh) or {}
               ^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\__init__.py", line 125, in safe_load
    return load(stream, SafeLoader)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\__init__.py", line 81, in load
    return loader.get_single_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\composer.py", line 39, in get_single_node
    if not self.check_event(StreamEndEvent):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\parser.py", line 98, in check_event
    self.current_event = self.state()
                         ^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\yaml\parser.py", line 171, in parse_document_start
    raise ParserError(None, None,
yaml.parser.ParserError: expected '<document start>', but found '<block mapping start>'
  in "config.yaml", line 2, column 1
2025-09-27 11:10:00,766 WARNING Stage fetch fallo con code=1
2025-09-27 11:10:00,766 ERROR Stage=fetch falló después de 2 intentos.
2025-09-27 11:10:00,766 ERROR Pipeline abortado: Stage fetch failed after 2 attempts.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 135, in main
    run_stage("fetch", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage fetch failed after 2 attempts.
2025-09-27 11:10:00,770 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 11:10:52,844 INFO === RUN PIPELINE START 2025-09-27T09:10:52.844795 UTC ===
2025-09-27 11:10:52,844 INFO Stage=fetch attempt 1/2
2025-09-27 11:10:52,844 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:12:09,220 INFO Salida (1_fetch_indicators.py): returncode=0 (t=76.4s)
2025-09-27 11:12:09,220 WARNING stderr: 2025-09-27 11:10:53,696 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
2025-09-27 11:10:53,698 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 11:10:54,775 ERROR HTTP Error 404: 
2025-09-27 11:10:54,789 ERROR HTTP Error 404: 
2025-09-27 11:11:00,694 ERROR 
32 Failed downloads:
2025-09-27 11:11:00,694 ERROR ['BBSE3', 'CAP', 'ALO', 'BHIA3', 'BP.LS', 'AYDEN', 'BAYN', 'CHK', 'BC8', 'ANTM', 'ADS', 'BAS', 'CPFE3', 'AGUA', 'AMNB', 'CMIN3', 'CNC.MI', 'CBK', 'AIXA', 'ALFAA', 'CERN']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-27 11:11:00,694 ERROR ['AF', 'CIE', 'CEZ', 'ACS', 'COL', 'BNP', 'AYV', 'BMW', 'ANA', 'CABK']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 11:11:00,694 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758964343. The requested range must be within the last 60 days.")')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-27 11:11:02
2025-09-27 11:12:09,220 INFO Stage fetch completado correctamente.
2025-09-27 11:12:09,220 INFO === RUN PIPELINE END 2025-09-27T09:12:09.220905 UTC (duración 76.4 s) ===
2025-09-27 11:12:09,722 INFO Resumen candidatos: total=0 (preview):
2025-09-27 11:12:09,723 INFO Empty DataFrame
Columns: [TICKER, PRECIO, ATR 2H, EMA 15, EMA 50, EMA 150, MFI, RSI, ENTRADA 1, ENTRADA 2, STOP, TARGET 1, TARGET 2, MONTO, G/P, G/P POT%, _Score, Sector]
Index: []
2025-09-27 11:13:50,810 INFO === RUN PIPELINE START 2025-09-27T09:13:50.810993 UTC ===
2025-09-27 11:13:50,810 INFO Stage=fetch attempt 1/2
2025-09-27 11:13:50,810 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:14:24,311 INFO Salida (1_fetch_indicators.py): returncode=0 (t=33.5s)
2025-09-27 11:14:24,311 WARNING stderr: 2025-09-27 11:13:51,651 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 11:14:24,312 INFO Stage fetch completado correctamente.
2025-09-27 11:14:24,312 INFO === RUN PIPELINE END 2025-09-27T09:14:24.312616 UTC (duración 33.5 s) ===
2025-09-27 11:14:24,803 INFO Resumen candidatos: total=0 (preview):
2025-09-27 11:14:24,804 INFO Empty DataFrame
Columns: [TICKER, PRECIO, ATR 2H, EMA 15, EMA 50, EMA 150, MFI, RSI, ENTRADA 1, ENTRADA 2, STOP, TARGET 1, TARGET 2, MONTO, G/P, G/P POT%, _Score, Sector]
Index: []
2025-09-27 11:15:10,315 INFO === RUN PIPELINE START 2025-09-27T09:15:10.315453 UTC ===
2025-09-27 11:15:10,315 INFO Stage=fetch attempt 1/2
2025-09-27 11:15:10,315 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:15:42,925 INFO Salida (1_fetch_indicators.py): returncode=0 (t=32.6s)
2025-09-27 11:15:42,925 WARNING stderr: 2025-09-27 11:15:11,147 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 11:15:42,925 INFO Stage fetch completado correctamente.
2025-09-27 11:15:42,925 INFO Stage=score attempt 1/2
2025-09-27 11:15:42,925 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 11:15:43,780 INFO Salida (2_score_select.py): returncode=0 (t=0.9s)
2025-09-27 11:15:43,780 WARNING stderr: 2025-09-27 11:15:43,685 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 11:15:43,694 INFO Hard filters applied: passed=142 rejected=958 (total=1100)
2025-09-27 11:15:43,702 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 11:15:43,708 INFO Scoring computed. Score stats: min=14.26 median=21.49 max=62.05
2025-09-27 11:15:43,711 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 11:15:43,720 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 11:15:43,723 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 11:15:43,723 INFO SUMMARY: total_indicators=1100 passed=142 selected=20 rejected=958
2025-09-27 11:15:43,724 INFO Sector=COMMODITIES -> SGI, RNO.PA, STRL, YMM
2025-09-27 11:15:43,724 INFO Sector=ENERGIA -> BE, VAL, UGPA3.SA, NE
2025-09-27 11:15:43,724 INFO Sector=FINANCIERO -> LOW, TLN, NCLH, VLY
2025-09-27 11:15:43,724 INFO Sector=SALUD -> STAA, IMCR, ARGX.BR, ABT
2025-09-27 11:15:43,724 INFO Sector=TECNOLOGÍA -> FICO, SATS, WMG, CRDO
2025-09-27 11:15:43,781 INFO Stage score completado correctamente.
2025-09-27 11:15:43,781 INFO Stage=export attempt 1/2
2025-09-27 11:15:43,781 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:15:44,403 INFO Salida (3_export_sheets.py): returncode=1 (t=0.6s)
2025-09-27 11:15:44,403 WARNING stderr: Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 23, in <module>
    import gspread
ModuleNotFoundError: No module named 'gspread'
2025-09-27 11:15:44,403 WARNING Stage export fallo con code=1
2025-09-27 11:15:44,404 INFO Reintentando en 5s...
2025-09-27 11:15:49,405 INFO Stage=export attempt 2/2
2025-09-27 11:15:49,405 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:15:50,014 INFO Salida (3_export_sheets.py): returncode=1 (t=0.6s)
2025-09-27 11:15:50,014 WARNING stderr: Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 23, in <module>
    import gspread
ModuleNotFoundError: No module named 'gspread'
2025-09-27 11:15:50,014 WARNING Stage export fallo con code=1
2025-09-27 11:15:50,015 ERROR Stage=export falló después de 2 intentos.
2025-09-27 11:15:50,015 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 11:15:50,018 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 11:23:48,179 INFO === RUN PIPELINE START 2025-09-27T09:23:48.179144 UTC ===
2025-09-27 11:23:48,179 INFO Stage=fetch attempt 1/2
2025-09-27 11:23:48,179 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:24:33,486 INFO Salida (1_fetch_indicators.py): returncode=0 (t=45.3s)
2025-09-27 11:24:33,486 WARNING stderr: 2025-09-27 11:23:49,188 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 11:24:33,487 INFO Stage fetch completado correctamente.
2025-09-27 11:24:33,487 INFO Stage=score attempt 1/2
2025-09-27 11:24:33,487 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 11:24:34,544 INFO Salida (2_score_select.py): returncode=0 (t=1.1s)
2025-09-27 11:24:34,544 WARNING stderr: 2025-09-27 11:24:34,388 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 11:24:34,400 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 11:24:34,410 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 11:24:34,419 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 11:24:34,422 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 11:24:34,432 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 11:24:34,436 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 11:24:34,436 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 11:24:34,437 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 11:24:34,437 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 11:24:34,437 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 11:24:34,438 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 11:24:34,438 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 11:24:34,545 INFO Stage score completado correctamente.
2025-09-27 11:24:34,545 INFO Stage=export attempt 1/2
2025-09-27 11:24:34,545 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:24:36,851 INFO Salida (3_export_sheets.py): returncode=1 (t=2.3s)
2025-09-27 11:24:36,851 WARNING stderr: Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 24, in <module>
    from gspread_formatting import format_cell_range, cellFormat, textFormat
ModuleNotFoundError: No module named 'gspread_formatting'
2025-09-27 11:24:36,851 WARNING Stage export fallo con code=1
2025-09-27 11:24:36,851 INFO Reintentando en 5s...
2025-09-27 11:24:41,853 INFO Stage=export attempt 2/2
2025-09-27 11:24:41,853 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:24:43,156 INFO Salida (3_export_sheets.py): returncode=1 (t=1.3s)
2025-09-27 11:24:43,156 WARNING stderr: Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 24, in <module>
    from gspread_formatting import format_cell_range, cellFormat, textFormat
ModuleNotFoundError: No module named 'gspread_formatting'
2025-09-27 11:24:43,156 WARNING Stage export fallo con code=1
2025-09-27 11:24:43,156 ERROR Stage=export falló después de 2 intentos.
2025-09-27 11:24:43,156 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 11:24:43,161 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 11:26:21,703 INFO === RUN PIPELINE START 2025-09-27T09:26:21.703536 UTC ===
2025-09-27 11:26:21,703 INFO Stage=fetch attempt 1/2
2025-09-27 11:26:21,703 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:27:42,534 INFO Salida (1_fetch_indicators.py): returncode=0 (t=80.8s)
2025-09-27 11:27:42,534 WARNING stderr: 2025-09-27 11:26:22,622 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-09-27 11:26:22,629 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-09-27 11:26:22,637 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 11:26:24,086 ERROR HTTP Error 404: 
2025-09-27 11:26:29,812 ERROR 
32 Failed downloads:
2025-09-27 11:26:29,812 ERROR ['CEZ', 'ANA', 'AYV', 'COL', 'ACS', 'CABK', 'AF', 'CIE', 'BNP', 'BMW']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 11:26:29,812 ERROR ['CERN', 'BAS', 'CHK', 'BHIA3', 'CPFE3', 'BBSE3', 'BAYN', 'ALO', 'CNC.MI', 'CMIN3', 'CBK', 'CAP', 'BP.LS', 'AYDEN', 'ANTM', 'ALFAA', 'ADS', 'AGUA', 'AMNB', 'BC8', 'AIXA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-27 11:26:29,812 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758965271. The requested range must be within the last 60 days.")')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a futu
2025-09-27 11:27:42,534 INFO Stage fetch completado correctamente.
2025-09-27 11:27:42,534 INFO Stage=score attempt 1/2
2025-09-27 11:27:42,534 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 11:27:43,310 INFO Salida (2_score_select.py): returncode=0 (t=0.8s)
2025-09-27 11:27:43,310 WARNING stderr: 2025-09-27 11:27:43,204 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 11:27:43,214 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 11:27:43,222 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 11:27:43,228 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 11:27:43,233 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 11:27:43,241 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 11:27:43,244 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 11:27:43,244 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 11:27:43,245 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 11:27:43,245 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 11:27:43,245 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 11:27:43,245 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 11:27:43,245 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 11:27:43,310 INFO Stage score completado correctamente.
2025-09-27 11:27:43,310 INFO Stage=export attempt 1/2
2025-09-27 11:27:43,310 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:27:44,683 INFO Salida (3_export_sheets.py): returncode=1 (t=1.4s)
2025-09-27 11:27:44,683 WARNING stderr: 2025-09-27 11:27:44,585 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 317, in <module>
    main()
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 192, in main
    gc = gspread_auth(cfg.get("creds_path"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 80, in gspread_auth
    raise FileNotFoundError(f"Service account JSON not found at {creds_path}")
FileNotFoundError: Service account JSON not found at creds/gsheets-service.json
2025-09-27 11:27:44,683 WARNING Stage export fallo con code=1
2025-09-27 11:27:44,683 INFO Reintentando en 5s...
2025-09-27 11:27:49,685 INFO Stage=export attempt 2/2
2025-09-27 11:27:49,685 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:27:51,082 INFO Salida (3_export_sheets.py): returncode=1 (t=1.4s)
2025-09-27 11:27:51,082 WARNING stderr: 2025-09-27 11:27:50,987 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 317, in <module>
    main()
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 192, in main
    gc = gspread_auth(cfg.get("creds_path"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 80, in gspread_auth
    raise FileNotFoundError(f"Service account JSON not found at {creds_path}")
FileNotFoundError: Service account JSON not found at creds/gsheets-service.json
2025-09-27 11:27:51,082 WARNING Stage export fallo con code=1
2025-09-27 11:27:51,082 ERROR Stage=export falló después de 2 intentos.
2025-09-27 11:27:51,082 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 11:27:51,086 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 11:29:04,883 INFO === RUN PIPELINE START 2025-09-27T09:29:04.883345 UTC ===
2025-09-27 11:29:04,883 INFO Stage=fetch attempt 1/2
2025-09-27 11:29:04,884 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:29:37,846 INFO Salida (1_fetch_indicators.py): returncode=0 (t=33.0s)
2025-09-27 11:29:37,846 WARNING stderr: 2025-09-27 11:29:05,760 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 11:29:37,846 INFO Stage fetch completado correctamente.
2025-09-27 11:29:37,846 INFO Stage=score attempt 1/2
2025-09-27 11:29:37,846 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 11:29:38,570 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 11:29:38,570 WARNING stderr: 2025-09-27 11:29:38,471 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 11:29:38,480 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 11:29:38,489 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 11:29:38,495 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 11:29:38,497 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 11:29:38,506 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 11:29:38,508 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 11:29:38,508 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 11:29:38,509 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 11:29:38,509 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 11:29:38,509 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 11:29:38,509 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 11:29:38,510 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 11:29:38,570 INFO Stage score completado correctamente.
2025-09-27 11:29:38,570 INFO Stage=export attempt 1/2
2025-09-27 11:29:38,570 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:29:40,211 INFO Salida (3_export_sheets.py): returncode=1 (t=1.6s)
2025-09-27 11:29:40,211 WARNING stderr: 2025-09-27 11:29:39,704 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
Traceback (most recent call last):
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread_formatting\functions.py", line 175, in fetch_sheet_metadata
    r = self.client.request('get', url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [403]: Google Sheets API has not been used in project 665072971517 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=665072971517 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 317, in <module>
    main()
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 193, in main
    sh = gc.open_by_key(cfg.get("spreadsheet_id"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\client.py", line 173, in open_by_key
    raise PermissionError from ex
PermissionError
2025-09-27 11:29:40,211 WARNING Stage export fallo con code=1
2025-09-27 11:29:40,211 INFO Reintentando en 5s...
2025-09-27 11:29:45,213 INFO Stage=export attempt 2/2
2025-09-27 11:29:45,213 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:29:46,883 INFO Salida (3_export_sheets.py): returncode=1 (t=1.7s)
2025-09-27 11:29:46,883 WARNING stderr: 2025-09-27 11:29:46,404 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
Traceback (most recent call last):
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread_formatting\functions.py", line 175, in fetch_sheet_metadata
    r = self.client.request('get', url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [403]: Google Sheets API has not been used in project 665072971517 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/sheets.googleapis.com/overview?project=665072971517 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 317, in <module>
    main()
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 193, in main
    sh = gc.open_by_key(cfg.get("spreadsheet_id"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\gspread\client.py", line 173, in open_by_key
    raise PermissionError from ex
PermissionError
2025-09-27 11:29:46,883 WARNING Stage export fallo con code=1
2025-09-27 11:29:46,883 ERROR Stage=export falló después de 2 intentos.
2025-09-27 11:29:46,883 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 11:29:46,887 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 11:36:39,588 INFO === RUN PIPELINE START 2025-09-27T09:36:39.588073 UTC ===
2025-09-27 11:36:39,589 INFO Stage=fetch attempt 1/2
2025-09-27 11:36:39,589 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:37:11,823 INFO Salida (1_fetch_indicators.py): returncode=0 (t=32.2s)
2025-09-27 11:37:11,823 WARNING stderr: 2025-09-27 11:36:40,474 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 11:37:11,823 INFO Stage fetch completado correctamente.
2025-09-27 11:37:11,823 INFO Stage=score attempt 1/2
2025-09-27 11:37:11,823 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 11:37:12,549 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 11:37:12,549 WARNING stderr: 2025-09-27 11:37:12,455 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 11:37:12,464 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 11:37:12,472 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 11:37:12,478 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 11:37:12,481 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 11:37:12,489 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 11:37:12,491 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 11:37:12,492 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 11:37:12,492 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 11:37:12,492 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 11:37:12,492 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 11:37:12,493 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 11:37:12,493 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 11:37:12,549 INFO Stage score completado correctamente.
2025-09-27 11:37:12,549 INFO Stage=export attempt 1/2
2025-09-27 11:37:12,550 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:37:18,008 INFO Salida (3_export_sheets.py): returncode=0 (t=5.5s)
2025-09-27 11:37:18,009 WARNING stderr: 2025-09-27 11:37:13,672 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
2025-09-27 11:37:14,463 INFO Opened spreadsheet OK
2025-09-27 11:37:14,656 INFO Worksheet 'energía' not found. Creating it.
2025-09-27 11:37:14,919 ERROR Cannot ensure worksheet 'energía': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "energía" already exists. Please enter another name.
2025-09-27 11:37:15,128 INFO Worksheet 'salud' not found. Creating it.
2025-09-27 11:37:15,372 ERROR Cannot ensure worksheet 'salud': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "salud" already exists. Please enter another name.
2025-09-27 11:37:15,594 INFO Worksheet 'commodites' not found. Creating it.
2025-09-27 11:37:16,924 INFO No candidates for sector 'commodites'. Skipping.
2025-09-27 11:37:17,145 INFO Worksheet 'financiero' not found. Creating it.
2025-09-27 11:37:17,402 ERROR Cannot ensure worksheet 'financiero': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "financiero" already exists. Please enter another name.
2025-09-27 11:37:17,605 INFO Worksheet 'tecnología' not found. Creating it.
2025-09-27 11:37:17,926 ERROR Cannot ensure worksheet 'tecnología': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "tecnología" already exists. Please enter another name.
2025-09-27 11:37:17,927 INFO Export finished.
2025-09-27 11:37:18,009 INFO Stage export completado correctamente.
2025-09-27 11:37:18,009 INFO === RUN PIPELINE END 2025-09-27T09:37:18.009190 UTC (duración 38.4 s) ===
2025-09-27 11:37:18,491 INFO Resumen candidatos: total=20 (preview):
2025-09-27 11:37:18,498 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102519   60.305638 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 11:52:20,162 INFO === RUN PIPELINE START 2025-09-27T09:52:20.162916 UTC ===
2025-09-27 11:52:20,162 INFO Stage=fetch attempt 1/2
2025-09-27 11:52:20,163 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 11:53:33,919 INFO Salida (1_fetch_indicators.py): returncode=0 (t=73.8s)
2025-09-27 11:53:33,919 WARNING stderr: 2025-09-27 11:52:21,071 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
2025-09-27 11:52:21,082 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 11:52:22,189 ERROR HTTP Error 404: 
2025-09-27 11:52:22,536 ERROR HTTP Error 404: 
2025-09-27 11:52:28,070 ERROR 
32 Failed downloads:
2025-09-27 11:52:28,070 ERROR ['ANA', 'COL', 'AF', 'CABK', 'CIE', 'BNP', 'AYV', 'ACS', 'CEZ', 'BMW']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 11:52:28,070 ERROR ['AMNB', 'BP.LS', 'AIXA', 'BBSE3', 'CNC.MI', 'CPFE3', 'CMIN3', 'BAYN', 'ALO', 'BHIA3', 'BAS', 'CHK', 'ANTM', 'BC8', 'CERN', 'ADS', 'AGUA', 'CBK', 'AYDEN', 'CAP', 'ALFAA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-27 11:52:28,070 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758966831. The requested range must be within the last 60 days.")')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-27 11:52:29
2025-09-27 11:53:33,919 INFO Stage fetch completado correctamente.
2025-09-27 11:53:33,919 INFO Stage=score attempt 1/2
2025-09-27 11:53:33,919 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 11:53:34,631 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 11:53:34,631 WARNING stderr: 2025-09-27 11:53:34,535 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 11:53:34,545 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 11:53:34,552 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 11:53:34,558 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 11:53:34,561 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 11:53:34,569 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 11:53:34,572 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 11:53:34,572 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 11:53:34,573 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 11:53:34,573 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 11:53:34,573 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 11:53:34,573 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 11:53:34,573 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 11:53:34,631 INFO Stage score completado correctamente.
2025-09-27 11:53:34,631 INFO Stage=export attempt 1/2
2025-09-27 11:53:34,631 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:53:38,955 INFO Salida (3_export_sheets.py): returncode=1 (t=4.3s)
2025-09-27 11:53:38,955 WARNING stderr: 2025-09-27 11:53:35,779 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
2025-09-27 11:53:36,441 INFO Opened spreadsheet OK
2025-09-27 11:53:36,852 INFO Worksheet 'energía' not found. Creating it.
2025-09-27 11:53:37,088 ERROR Cannot ensure worksheet 'energía': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "energía" already exists. Please enter another name.
2025-09-27 11:53:37,507 INFO Worksheet 'salud' not found. Creating it.
2025-09-27 11:53:37,740 ERROR Cannot ensure worksheet 'salud': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "salud" already exists. Please enter another name.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 259, in <module>
    main()
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 199, in main
    sector_candidates = candidates[candidates['Sector'].astype(str).upper() == sheet_name.upper()].copy()
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\pandas\core\generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Series' object has no attribute 'upper'
2025-09-27 11:53:38,955 WARNING Stage export fallo con code=1
2025-09-27 11:53:38,955 INFO Reintentando en 5s...
2025-09-27 11:53:43,955 INFO Stage=export attempt 2/2
2025-09-27 11:53:43,955 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 11:53:48,111 INFO Salida (3_export_sheets.py): returncode=1 (t=4.2s)
2025-09-27 11:53:48,111 WARNING stderr: 2025-09-27 11:53:45,096 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
2025-09-27 11:53:45,544 INFO Opened spreadsheet OK
2025-09-27 11:53:45,962 INFO Worksheet 'energía' not found. Creating it.
2025-09-27 11:53:46,242 ERROR Cannot ensure worksheet 'energía': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "energía" already exists. Please enter another name.
2025-09-27 11:53:46,643 INFO Worksheet 'salud' not found. Creating it.
2025-09-27 11:53:46,881 ERROR Cannot ensure worksheet 'salud': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "salud" already exists. Please enter another name.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 259, in <module>
    main()
  File "a:\pilim\desktop\financiero\3_export_sheets.py", line 199, in main
    sector_candidates = candidates[candidates['Sector'].astype(str).upper() == sheet_name.upper()].copy()
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pilim\AppData\Roaming\Python\Python312\site-packages\pandas\core\generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Series' object has no attribute 'upper'
2025-09-27 11:53:48,111 WARNING Stage export fallo con code=1
2025-09-27 11:53:48,111 ERROR Stage=export falló después de 2 intentos.
2025-09-27 11:53:48,111 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
  File "a:\pilim\desktop\financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 11:53:48,115 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 12:17:47,939 INFO === RUN PIPELINE START 2025-09-27T10:17:47.939296 UTC ===
2025-09-27 12:17:47,943 INFO Stage=fetch attempt 1/2
2025-09-27 12:17:47,945 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 12:19:06,692 INFO Salida (1_fetch_indicators.py): returncode=0 (t=78.7s)
2025-09-27 12:19:06,693 WARNING stderr: 2025-09-27 12:17:48,914 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
2025-09-27 12:17:48,925 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 12:17:55,753 ERROR 
32 Failed downloads:
2025-09-27 12:17:55,753 ERROR ['BMW', 'CEZ', 'ACS', 'AYV', 'CABK', 'CIE', 'ANA', 'AF', 'COL', 'BNP']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 12:17:55,753 ERROR ['BHIA3', 'ALFAA', 'CBK', 'AGUA', 'AMNB', 'ADS', 'CERN', 'CAP', 'BC8', 'BP.LS', 'CHK', 'ANTM', 'CMIN3', 'AIXA', 'BAS', 'BAYN', 'CPFE3', 'AYDEN', 'ALO', 'BBSE3', 'CNC.MI']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-27 12:17:55,753 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758968359. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-27 12:17:57,380 ERROR 
1 Failed download:
2025-09-27 12:17:57,380 ERROR ['ACS']: YFPricesMissingError('po
2025-09-27 12:19:06,694 INFO Stage fetch completado correctamente.
2025-09-27 12:19:06,695 INFO Stage=score attempt 1/2
2025-09-27 12:19:06,696 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 12:19:07,431 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 12:19:07,432 WARNING stderr: 2025-09-27 12:19:07,329 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 12:19:07,338 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 12:19:07,347 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 12:19:07,353 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 12:19:07,355 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 12:19:07,363 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 12:19:07,366 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 12:19:07,366 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 12:19:07,367 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 12:19:07,367 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 12:19:07,367 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 12:19:07,367 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 12:19:07,367 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 12:19:07,432 INFO Stage score completado correctamente.
2025-09-27 12:19:07,433 INFO Stage=export attempt 1/2
2025-09-27 12:19:07,434 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 12:19:12,609 INFO Salida (3_export_sheets.py): returncode=0 (t=5.2s)
2025-09-27 12:19:12,610 WARNING stderr: 2025-09-27 12:19:08,636 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
2025-09-27 12:19:09,786 INFO Opened spreadsheet OK
2025-09-27 12:19:10,001 INFO Worksheet 'energía' not found. Creating it.
2025-09-27 12:19:10,256 ERROR Cannot ensure worksheet 'energía': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "energía" already exists. Please enter another name.
2025-09-27 12:19:10,472 INFO Worksheet 'salud' not found. Creating it.
2025-09-27 12:19:10,707 ERROR Cannot ensure worksheet 'salud': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "salud" already exists. Please enter another name.
2025-09-27 12:19:11,625 INFO No candidates for sector 'commodites'. Skipping.
2025-09-27 12:19:11,852 INFO Worksheet 'financiero' not found. Creating it.
2025-09-27 12:19:12,089 ERROR Cannot ensure worksheet 'financiero': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "financiero" already exists. Please enter another name.
2025-09-27 12:19:12,309 INFO Worksheet 'tecnología' not found. Creating it.
2025-09-27 12:19:12,522 ERROR Cannot ensure worksheet 'tecnología': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "tecnología" already exists. Please enter another name.
2025-09-27 12:19:12,522 INFO Export finished.
2025-09-27 12:19:12,611 INFO Stage export completado correctamente.
2025-09-27 12:19:12,612 INFO === RUN PIPELINE END 2025-09-27T10:19:12.612401 UTC (duración 84.7 s) ===
2025-09-27 12:19:12,637 INFO Resumen candidatos: total=20 (preview):
2025-09-27 12:19:12,647 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 12:24:43,875 INFO === RUN PIPELINE START 2025-09-27T10:24:43.875924 UTC ===
2025-09-27 12:24:43,875 INFO Stage=fetch attempt 1/2
2025-09-27 12:24:43,875 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 12:25:18,351 INFO Salida (1_fetch_indicators.py): returncode=0 (t=34.5s)
2025-09-27 12:25:18,351 WARNING stderr: 2025-09-27 12:24:44,755 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 12:25:18,352 INFO Stage fetch completado correctamente.
2025-09-27 12:25:18,352 INFO Stage=score attempt 1/2
2025-09-27 12:25:18,352 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 12:25:19,091 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 12:25:19,091 WARNING stderr: 2025-09-27 12:25:18,997 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 12:25:19,006 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 12:25:19,014 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 12:25:19,021 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 12:25:19,023 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 12:25:19,030 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 12:25:19,033 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 12:25:19,033 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 12:25:19,034 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 12:25:19,034 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 12:25:19,034 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 12:25:19,034 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 12:25:19,034 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 12:25:19,091 INFO Stage score completado correctamente.
2025-09-27 12:25:19,092 INFO Stage=export attempt 1/2
2025-09-27 12:25:19,092 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 12:25:24,371 INFO Salida (3_export_sheets.py): returncode=0 (t=5.3s)
2025-09-27 12:25:24,371 WARNING stderr: 2025-09-27 12:25:20,268 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
2025-09-27 12:25:21,495 INFO Opened spreadsheet OK
2025-09-27 12:25:21,717 INFO Worksheet 'energía' no encontrada. Creando nueva.
2025-09-27 12:25:21,964 ERROR Cannot ensure worksheet 'energía': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "energía" already exists. Please enter another name.
2025-09-27 12:25:22,185 INFO Worksheet 'salud' no encontrada. Creando nueva.
2025-09-27 12:25:22,411 ERROR Cannot ensure worksheet 'salud': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "salud" already exists. Please enter another name.
2025-09-27 12:25:23,373 INFO No candidates for sector 'commodites'. Skipping.
2025-09-27 12:25:23,582 INFO Worksheet 'financiero' no encontrada. Creando nueva.
2025-09-27 12:25:23,818 ERROR Cannot ensure worksheet 'financiero': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "financiero" already exists. Please enter another name.
2025-09-27 12:25:24,044 INFO Worksheet 'tecnología' no encontrada. Creando nueva.
2025-09-27 12:25:24,281 ERROR Cannot ensure worksheet 'tecnología': APIError: [400]: Invalid requests[0].addSheet: A sheet with the name "tecnología" already exists. Please enter another name.
2025-09-27 12:25:24,281 INFO Export finished.
2025-09-27 12:25:24,372 INFO Stage export completado correctamente.
2025-09-27 12:25:24,372 INFO === RUN PIPELINE END 2025-09-27T10:25:24.372854 UTC (duración 40.5 s) ===
2025-09-27 12:25:24,858 INFO Resumen candidatos: total=20 (preview):
2025-09-27 12:25:24,864 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 12:26:02,659 INFO === RUN PIPELINE START 2025-09-27T10:26:02.659726 UTC ===
2025-09-27 12:26:02,659 INFO Stage=fetch attempt 1/2
2025-09-27 12:26:02,659 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 12:26:35,266 INFO Salida (1_fetch_indicators.py): returncode=0 (t=32.6s)
2025-09-27 12:26:35,266 WARNING stderr: 2025-09-27 12:26:03,528 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 12:26:35,267 INFO Stage fetch completado correctamente.
2025-09-27 12:26:35,267 INFO Stage=score attempt 1/2
2025-09-27 12:26:35,267 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 12:26:36,030 INFO Salida (2_score_select.py): returncode=0 (t=0.8s)
2025-09-27 12:26:36,030 WARNING stderr: 2025-09-27 12:26:35,929 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 12:26:35,938 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 12:26:35,946 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 12:26:35,952 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 12:26:35,955 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 12:26:35,963 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 12:26:35,965 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 12:26:35,965 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 12:26:35,966 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 12:26:35,966 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 12:26:35,966 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 12:26:35,966 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 12:26:35,967 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 12:26:36,030 INFO Stage score completado correctamente.
2025-09-27 12:26:36,030 INFO Stage=export attempt 1/2
2025-09-27 12:26:36,030 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 12:26:43,517 INFO Salida (3_export_sheets.py): returncode=0 (t=7.5s)
2025-09-27 12:26:43,517 WARNING stderr: 2025-09-27 12:26:37,212 INFO Loaded sheet-ready candidates CSV: intermediate/candidates.sheet_ready.csv (rows=20)
2025-09-27 12:26:37,730 INFO Opened spreadsheet OK
2025-09-27 12:26:38,890 INFO No candidates for sector 'energía'. Skipping.
2025-09-27 12:26:39,974 INFO No candidates for sector 'salud'. Skipping.
2025-09-27 12:26:41,070 INFO No candidates for sector 'commodites'. Skipping.
2025-09-27 12:26:42,323 INFO No candidates for sector 'financiero'. Skipping.
2025-09-27 12:26:43,417 INFO No candidates for sector 'tecnología'. Skipping.
2025-09-27 12:26:43,417 INFO Export finished.
2025-09-27 12:26:43,517 INFO Stage export completado correctamente.
2025-09-27 12:26:43,517 INFO === RUN PIPELINE END 2025-09-27T10:26:43.517130 UTC (duración 40.9 s) ===
2025-09-27 12:26:44,032 INFO Resumen candidatos: total=20 (preview):
2025-09-27 12:26:44,038 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 12:40:20,082 INFO === RUN PIPELINE START 2025-09-27T10:40:20.082705 UTC ===
2025-09-27 12:40:20,082 INFO Stage=fetch attempt 1/2
2025-09-27 12:40:20,082 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 12:41:35,813 INFO Salida (1_fetch_indicators.py): returncode=0 (t=75.7s)
2025-09-27 12:41:35,813 WARNING stderr: 2025-09-27 12:40:21,071 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-09-27 12:40:21,082 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-09-27 12:40:21,091 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 12:40:22,951 ERROR HTTP Error 404: 
2025-09-27 12:40:28,176 ERROR 
32 Failed downloads:
2025-09-27 12:40:28,176 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758969706. The requested range must be within the last 60 days.")')
2025-09-27 12:40:28,176 ERROR ['AF', 'ACS', 'BNP', 'BMW', 'CIE', 'COL', 'ANA', 'CABK', 'CEZ', 'AYV']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 12:40:28,176 ERROR ['AYDEN', 'BAS', 'AMNB', 'BC8', 'BBSE3', 'CNC.MI', 'ALO', 'ALFAA', 'ANTM', 'ADS', 'CPFE3', 'AIXA', 'CMIN3', 'CERN', 'BAYN', 'CHK', 'CAP', 'AGUA', 'BHIA3', 'BP.LS', 'CBK']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a futu
2025-09-27 12:41:35,814 INFO Stage fetch completado correctamente.
2025-09-27 12:41:35,814 INFO Stage=score attempt 1/2
2025-09-27 12:41:35,814 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 12:41:36,615 INFO Salida (2_score_select.py): returncode=0 (t=0.8s)
2025-09-27 12:41:36,615 WARNING stderr: 2025-09-27 12:41:36,468 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 12:41:36,483 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 12:41:36,504 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 12:41:36,515 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 12:41:36,519 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 12:41:36,531 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 12:41:36,532 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 12:41:36,533 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 12:41:36,533 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 12:41:36,533 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 12:41:36,533 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 12:41:36,534 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 12:41:36,615 INFO Stage score completado correctamente.
2025-09-27 12:41:36,616 INFO Stage=export attempt 1/2
2025-09-27 12:41:36,616 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 12:41:47,437 INFO Salida (3_export_sheets.py): returncode=0 (t=10.8s)
2025-09-27 12:41:47,437 WARNING stderr: 2025-09-27 12:41:37,879 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['energía', 'salud', 'commodites', 'financiero', 'tecnología']
2025-09-27 12:41:37,880 INFO export_sheets: Leyendo candidates desde CSV: intermediate/candidates.sheet_ready.csv
2025-09-27 12:41:37,883 INFO export_sheets: Usando columna de sector: Sector
2025-09-27 12:41:37,883 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-27 12:41:38,366 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-27 12:41:38,366 INFO export_sheets: Procesando sheet config: 'energía' ...
2025-09-27 12:41:39,030 INFO export_sheets: Ticker VAL omitido en 'energía' por duplicado reciente.
2025-09-27 12:41:39,245 INFO export_sheets: Añadiendo 3 filas a 'energía' (tickers: BE, NE, OKLO)
2025-09-27 12:41:40,788 INFO export_sheets: Sheet energía: añadidas 3 filas (tickers añadidos: BE, NE, OKLO)
2025-09-27 12:41:40,788 INFO export_sheets: Procesando sheet config: 'salud' ...
2025-09-27 12:41:42,016 INFO export_sheets: Añadiendo 4 filas a 'salud' (tickers: ARGX.BR, ABT, MDT, MDGL)
2025-09-27 12:41:43,032 INFO export_sheets: Sheet salud: añadidas 4 filas (tickers añadidos: ARGX.BR, ABT, MDT, MDGL)
2025-09-27 12:41:43,033 INFO export_sheets: Procesando sheet config: 'commodites' ...
2025-09-27 12:41:43,704 INFO export_sheets: No hay candidatos en CSV para la hoja 'commodites' (sector).
2025-09-27 12:41:43,704 INFO export_sheets: Procesando sheet config: 'financiero' ...
2025-09-27 12:41:44,653 INFO export_sheets: Añadiendo 4 filas a 'financiero' (tickers: LOW, TLN, GPC, SYF)
2025-09-27 12:41:45,553 INFO export_sheets: Sheet financiero: añadidas 4 filas (tickers añadidos: LOW, TLN, GPC, SYF)
2025-09-27 12:41:45,553 INFO export_sheets: Procesando sheet config: 'tecnología' ...
2025-09-27 12:41:46,420 INFO export_sheets: Añadiendo 4 filas a 'tecnología' (tickers: FICO, CRDO, NET, AN)
2025-09-27 12:41:47,343 INFO export_sheets: Sheet tecnología: añadidas 4 filas (tickers añadidos: FICO, CRDO, NET, AN)
2025-09-27 12:41:47,343 INFO export_sheets: Export finalizado.
2025-09-27 12:41:47,437 INFO Stage export completado correctamente.
2025-09-27 12:41:47,437 INFO === RUN PIPELINE END 2025-09-27T10:41:47.437464 UTC (duración 87.4 s) ===
2025-09-27 12:41:47,956 INFO Resumen candidatos: total=20 (preview):
2025-09-27 12:41:47,963 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 12:47:45,004 INFO === RUN PIPELINE START 2025-09-27T10:47:45.004606 UTC ===
2025-09-27 12:47:45,004 INFO Stage=fetch attempt 1/2
2025-09-27 12:47:45,004 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 12:48:17,406 INFO Salida (1_fetch_indicators.py): returncode=0 (t=32.4s)
2025-09-27 12:48:17,406 WARNING stderr: 2025-09-27 12:47:45,895 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 12:48:17,406 INFO Stage fetch completado correctamente.
2025-09-27 12:48:17,407 INFO Stage=score attempt 1/2
2025-09-27 12:48:17,407 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 12:48:18,117 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 12:48:18,117 WARNING stderr: 2025-09-27 12:48:18,027 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 12:48:18,036 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 12:48:18,044 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 12:48:18,050 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 12:48:18,052 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 12:48:18,060 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 12:48:18,061 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 12:48:18,061 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 12:48:18,061 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 12:48:18,061 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 12:48:18,062 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 12:48:18,062 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 12:48:18,117 INFO Stage score completado correctamente.
2025-09-27 12:48:18,117 INFO Stage=export attempt 1/2
2025-09-27 12:48:18,117 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 12:48:25,498 INFO Salida (3_export_sheets.py): returncode=0 (t=7.4s)
2025-09-27 12:48:25,499 WARNING stderr: 2025-09-27 12:48:19,271 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-27 12:48:19,271 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-27 12:48:19,274 INFO export_sheets: Usando columna de sector: Sector
2025-09-27 12:48:19,275 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-27 12:48:19,858 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-27 12:48:19,858 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-27 12:48:20,520 INFO export_sheets: Ticker VAL omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 12:48:20,730 INFO export_sheets: Escribiendo 3 filas en hoja 'ENERGÍA' empezando en fila 6 (tickers: BE, NE, OKLO)
a:\pilim\desktop\financiero\3_export_sheets.py:319: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(f"A{write_start}", rows_to_write, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 12:48:20,975 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente.
2025-09-27 12:48:20,976 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-27 12:48:21,845 INFO export_sheets: Escribiendo 4 filas en hoja 'SALUD' empezando en fila 6 (tickers: ARGX.BR, ABT, MDT, MDGL)
a:\pilim\desktop\financiero\3_export_sheets.py:319: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(f"A{write_start}", rows_to_write, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 12:48:22,086 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente.
2025-09-27 12:48:22,086 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-27 12:48:22,933 INFO export_sheets: Escribiendo 4 filas en hoja 'COMMODITIES' empezando en fila 6 (tickers: SGI, STRL, HLIO, ADM)
a:\pilim\desktop\financiero\3_export_sheets.py:319: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(f"A{write_start}", rows_to_write, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 12:48:23,153 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente.
2025-09-27 12:48:23,153 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-27 12:48:24,146 INFO export_sheets: Escribiendo 4 filas en hoja 'FINANCIERO' empezando en fila 6 (tickers: LOW, TLN, GPC, SYF)
a:\pilim\desktop\financiero\3_export_sheets.py:319: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(f"A{write_start}", rows_to_write, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 12:48:24,360 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente.
2025-09-27 12:48:24,361 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-27 12:48:25,191 INFO export_sheets: Escribiendo 4 filas en hoja 'TECNOLOGÍA' empezando en fila 6 (tickers: FICO, CRDO, NET, AN)
a:\pilim\desktop\financiero\3_export_sheets.py:319: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(f"A{write_start}", rows_to_write, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 12:48:25,405 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 4 filas correctamente.
2025-09-27 12:48:25,405 INF
2025-09-27 12:48:25,499 INFO Stage export completado correctamente.
2025-09-27 12:48:25,500 INFO === RUN PIPELINE END 2025-09-27T10:48:25.500937 UTC (duración 40.5 s) ===
2025-09-27 12:48:26,069 INFO Resumen candidatos: total=20 (preview):
2025-09-27 12:48:26,075 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 13:00:54,150 INFO === RUN PIPELINE START 2025-09-27T11:00:54.150005 UTC ===
2025-09-27 13:00:54,150 INFO Stage=fetch attempt 1/2
2025-09-27 13:00:54,150 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 1_fetch_indicators.py
2025-09-27 13:02:12,615 INFO Salida (1_fetch_indicators.py): returncode=0 (t=78.5s)
2025-09-27 13:02:12,616 WARNING stderr: 2025-09-27 13:00:55,066 INFO Starting fetch for 1148 tickers in batches of 200 (workers=8)
a:\pilim\desktop\financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-09-27 13:00:55,073 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "a:\pilim\desktop\financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-09-27 13:00:55,081 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 13:00:56,637 ERROR HTTP Error 404: 
2025-09-27 13:01:02,562 ERROR 
32 Failed downloads:
2025-09-27 13:01:02,562 ERROR ['CEZ', 'ANA', 'AF', 'BMW', 'ACS', 'COL', 'AYV', 'CIE', 'CABK', 'BNP']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 13:01:02,562 ERROR ['BAS', 'ALFAA', 'CBK', 'CMIN3', 'BP.LS', 'CHK', 'AMNB', 'CNC.MI', 'CAP', 'ALO', 'CERN', 'BC8', 'AGUA', 'BHIA3', 'BAYN', 'AIXA', 'ADS', 'AYDEN', 'BBSE3', 'CPFE3', 'ANTM']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-27 13:01:02,562 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758970945. The requested range must be within the last 60 days.")')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
a:\pilim\desktop\financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a futu
2025-09-27 13:02:12,616 INFO Stage fetch completado correctamente.
2025-09-27 13:02:12,616 INFO Stage=score attempt 1/2
2025-09-27 13:02:12,616 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 2_score_select.py
2025-09-27 13:02:13,359 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 13:02:13,359 WARNING stderr: 2025-09-27 13:02:13,256 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1100)
2025-09-27 13:02:13,266 INFO Hard filters applied: passed=78 rejected=1022 (total=1100)
2025-09-27 13:02:13,273 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 13:02:13,280 INFO Scoring computed. Score stats: min=11.25 median=16.48 max=56.86
2025-09-27 13:02:13,282 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 13:02:13,290 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-09-27 13:02:13,291 INFO SUMMARY: total_indicators=1100 passed=78 selected=20 rejected=1022
2025-09-27 13:02:13,292 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 13:02:13,292 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 13:02:13,292 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 13:02:13,292 INFO Sector=SALUD -> ARGX.BR, ABT, MDT, MDGL
2025-09-27 13:02:13,292 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 13:02:13,359 INFO Stage score completado correctamente.
2025-09-27 13:02:13,359 INFO Stage=export attempt 1/2
2025-09-27 13:02:13,359 INFO Ejecutando: 'C:\ProgramData\anaconda3\python.exe' 3_export_sheets.py
2025-09-27 13:02:23,355 INFO Salida (3_export_sheets.py): returncode=0 (t=10.0s)
2025-09-27 13:02:23,355 WARNING stderr: 2025-09-27 13:02:14,536 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-27 13:02:14,536 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-27 13:02:14,539 INFO export_sheets: Usando columna de sector: Sector
2025-09-27 13:02:14,540 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-27 13:02:15,245 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-27 13:02:15,245 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-27 13:02:15,966 INFO export_sheets: Ticker VAL omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 13:02:16,463 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A6:H8 (cols=8) filas=3 (tickers: BE, NE, OKLO)
a:\pilim\desktop\financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 13:02:16,740 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-27 13:02:16,740 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-27 13:02:18,737 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A6:H9 (cols=8) filas=4 (tickers: ARGX.BR, ABT, MDT, MDGL)
a:\pilim\desktop\financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 13:02:18,968 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-27 13:02:18,968 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-27 13:02:20,146 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H9 (cols=8) filas=4 (tickers: SGI, STRL, HLIO, ADM)
a:\pilim\desktop\financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 13:02:20,386 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-27 13:02:20,386 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-27 13:02:21,649 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: LOW, TLN, GPC, SYF)
a:\pilim\desktop\financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 13:02:21,874 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-27 13:02:21,874 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-27 13:02:23,038 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A6:H9 (cols=8) filas=4 (tickers: FICO, CRDO, NET, AN)
a:\pilim\desktop\financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
202
2025-09-27 13:02:23,356 INFO Stage export completado correctamente.
2025-09-27 13:02:23,357 INFO === RUN PIPELINE END 2025-09-27T11:02:23.357256 UTC (duración 89.2 s) ===
2025-09-27 13:02:23,898 INFO Resumen candidatos: total=20 (preview):
2025-09-27 13:02:23,906 INFO  TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
   STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
   HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
    ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
     BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
    VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
     NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
   OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
    LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
    TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
    GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
    SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
ARGX.BR  613.200012  6.442858  613.301057  622.238035  609.726280 34.615929 45.676247        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.835351       SALUD
    ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
    MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
   MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
   CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
    NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
     AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 15:39:18,980 INFO === RUN PIPELINE START 2025-09-27T13:39:18.980007 UTC ===
2025-09-27 15:39:18,980 INFO Stage=fetch attempt 1/2
2025-09-27 15:39:18,980 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-27 15:39:19,082 INFO Salida (1_fetch_indicators.py): returncode=1 (t=0.1s)
2025-09-27 15:39:19,083 WARNING stderr: Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\1_fetch_indicators.py", line 25, in <module>
    import yaml
ModuleNotFoundError: No module named 'yaml'
2025-09-27 15:39:19,083 WARNING Stage fetch fallo con code=1
2025-09-27 15:39:19,083 INFO Reintentando en 5s...
2025-09-27 15:39:24,084 INFO Stage=fetch attempt 2/2
2025-09-27 15:39:24,242 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-27 15:39:24,337 INFO Salida (1_fetch_indicators.py): returncode=1 (t=0.1s)
2025-09-27 15:39:24,337 WARNING stderr: Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\1_fetch_indicators.py", line 25, in <module>
    import yaml
ModuleNotFoundError: No module named 'yaml'
2025-09-27 15:39:24,338 WARNING Stage fetch fallo con code=1
2025-09-27 15:39:24,339 ERROR Stage=fetch falló después de 2 intentos.
2025-09-27 15:39:24,340 ERROR Pipeline abortado: Stage fetch failed after 2 attempts.
Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\run_pipeline.py", line 135, in main
    run_stage("fetch", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "A:\pilim\Desktop\Financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage fetch failed after 2 attempts.
2025-09-27 15:39:24,343 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 15:39:44,117 INFO === RUN PIPELINE START 2025-09-27T13:39:44.117120 UTC ===
2025-09-27 15:39:44,117 INFO Stage=fetch attempt 1/2
2025-09-27 15:39:44,117 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-27 15:40:56,287 INFO Salida (1_fetch_indicators.py): returncode=0 (t=72.2s)
2025-09-27 15:40:56,287 WARNING stderr: 2025-09-27 15:39:45,298 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-27 15:39:45,311 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 15:39:53,381 ERROR 
32 Failed downloads:
2025-09-27 15:39:53,382 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758980471. The requested range must be within the last 60 days.")')
2025-09-27 15:39:53,382 ERROR ['CEZ', 'BNP', 'AYV', 'AF', 'COL', 'CIE', 'CABK', 'ACS', 'ANA', 'BMW']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 15:39:53,382 ERROR ['CAP', 'BP.LS', 'ANTM', 'BAYN', 'CBK', 'AIXA', 'BC8', 'AGUA', 'BAS', 'CERN', 'CHK', 'ADS', 'AYDEN', 'ALO', 'ALFAA', 'CMIN3', 'AMNB', 'CNC.MI', 'BBSE3', 'CPFE3', 'BHIA3']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-27 15:39:54,739 ERROR 
1 Failed download:
2025-09-27 15:39:54,739 ERROR ['ACS']: YFPricesMissingError('po
2025-09-27 15:40:56,288 INFO Stage fetch completado correctamente.
2025-09-27 15:40:56,288 INFO Stage=score attempt 1/2
2025-09-27 15:40:56,289 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-27 15:40:56,776 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-09-27 15:40:56,776 WARNING stderr: 2025-09-27 15:40:56,694 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-27 15:40:56,701 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-09-27 15:40:56,709 INFO Hard filters applied: passed=77 rejected=1022 (total=1099)
2025-09-27 15:40:56,714 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 15:40:56,720 INFO Scoring computed. Score stats: min=11.25 median=16.47 max=56.86
2025-09-27 15:40:56,722 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 15:40:56,728 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-27 15:40:56,730 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 15:40:56,730 INFO SUMMARY: total_indicators=1099 passed=77 selected=20 rejected=1022
2025-09-27 15:40:56,730 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 15:40:56,731 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 15:40:56,731 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 15:40:56,731 INFO Sector=SALUD -> ABT, MDT, MDGL, UNH
2025-09-27 15:40:56,731 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 15:40:56,776 INFO Stage score completado correctamente.
2025-09-27 15:40:56,777 INFO Stage=export attempt 1/2
2025-09-27 15:40:56,777 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-27 15:40:57,248 INFO Salida (3_export_sheets.py): returncode=1 (t=0.5s)
2025-09-27 15:40:57,248 WARNING stderr: Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\3_export_sheets.py", line 25, in <module>
    import gspread
ModuleNotFoundError: No module named 'gspread'
2025-09-27 15:40:57,249 WARNING Stage export fallo con code=1
2025-09-27 15:40:57,249 INFO Reintentando en 5s...
2025-09-27 15:41:02,249 INFO Stage=export attempt 2/2
2025-09-27 15:41:02,249 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-27 15:41:02,696 INFO Salida (3_export_sheets.py): returncode=1 (t=0.4s)
2025-09-27 15:41:02,696 WARNING stderr: Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\3_export_sheets.py", line 25, in <module>
    import gspread
ModuleNotFoundError: No module named 'gspread'
2025-09-27 15:41:02,696 WARNING Stage export fallo con code=1
2025-09-27 15:41:02,697 ERROR Stage=export falló después de 2 intentos.
2025-09-27 15:41:02,697 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "A:\pilim\Desktop\Financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 15:41:02,701 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 15:45:37,552 INFO === RUN PIPELINE START 2025-09-27T13:45:37.552754 UTC ===
2025-09-27 15:45:37,553 INFO Stage=fetch attempt 1/2
2025-09-27 15:45:37,553 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-27 15:46:06,537 INFO Salida (1_fetch_indicators.py): returncode=0 (t=29.0s)
2025-09-27 15:46:06,537 WARNING stderr: 2025-09-27 15:45:38,220 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 15:46:06,538 INFO Stage fetch completado correctamente.
2025-09-27 15:46:06,538 INFO Stage=score attempt 1/2
2025-09-27 15:46:06,538 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-27 15:46:07,038 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-09-27 15:46:07,038 WARNING stderr: 2025-09-27 15:46:06,953 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-27 15:46:06,960 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-09-27 15:46:06,968 INFO Hard filters applied: passed=77 rejected=1022 (total=1099)
2025-09-27 15:46:06,973 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 15:46:06,979 INFO Scoring computed. Score stats: min=11.25 median=16.47 max=56.86
2025-09-27 15:46:06,981 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 15:46:06,987 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-27 15:46:06,989 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 15:46:06,989 INFO SUMMARY: total_indicators=1099 passed=77 selected=20 rejected=1022
2025-09-27 15:46:06,990 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 15:46:06,990 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 15:46:06,990 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 15:46:06,990 INFO Sector=SALUD -> ABT, MDT, MDGL, UNH
2025-09-27 15:46:06,990 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 15:46:07,039 INFO Stage score completado correctamente.
2025-09-27 15:46:07,039 INFO Stage=export attempt 1/2
2025-09-27 15:46:07,040 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-27 15:46:07,510 INFO Salida (3_export_sheets.py): returncode=1 (t=0.5s)
2025-09-27 15:46:07,510 WARNING stderr: Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\3_export_sheets.py", line 25, in <module>
    import gspread
ModuleNotFoundError: No module named 'gspread'
2025-09-27 15:46:07,510 WARNING Stage export fallo con code=1
2025-09-27 15:46:07,511 INFO Reintentando en 5s...
2025-09-27 15:46:12,511 INFO Stage=export attempt 2/2
2025-09-27 15:46:12,512 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-27 15:46:12,993 INFO Salida (3_export_sheets.py): returncode=1 (t=0.5s)
2025-09-27 15:46:12,993 WARNING stderr: Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\3_export_sheets.py", line 25, in <module>
    import gspread
ModuleNotFoundError: No module named 'gspread'
2025-09-27 15:46:12,993 WARNING Stage export fallo con code=1
2025-09-27 15:46:12,995 ERROR Stage=export falló después de 2 intentos.
2025-09-27 15:46:12,996 ERROR Pipeline abortado: Stage export failed after 2 attempts.
Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\run_pipeline.py", line 139, in main
    run_stage("export", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "A:\pilim\Desktop\Financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage export failed after 2 attempts.
2025-09-27 15:46:12,999 INFO Revisa run_pipeline.log para más detalles.
2025-09-27 15:46:44,038 INFO === RUN PIPELINE START 2025-09-27T13:46:44.038175 UTC ===
2025-09-27 15:46:44,038 INFO Stage=fetch attempt 1/2
2025-09-27 15:46:44,038 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-27 15:47:12,452 INFO Salida (1_fetch_indicators.py): returncode=0 (t=28.4s)
2025-09-27 15:47:12,453 WARNING stderr: 2025-09-27 15:46:44,734 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-27 15:47:12,453 INFO Stage fetch completado correctamente.
2025-09-27 15:47:12,454 INFO Stage=score attempt 1/2
2025-09-27 15:47:12,454 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-27 15:47:12,957 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-09-27 15:47:12,957 WARNING stderr: 2025-09-27 15:47:12,874 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-27 15:47:12,881 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-09-27 15:47:12,889 INFO Hard filters applied: passed=77 rejected=1022 (total=1099)
2025-09-27 15:47:12,894 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 15:47:12,900 INFO Scoring computed. Score stats: min=11.25 median=16.47 max=56.86
2025-09-27 15:47:12,901 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 15:47:12,907 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-27 15:47:12,909 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 15:47:12,910 INFO SUMMARY: total_indicators=1099 passed=77 selected=20 rejected=1022
2025-09-27 15:47:12,910 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 15:47:12,910 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 15:47:12,910 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 15:47:12,910 INFO Sector=SALUD -> ABT, MDT, MDGL, UNH
2025-09-27 15:47:12,911 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 15:47:12,958 INFO Stage score completado correctamente.
2025-09-27 15:47:12,958 INFO Stage=export attempt 1/2
2025-09-27 15:47:12,959 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-27 15:47:28,824 INFO Salida (3_export_sheets.py): returncode=0 (t=15.9s)
2025-09-27 15:47:28,824 WARNING stderr: 2025-09-27 15:47:13,947 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-27 15:47:13,948 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-27 15:47:13,951 INFO export_sheets: Usando columna de sector: Sector
2025-09-27 15:47:13,952 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-27 15:47:15,733 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-27 15:47:15,733 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-27 15:47:17,928 INFO export_sheets: Ticker BE omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 15:47:17,928 INFO export_sheets: Ticker VAL omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 15:47:17,928 INFO export_sheets: Ticker NE omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 15:47:17,928 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 15:47:17,929 INFO export_sheets: No hay filas nuevas para añadir en 'ENERGÍA' (tras filtrar duplicados).
2025-09-27 15:47:17,929 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-27 15:47:19,674 INFO export_sheets: Ticker ABT omitido en 'SALUD' por duplicado reciente.
2025-09-27 15:47:19,674 INFO export_sheets: Ticker MDT omitido en 'SALUD' por duplicado reciente.
2025-09-27 15:47:19,674 INFO export_sheets: Ticker MDGL omitido en 'SALUD' por duplicado reciente.
2025-09-27 15:47:21,160 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A9:H9 (cols=8) filas=1 (tickers: UNH)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 15:47:21,976 INFO export_sheets: Hoja 'SALUD': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-27 15:47:21,976 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-27 15:47:24,244 INFO export_sheets: Ticker SGI omitido en 'COMMODITIES' por duplicado reciente.
2025-09-27 15:47:24,244 INFO export_sheets: Ticker STRL omitido en 'COMMODITIES' por duplicado reciente.
2025-09-27 15:47:24,244 INFO export_sheets: Ticker HLIO omitido en 'COMMODITIES' por duplicado reciente.
2025-09-27 15:47:24,244 INFO export_sheets: Ticker ADM omitido en 'COMMODITIES' por duplicado reciente.
2025-09-27 15:47:24,244 INFO export_sheets: No hay filas nuevas para añadir en 'COMMODITIES' (tras filtrar duplicados).
2025-09-27 15:47:24,244 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-27 15:47:26,522 INFO export_sheets: Ticker LOW omitido en 'FINANCIERO' por duplicado reciente.
2025-09-27 15:47:26,522 INFO export_sheets: Ticker TLN omitido en 'FINANCIERO' por duplicado reciente.
2025-09-27 15:47:26,522 INFO export_sheets: Ticker GPC omitido en 'FINANCIERO' por duplicado reciente.
2025-09-27 15:47:26,522 INFO export_sheets: Ticker SYF omitido en 'FINANCIERO' por duplicado reciente.
2025-09-27 15:47:26,522 INFO export_sheets: No hay filas nuevas para añadir en 'FINANCIERO' (tras filtrar duplicados).
2025-09-27 15:47:26,522 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-27 15:47:28,748 INFO export_sheets: Ticker FICO omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-27 15:47:28,748 INFO export_sheets: Ticker CRDO omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-27 15:47:28,748 INFO export_sheets: Ticker NET omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-27 15:47:28,748 INFO export_sheets: Ticker AN omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-27 15:47:28,748 INFO export_sheets: No hay filas nuevas para añadir en 'TECNOLOGÍA' (tras filtrar 
2025-09-27 15:47:28,825 INFO Stage export completado correctamente.
2025-09-27 15:47:28,825 INFO === RUN PIPELINE END 2025-09-27T13:47:28.825792 UTC (duración 44.8 s) ===
2025-09-27 15:47:29,166 INFO Resumen candidatos: total=20 (preview):
2025-09-27 15:47:29,173 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
   SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
  STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
  HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
   ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
    BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
   VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
    NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
  OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
   LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
   TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
   GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
   SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
   ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
   MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
  MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   UNH  344.070007  4.116806  345.641604  341.050847  321.331938 38.442534 48.396832        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 17.673871       SALUD
  FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
  CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
   NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
    AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-27 17:32:46,269 INFO === RUN PIPELINE START 2025-09-27T15:32:46.269313 UTC ===
2025-09-27 17:32:46,270 INFO Stage=fetch attempt 1/2
2025-09-27 17:32:46,271 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-27 17:34:02,293 INFO Salida (1_fetch_indicators.py): returncode=0 (t=76.0s)
2025-09-27 17:34:02,293 WARNING stderr: 2025-09-27 17:32:48,033 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-27 17:32:48,052 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-27 17:32:49,202 ERROR HTTP Error 404: 
2025-09-27 17:32:55,829 ERROR 
32 Failed downloads:
2025-09-27 17:32:55,829 ERROR ['ANA', 'ACS', 'CIE', 'BMW', 'CABK', 'BNP', 'AYV', 'AF', 'CEZ', 'COL']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-27 17:32:55,829 ERROR ['ADS', 'BHIA3', 'AYDEN', 'ALO', 'ANTM', 'BBSE3', 'CMIN3', 'BP.LS', 'AIXA', 'CERN', 'CBK', 'AMNB', 'CHK', 'CNC.MI', 'CAP', 'AGUA', 'BAYN', 'BAS', 'ALFAA', 'CPFE3', 'BC8']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-27 17:32:55,830 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1758987256. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-27 17:32:57,071 ERROR 
1 Failed download:
2025-09-27 17:32
2025-09-27 17:34:02,294 INFO Stage fetch completado correctamente.
2025-09-27 17:34:02,294 INFO Stage=score attempt 1/2
2025-09-27 17:34:02,294 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-27 17:34:02,947 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-27 17:34:02,948 WARNING stderr: 2025-09-27 17:34:02,798 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-27 17:34:02,806 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-09-27 17:34:02,814 INFO Hard filters applied: passed=77 rejected=1022 (total=1099)
2025-09-27 17:34:02,851 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-27 17:34:02,859 INFO Scoring computed. Score stats: min=11.25 median=16.47 max=56.86
2025-09-27 17:34:02,862 INFO Selected top 4 per sector. Selected rows=20
2025-09-27 17:34:02,871 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-27 17:34:02,875 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-27 17:34:02,875 INFO SUMMARY: total_indicators=1099 passed=77 selected=20 rejected=1022
2025-09-27 17:34:02,876 INFO Sector=COMMODITIES -> SGI, STRL, HLIO, ADM
2025-09-27 17:34:02,876 INFO Sector=ENERGIA -> BE, VAL, NE, OKLO
2025-09-27 17:34:02,876 INFO Sector=FINANCIERO -> LOW, TLN, GPC, SYF
2025-09-27 17:34:02,876 INFO Sector=SALUD -> ABT, MDT, MDGL, UNH
2025-09-27 17:34:02,876 INFO Sector=TECNOLOGÍA -> FICO, CRDO, NET, AN
2025-09-27 17:34:02,949 INFO Stage score completado correctamente.
2025-09-27 17:34:02,949 INFO Stage=export attempt 1/2
2025-09-27 17:34:02,950 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-27 17:34:24,255 INFO Salida (3_export_sheets.py): returncode=0 (t=21.3s)
2025-09-27 17:34:24,255 WARNING stderr: 2025-09-27 17:34:03,882 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-27 17:34:03,883 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-27 17:34:03,887 INFO export_sheets: Usando columna de sector: Sector
2025-09-27 17:34:03,888 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-27 17:34:05,501 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-27 17:34:05,501 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-27 17:34:07,660 INFO export_sheets: Ticker VAL omitido en 'ENERGÍA' por duplicado reciente.
2025-09-27 17:34:08,565 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A6:H8 (cols=8) filas=3 (tickers: BE, NE, OKLO)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 17:34:09,477 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-27 17:34:09,477 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-27 17:34:12,510 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A6:H9 (cols=8) filas=4 (tickers: ABT, MDT, MDGL, UNH)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 17:34:13,357 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-27 17:34:13,358 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-27 17:34:16,804 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H9 (cols=8) filas=4 (tickers: SGI, STRL, HLIO, ADM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 17:34:17,497 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-27 17:34:17,497 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-27 17:34:21,023 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: LOW, TLN, GPC, SYF)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-27 17:34:21,246 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-27 17:34:21,246 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-27 17:34:23,891 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A6:H9 (cols=8) filas=4 (tickers: FICO, CRDO, NET, AN)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09
2025-09-27 17:34:24,256 INFO Stage export completado correctamente.
2025-09-27 17:34:24,256 INFO === RUN PIPELINE END 2025-09-27T15:34:24.256865 UTC (duración 98.0 s) ===
2025-09-27 17:34:24,657 INFO Resumen candidatos: total=20 (preview):
2025-09-27 17:34:24,664 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
   SGI   82.650002  0.749644   82.962506   83.976526   82.119388 46.453857 40.707290        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.831887 COMMODITIES
  STRL  341.950012  9.821980  345.729705  335.053568  306.220816 54.882949 48.242882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.222578 COMMODITIES
  HLIO   52.715000  0.512093   52.960036   53.684780   51.303874 55.586515 41.470697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.675915 COMMODITIES
   ADM   60.590000  0.828650   60.856262   61.102497   60.293408 48.287853 47.199919        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.405991 COMMODITIES
    BE   70.349998  3.646170   70.937772   70.574769   58.350624 48.362522 45.733205        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.041534     ENERGIA
   VAL   50.395000  1.016864   50.708360   51.100114   49.937377 49.836209 45.873529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.415121     ENERGIA
    NE   29.235001  0.589028   29.249398   29.461973   28.966637 35.124351 48.574381        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.630554     ENERGIA
  OKLO  110.500000  7.578850  119.630991  110.257886   90.073935 40.238429 41.583960        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.455451     ENERGIA
   LOW  257.119995  1.930557  257.790211  262.033602  256.728619 64.814146 35.715172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.402100  FINANCIERO
   TLN  411.299988  5.847600  413.392367  409.629943  386.540606 51.329249 47.094214        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.778377  FINANCIERO
   GPC  137.699997  1.022239  137.761882  138.458307  137.055627 36.135209 47.212889        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.609678  FINANCIERO
   SYF   74.540001  0.825578   74.695139   75.108150   74.102043 42.138149 46.564429        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.720247  FINANCIERO
   ABT  133.550003  1.157257  133.879186  133.766440  132.536919 48.279811 46.997672        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.215318       SALUD
   MDT   94.224998  0.900108   94.484366   94.306264   93.075519 59.803662 47.067301        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.814939       SALUD
  MDGL  424.109985  5.983361  429.352531  431.659626  407.732184 13.667145 41.598172        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.816978       SALUD
   UNH  344.070007  4.116806  345.641604  341.050847  321.331938 38.442534 48.396832        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 17.673871       SALUD
  FICO 1519.000000 19.542672 1533.710721 1531.400649 1514.826756 48.481118 44.987050        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.860860  TECNOLOGÍA
  CRDO  142.899994  5.153207  148.227898  153.165868  138.638152 47.422929 36.079814        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.302754  TECNOLOGÍA
   NET  216.429993  3.836463  218.100869  218.823739  211.701249 56.023889 44.573455        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.813976  TECNOLOGÍA
    AN  217.630005  2.544643  218.281477  219.781228  216.579943 46.877287 45.086726        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.206618  TECNOLOGÍA
2025-09-29 21:21:40,647 INFO === RUN PIPELINE START 2025-09-29T19:21:40.647791 UTC ===
2025-09-29 21:21:40,648 INFO Stage=fetch attempt 1/2
2025-09-29 21:21:40,648 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-29 21:23:03,907 INFO Salida (1_fetch_indicators.py): returncode=0 (t=83.3s)
2025-09-29 21:23:03,919 WARNING stderr: 2025-09-29 21:21:44,192 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-29 21:21:44,202 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-29 21:21:48,176 ERROR HTTP Error 404: 
2025-09-29 21:21:53,881 ERROR 
32 Failed downloads:
2025-09-29 21:21:53,881 ERROR ['CABK', 'ANA', 'COL', 'AYV', 'BMW', 'CIE', 'CEZ', 'ACS', 'BNP', 'AF']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-29 21:21:53,881 ERROR ['BAYN', 'ALFAA', 'CPFE3', 'AGUA', 'ADS', 'ANTM', 'CNC.MI', 'AYDEN', 'BAS', 'BHIA3', 'AMNB', 'AIXA', 'ALO', 'BC8', 'CERN', 'CMIN3', 'BP.LS', 'CHK', 'BBSE3', 'CBK', 'CAP']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-29 21:21:53,881 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759173796. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-29 21:21:55,279 ERROR 
1 Failed download:
2025-09-29 21:21
2025-09-29 21:23:03,921 INFO Stage fetch completado correctamente.
2025-09-29 21:23:03,922 INFO Stage=score attempt 1/2
2025-09-29 21:23:03,924 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-29 21:23:04,631 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-29 21:23:04,632 WARNING stderr: 2025-09-29 21:23:04,506 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-29 21:23:04,514 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-29 21:23:04,525 INFO Hard filters applied: passed=74 rejected=1024 (total=1098)
2025-09-29 21:23:04,532 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-29 21:23:04,543 INFO Scoring computed. Score stats: min=7.44 median=18.04 max=59.44
2025-09-29 21:23:04,546 INFO Selected top 4 per sector. Selected rows=20
2025-09-29 21:23:04,557 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-29 21:23:04,560 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-29 21:23:04,560 INFO SUMMARY: total_indicators=1098 passed=74 selected=20 rejected=1024
2025-09-29 21:23:04,561 INFO Sector=COMMODITIES -> NEU, HLIO, PVH, TM
2025-09-29 21:23:04,561 INFO Sector=ENERGIA -> NRG, COP, XOM, PBF
2025-09-29 21:23:04,561 INFO Sector=FINANCIERO -> URI, RL, HD, STE
2025-09-29 21:23:04,561 INFO Sector=SALUD -> UTHR, MDT, HLI, ABT
2025-09-29 21:23:04,561 INFO Sector=TECNOLOGÍA -> RDDT, CRDO, GTLB, ZM
2025-09-29 21:23:04,632 INFO Stage score completado correctamente.
2025-09-29 21:23:04,633 INFO Stage=export attempt 1/2
2025-09-29 21:23:04,633 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-29 21:23:29,588 INFO Salida (3_export_sheets.py): returncode=0 (t=25.0s)
2025-09-29 21:23:29,588 WARNING stderr: 2025-09-29 21:23:06,058 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-29 21:23:06,059 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-29 21:23:06,064 INFO export_sheets: Usando columna de sector: Sector
2025-09-29 21:23:06,065 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-29 21:23:08,430 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-29 21:23:08,430 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-29 21:23:12,077 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A6:H9 (cols=8) filas=4 (tickers: NRG, COP, XOM, PBF)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 21:23:12,939 INFO export_sheets: Hoja 'ENERGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 21:23:12,939 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-29 21:23:16,636 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A6:H9 (cols=8) filas=4 (tickers: UTHR, MDT, HLI, ABT)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 21:23:17,380 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 21:23:17,380 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-29 21:23:21,024 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H9 (cols=8) filas=4 (tickers: NEU, HLIO, PVH, TM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 21:23:21,749 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 21:23:21,749 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-29 21:23:25,389 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: URI, RL, HD, STE)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 21:23:26,093 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 21:23:26,093 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-29 21:23:29,274 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A6:H9 (cols=8) filas=4 (tickers: RDDT, CRDO, GTLB, ZM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 21:23:29,515 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 4 filas correctamente (preservan
2025-09-29 21:23:29,589 INFO Stage export completado correctamente.
2025-09-29 21:23:29,589 INFO === RUN PIPELINE END 2025-09-29T19:23:29.589710 UTC (duración 108.9 s) ===
2025-09-29 21:23:29,944 INFO Resumen candidatos: total=20 (preview):
2025-09-29 21:23:29,952 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
   NEU 814.380005 5.900330 821.877648 822.221605 802.524972 46.252911 41.920673        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 37.168256 COMMODITIES
  HLIO  52.290001 0.506001  52.659281  53.471751  51.335429 62.654182 41.262171        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.897142 COMMODITIES
   PVH  84.970001 1.184171  86.007640  85.436008  82.262742 64.391277 43.617061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.583942 COMMODITIES
    TM 196.220993 0.869968 197.629229 198.368732 194.818653 51.500492 37.060061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.847953 COMMODITIES
   NRG 165.320007 3.017760 166.678327 163.963811 158.616041 53.871827 47.797707        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.292504     ENERGIA
   COP  95.273499 1.084401  96.045848  94.990158  94.705693 57.872191 48.766403        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.097811     ENERGIA
   XOM 113.790001 0.952643 115.193411 114.179621 112.415376 47.002308 42.697177        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.238343     ENERGIA
   PBF  30.139999 0.858572  31.770649  30.871208  28.256432 41.374926 38.741825        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.886873     ENERGIA
   URI 937.854980 8.522509 942.583608 944.679159 925.844415 61.291278 45.566852        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.436406  FINANCIERO
    RL 307.390015 4.031645 308.146165 309.121796 304.173772 47.477243 47.253100        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.973173  FINANCIERO
    HD 406.375000 2.750981 408.451424 411.889184 405.796378 64.551341 39.214581        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.920235  FINANCIERO
   STE 245.729996 2.346427 246.381094 247.169448 244.660222 61.669446 46.831748        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.117207  FINANCIERO
  UTHR 420.940002 7.311857 424.665578 413.808583 374.407333 61.932754 48.449395        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.616481       SALUD
   MDT  94.154999 0.845065  94.282631  94.258881  93.120825 62.540628 47.323421        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.688593       SALUD
   HLI 205.660004 1.817143 206.236142 205.162500 200.314461 57.100485 47.878596        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.545678       SALUD
   ABT 132.869995 1.136206 133.354498 133.592675 132.557956 60.128165 44.693652        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.351330       SALUD
  RDDT 240.110001 5.425762 240.252941 245.403806 230.389514 56.068691 45.991635        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.791914  TECNOLOGÍA
  CRDO 146.429993 4.649628 148.456819 152.538473 139.157036 43.188007 42.611883        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.308322  TECNOLOGÍA
  GTLB  47.400002 0.816442  47.446081  48.155108  47.096998 56.921977 45.584603        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.226823  TECNOLOGÍA
    ZM  83.889999 0.777778  83.903195  83.840997  81.244058 70.970004 49.117712        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.701429  TECNOLOGÍA
2025-09-29 22:40:12,957 INFO === RUN PIPELINE START 2025-09-29T20:40:12.957439 UTC ===
2025-09-29 22:40:12,958 INFO Stage=fetch attempt 1/2
2025-09-29 22:40:12,958 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-29 22:41:34,089 INFO Salida (1_fetch_indicators.py): returncode=0 (t=81.1s)
2025-09-29 22:41:34,089 WARNING stderr: 2025-09-29 22:40:13,676 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-29 22:40:13,687 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-29 22:40:14,956 ERROR HTTP Error 404: 
2025-09-29 22:40:15,152 ERROR HTTP Error 404: 
2025-09-29 22:40:21,353 ERROR 
32 Failed downloads:
2025-09-29 22:40:21,353 ERROR ['AYV', 'ACS', 'BMW', 'ANA', 'COL', 'AF', 'CABK', 'CEZ', 'BNP', 'CIE']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-29 22:40:21,353 ERROR ['CHK', 'BC8', 'BP.LS', 'BAYN', 'AYDEN', 'CPFE3', 'CBK', 'BHIA3', 'ADS', 'AIXA', 'BBSE3', 'BAS', 'ALFAA', 'CNC.MI', 'ANTM', 'CAP', 'CERN', 'AMNB', 'CMIN3', 'ALO', 'AGUA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-29 22:40:21,353 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759178499. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-29 22:40:22
2025-09-29 22:41:34,090 INFO Stage fetch completado correctamente.
2025-09-29 22:41:34,090 INFO Stage=score attempt 1/2
2025-09-29 22:41:34,090 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-29 22:41:34,584 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-09-29 22:41:34,584 WARNING stderr: 2025-09-29 22:41:34,501 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-29 22:41:34,507 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-29 22:41:34,515 INFO Hard filters applied: passed=75 rejected=1023 (total=1098)
2025-09-29 22:41:34,521 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-29 22:41:34,526 INFO Scoring computed. Score stats: min=7.38 median=25.27 max=60.09
2025-09-29 22:41:34,528 INFO Selected top 4 per sector. Selected rows=20
2025-09-29 22:41:34,534 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-29 22:41:34,537 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-29 22:41:34,537 INFO SUMMARY: total_indicators=1098 passed=75 selected=20 rejected=1023
2025-09-29 22:41:34,538 INFO Sector=COMMODITIES -> SGI, HLIO, THO, PVH
2025-09-29 22:41:34,538 INFO Sector=ENERGIA -> NRG, PBF, OKLO, PSIX
2025-09-29 22:41:34,538 INFO Sector=FINANCIERO -> MDB, HD, LFUS, STE
2025-09-29 22:41:34,538 INFO Sector=SALUD -> IDXX, HLI, ABT, MDT
2025-09-29 22:41:34,538 INFO Sector=TECNOLOGÍA -> VRSN, ZM, AN, FICO
2025-09-29 22:41:34,585 INFO Stage score completado correctamente.
2025-09-29 22:41:34,585 INFO Stage=export attempt 1/2
2025-09-29 22:41:34,586 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-29 22:41:56,993 INFO Salida (3_export_sheets.py): returncode=0 (t=22.4s)
2025-09-29 22:41:56,993 WARNING stderr: 2025-09-29 22:41:35,243 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-29 22:41:35,244 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-29 22:41:35,248 INFO export_sheets: Usando columna de sector: Sector
2025-09-29 22:41:35,248 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-29 22:41:36,880 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-29 22:41:36,880 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-29 22:41:40,605 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A6:H9 (cols=8) filas=4 (tickers: NRG, PBF, OKLO, PSIX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 22:41:41,345 INFO export_sheets: Hoja 'ENERGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 22:41:41,345 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-29 22:41:44,487 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A6:H9 (cols=8) filas=4 (tickers: IDXX, HLI, ABT, MDT)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 22:41:45,210 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 22:41:45,210 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-29 22:41:48,928 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H9 (cols=8) filas=4 (tickers: SGI, HLIO, THO, PVH)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 22:41:49,651 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 22:41:49,651 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-29 22:41:52,317 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: MDB, HD, LFUS, STE)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 22:41:53,034 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-29 22:41:53,034 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-29 22:41:56,670 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A6:H9 (cols=8) filas=4 (tickers: VRSN, ZM, AN, FICO)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-29 22:41:56,910 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 4 filas correctamente (preser
2025-09-29 22:41:56,994 INFO Stage export completado correctamente.
2025-09-29 22:41:56,995 INFO === RUN PIPELINE END 2025-09-29T20:41:56.995384 UTC (duración 104.0 s) ===
2025-09-29 22:41:57,371 INFO Resumen candidatos: total=20 (preview):
2025-09-29 22:41:57,376 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
   SGI   82.500000  0.683750   82.714716   83.737361   82.136975 53.930155 41.646512        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.076520 COMMODITIES
  HLIO   52.680000  0.528143   52.708031   53.487045   51.340594 66.554251 45.616494        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.827890 COMMODITIES
   THO  104.949997  1.777322  105.235444  105.512019  104.382529 88.503632 48.900684        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.151724 COMMODITIES
   PVH   84.900002  1.199885   85.998890   85.433263   82.261815 67.585460 43.160816        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.538182 COMMODITIES
   NRG  165.350006  3.017760  166.682077  163.964988  158.616439 50.725370 47.877236        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.317415     ENERGIA
   PBF   30.950001  0.901786   31.871899   30.902973   28.267161 52.283159 45.010555        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.391797     ENERGIA
  OKLO  116.489998  7.007779  118.735691  111.327564   91.505309 44.724761 48.047250        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 22.800833     ENERGIA
  PSIX  103.160004  4.505393  107.519958  104.350383   95.111499 12.252269 43.026052        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 16.906435     ENERGIA
   MDB  317.000000  4.087832  317.571780  317.852871  291.092336 52.144777 47.188559        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.441561  FINANCIERO
    HD  406.809998  2.750981  408.505799  411.906243  405.802140 66.484918 40.120756        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.504448  FINANCIERO
  LFUS  257.619995  2.971074  258.903916  260.730059  257.310976 68.571109 44.565190        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.976722  FINANCIERO
   STE  245.429993  2.369284  246.343594  247.157683  244.656249 50.163504 46.092532        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.708234  FINANCIERO
  IDXX  630.700012  6.538409  630.738933  637.089080  629.635625 65.703308 46.856779        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.088881       SALUD
   HLI  206.149994  1.826429  206.297391  205.181715  200.320951 50.908591 49.715555        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.413237       SALUD
   ABT  133.110001  1.151206  133.384499  133.602087  132.561134 62.420594 46.268045        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.995880       SALUD
   MDT   93.985001  0.853208   94.261381   94.252215   93.118573 64.756548 45.448373        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.341747       SALUD
  VRSN  284.299988  1.779162  284.979470  284.233999  280.935894 63.460579 47.710233        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.089764  TECNOLOGÍA
    ZM   83.620003  0.799206   83.869446   83.830409   81.240482 62.425788 46.268360        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.943766  TECNOLOGÍA
    AN  217.350006  2.627136  217.495447  219.272292  216.607260 55.879071 46.625745        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.284291  TECNOLOGÍA
  FICO 1526.694946 18.123832 1531.330015 1530.872118 1517.330591 37.725510 47.608583        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.277625  TECNOLOGÍA
2025-09-30 15:35:32,943 INFO === RUN PIPELINE START 2025-09-30T13:35:32.943842 UTC ===
2025-09-30 15:35:32,945 INFO Stage=fetch attempt 1/2
2025-09-30 15:35:32,946 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 15:37:11,608 INFO Salida (1_fetch_indicators.py): returncode=0 (t=98.7s)
2025-09-30 15:37:11,608 WARNING stderr: 2025-09-30 15:35:34,624 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-30 15:35:34,634 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 15:35:35,863 ERROR HTTP Error 404: 
2025-09-30 15:35:36,088 ERROR HTTP Error 404: 
2025-09-30 15:35:43,236 ERROR 
32 Failed downloads:
2025-09-30 15:35:43,236 ERROR ['COL', 'CABK', 'BMW', 'ACS', 'CEZ', 'BNP', 'CIE', 'ANA', 'AYV', 'AF']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 15:35:43,236 ERROR ['ANTM', 'AIXA', 'AYDEN', 'AMNB', 'BAYN', 'CMIN3', 'BHIA3', 'ALO', 'CBK', 'CPFE3', 'ALFAA', 'BP.LS', 'BBSE3', 'CAP', 'BC8', 'AGUA', 'CNC.MI', 'CHK', 'CERN', 'BAS', 'ADS']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-30 15:35:43,236 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759239422. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-30 15:35:44
2025-09-30 15:37:11,609 INFO Stage fetch completado correctamente.
2025-09-30 15:37:11,610 INFO Stage=score attempt 1/2
2025-09-30 15:37:11,610 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 15:37:12,611 INFO Salida (2_score_select.py): returncode=0 (t=1.0s)
2025-09-30 15:37:12,611 WARNING stderr: 2025-09-30 15:37:12,468 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 15:37:12,477 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1096)
2025-09-30 15:37:12,490 INFO Hard filters applied: passed=72 rejected=1024 (total=1096)
2025-09-30 15:37:12,498 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 15:37:12,506 INFO Scoring computed. Score stats: min=7.58 median=27.27 max=56.05
2025-09-30 15:37:12,509 INFO Selected top 4 per sector. Selected rows=20
2025-09-30 15:37:12,518 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 15:37:12,522 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 15:37:12,523 INFO SUMMARY: total_indicators=1096 passed=72 selected=20 rejected=1024
2025-09-30 15:37:12,523 INFO Sector=COMMODITIES -> HLIO, SGI, ADM, PVH
2025-09-30 15:37:12,523 INFO Sector=ENERGIA -> PBF, XOM, DVN, OXY
2025-09-30 15:37:12,524 INFO Sector=FINANCIERO -> MDB, HD, STE, WSM
2025-09-30 15:37:12,524 INFO Sector=SALUD -> A, ABT, MDT, HWC
2025-09-30 15:37:12,524 INFO Sector=TECNOLOGÍA -> RDDT, AN, ZM, AVGO
2025-09-30 15:37:12,612 INFO Stage score completado correctamente.
2025-09-30 15:37:12,612 INFO Stage=export attempt 1/2
2025-09-30 15:37:12,613 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 15:37:35,860 INFO Salida (3_export_sheets.py): returncode=0 (t=23.2s)
2025-09-30 15:37:35,860 WARNING stderr: 2025-09-30 15:37:13,727 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 15:37:13,728 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 15:37:13,733 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 15:37:13,734 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 15:37:15,693 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 15:37:15,693 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 15:37:18,951 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H10 (cols=8) filas=4 (tickers: PBF, XOM, DVN, OXY)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:37:19,685 INFO export_sheets: Hoja 'ENERGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 15:37:19,685 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 15:37:21,878 INFO export_sheets: Ticker MDT omitido en 'SALUD' por duplicado reciente.
2025-09-30 15:37:23,351 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A2:H4 (cols=8) filas=3 (tickers: A, ABT, HWC)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:37:24,084 INFO export_sheets: Hoja 'SALUD': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 15:37:24,084 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 15:37:26,317 INFO export_sheets: Ticker PVH omitido en 'COMMODITIES' por duplicado reciente.
2025-09-30 15:37:27,783 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H8 (cols=8) filas=3 (tickers: HLIO, SGI, ADM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:37:28,552 INFO export_sheets: Hoja 'COMMODITIES': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 15:37:28,552 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 15:37:30,246 INFO export_sheets: Ticker MDB omitido en 'FINANCIERO' por duplicado reciente.
2025-09-30 15:37:31,231 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H8 (cols=8) filas=3 (tickers: HD, STE, WSM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:37:31,920 INFO export_sheets: Hoja 'FINANCIERO': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 15:37:31,920 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 15:37:34,088 INFO export_sheets: Ticker ZM omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-30 15:37:35,546 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A2:H4 (cols=8) filas=3 (tickers: RDDT, AN, AVGO)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: Depr
2025-09-30 15:37:35,861 INFO Stage export completado correctamente.
2025-09-30 15:37:35,862 INFO === RUN PIPELINE END 2025-09-30T13:37:35.862477 UTC (duración 122.9 s) ===
2025-09-30 15:37:36,275 INFO Resumen candidatos: total=20 (preview):
2025-09-30 15:37:36,282 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  HLIO  52.680000 0.528143  52.708031  53.487016  51.322827 66.554251 45.616497        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.793693 COMMODITIES
   SGI  82.375000 0.661607  82.672252  83.683927  82.135694 59.375147 40.474020        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.587262 COMMODITIES
   ADM  60.389999 0.858364  60.548157  60.936989  60.270946 63.938827 47.412476        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.391667 COMMODITIES
   PVH  84.535004 1.212384  85.815904  85.398012  82.277331 70.728221 41.284874        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.427920 COMMODITIES
   PBF  30.520201 0.904643  31.702937  30.888017  28.327428 48.978423 42.523909        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.479560     ENERGIA
   XOM 113.150002 1.054929 114.985016 114.155512 112.465789 40.508453 39.912229        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.763301     ENERGIA
   DVN  34.880001 0.539258  35.715371  35.283644  34.722843 45.061703 43.244115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.775758     ENERGIA
   OXY  46.972500 0.687293  47.522601  46.955773  46.095527 37.031916 47.190498        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.633088     ENERGIA
   MDB 316.209991 4.051769 317.401556 317.788438 291.416734 50.867150 45.954529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.936954  FINANCIERO
    HD 406.475006 2.694288 408.251950 411.692929 405.619685 63.883569 39.366329        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.517843  FINANCIERO
   STE 245.595001 2.282143 246.250020 247.096174 244.534100 52.555573 46.591882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.099991  FINANCIERO
   WSM 196.595001 3.214129 196.843087 198.098618 195.823442 50.828992 47.662674        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.492526  FINANCIERO
     A 123.580002 1.104179 123.630770 124.674756 123.212774 66.079626 45.126326        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.928987       SALUD
   ABT 132.929993 1.120984 133.327686 133.575696 132.544304 64.616255 45.228123        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.586554       SALUD
   MDT  93.904999 0.835351  94.216833  94.238614  93.135823 61.657284 44.628577        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.332353       SALUD
   HWC  62.459999 0.657985  62.782185  62.947243  62.276114 54.691701 44.654646        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.188924       SALUD
  RDDT 235.399994 5.796906 239.854134 245.082996 230.434140 57.805868 41.676524        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.054555  TECNOLOGÍA
    AN 217.244995 2.692136 217.464141 219.192754 216.594031 58.358653 46.302803        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.382383  TECNOLOGÍA
    ZM  83.224998 0.810635  83.788890  83.806721  81.296697 59.979400 42.426454        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.980111  TECNOLOGÍA
  AVGO 329.149994 5.022136 334.093463 338.261863 324.849217 44.006877 38.189238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.052670  TECNOLOGÍA
2025-09-30 15:40:43,534 INFO === RUN PIPELINE START 2025-09-30T13:40:43.534133 UTC ===
2025-09-30 15:40:43,534 INFO Stage=fetch attempt 1/2
2025-09-30 15:40:43,535 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 15:41:23,390 INFO Salida (1_fetch_indicators.py): returncode=0 (t=39.9s)
2025-09-30 15:41:23,391 WARNING stderr: 2025-09-30 15:40:44,346 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-30 15:41:23,393 INFO Stage fetch completado correctamente.
2025-09-30 15:41:23,394 INFO Stage=score attempt 1/2
2025-09-30 15:41:23,395 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 15:41:24,274 INFO Salida (2_score_select.py): returncode=0 (t=0.9s)
2025-09-30 15:41:24,274 WARNING stderr: 2025-09-30 15:41:24,095 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 15:41:24,106 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 15:41:24,122 INFO Hard filters applied: passed=72 rejected=1026 (total=1098)
2025-09-30 15:41:24,131 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 15:41:24,142 INFO Scoring computed. Score stats: min=7.58 median=27.27 max=56.05
2025-09-30 15:41:24,145 INFO Selected top 4 per sector. Selected rows=20
2025-09-30 15:41:24,156 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 15:41:24,161 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 15:41:24,162 INFO SUMMARY: total_indicators=1098 passed=72 selected=20 rejected=1026
2025-09-30 15:41:24,162 INFO Sector=COMMODITIES -> HLIO, SGI, ADM, PVH
2025-09-30 15:41:24,163 INFO Sector=ENERGIA -> PBF, XOM, DVN, OXY
2025-09-30 15:41:24,163 INFO Sector=FINANCIERO -> MDB, HD, STE, WSM
2025-09-30 15:41:24,163 INFO Sector=SALUD -> A, ABT, MDT, HWC
2025-09-30 15:41:24,163 INFO Sector=TECNOLOGÍA -> RDDT, AN, ZM, AVGO
2025-09-30 15:41:24,277 INFO Stage score completado correctamente.
2025-09-30 15:41:24,278 INFO Stage=export attempt 1/2
2025-09-30 15:41:24,279 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 15:41:40,191 INFO Salida (3_export_sheets.py): returncode=0 (t=15.9s)
2025-09-30 15:41:40,191 WARNING stderr: 2025-09-30 15:41:25,124 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 15:41:25,125 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 15:41:25,129 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 15:41:25,129 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 15:41:26,894 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 15:41:26,894 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 15:41:29,655 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H10 (cols=8) filas=4 (tickers: PBF, XOM, DVN, OXY)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:41:30,376 INFO export_sheets: Hoja 'ENERGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 15:41:30,376 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 15:41:32,083 INFO export_sheets: Ticker A omitido en 'SALUD' por duplicado reciente.
2025-09-30 15:41:32,083 INFO export_sheets: Ticker ABT omitido en 'SALUD' por duplicado reciente.
2025-09-30 15:41:32,084 INFO export_sheets: Ticker MDT omitido en 'SALUD' por duplicado reciente.
2025-09-30 15:41:32,084 INFO export_sheets: Ticker HWC omitido en 'SALUD' por duplicado reciente.
2025-09-30 15:41:32,084 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-09-30 15:41:32,084 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 15:41:34,251 INFO export_sheets: Ticker PVH omitido en 'COMMODITIES' por duplicado reciente.
2025-09-30 15:41:35,273 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H8 (cols=8) filas=3 (tickers: HLIO, SGI, ADM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:41:35,990 INFO export_sheets: Hoja 'COMMODITIES': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 15:41:35,990 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 15:41:37,168 INFO export_sheets: Ticker MDB omitido en 'FINANCIERO' por duplicado reciente.
2025-09-30 15:41:38,147 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H8 (cols=8) filas=3 (tickers: HD, STE, WSM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:41:38,378 INFO export_sheets: Hoja 'FINANCIERO': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 15:41:38,378 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 15:41:40,072 INFO export_sheets: Ticker RDDT omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-30 15:41:40,072 INFO export_sheets: Ticker AN omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-30 15:41:40,072 INFO export_sheets: Ticker ZM omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-30 15:41:40,072 INFO export_sheets: Ticker AVGO omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-09-30 15:41:40,072 INFO export_sheets: No hay filas nu
2025-09-30 15:41:40,192 INFO Stage export completado correctamente.
2025-09-30 15:41:40,193 INFO === RUN PIPELINE END 2025-09-30T13:41:40.193091 UTC (duración 56.7 s) ===
2025-09-30 15:41:40,671 INFO Resumen candidatos: total=20 (preview):
2025-09-30 15:41:40,679 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  HLIO  52.680000 0.528143  52.708031  53.487016  51.322827 66.554251 45.616497        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.793693 COMMODITIES
   SGI  82.375000 0.661607  82.672252  83.683927  82.135694 59.375147 40.474020        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.587262 COMMODITIES
   ADM  60.389999 0.858364  60.548157  60.936989  60.270946 63.938827 47.412476        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.391667 COMMODITIES
   PVH  84.535004 1.212384  85.815904  85.398012  82.277331 70.728221 41.284874        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.427920 COMMODITIES
   PBF  30.520201 0.904643  31.702937  30.888017  28.327428 48.978423 42.523909        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.479560     ENERGIA
   XOM 113.150002 1.054929 114.985016 114.155512 112.465789 40.508453 39.912229        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.763301     ENERGIA
   DVN  34.880001 0.539258  35.715371  35.283644  34.722843 45.061703 43.244115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.775758     ENERGIA
   OXY  46.972500 0.687293  47.522601  46.955773  46.095527 37.031916 47.190498        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.633088     ENERGIA
   MDB 316.209991 4.051769 317.401556 317.788438 291.416734 50.867150 45.954529        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.936954  FINANCIERO
    HD 406.475006 2.694288 408.251950 411.692929 405.619685 63.883569 39.366329        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.517843  FINANCIERO
   STE 245.595001 2.282143 246.250020 247.096174 244.534100 52.555573 46.591882        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.099991  FINANCIERO
   WSM 196.595001 3.214129 196.843087 198.098618 195.823442 50.828992 47.662674        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.492526  FINANCIERO
     A 123.580002 1.104179 123.630770 124.674756 123.212774 66.079626 45.126326        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.928987       SALUD
   ABT 132.929993 1.120984 133.327686 133.575696 132.544304 64.616255 45.228123        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.586554       SALUD
   MDT  93.904999 0.835351  94.216833  94.238614  93.135823 61.657284 44.628577        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.332353       SALUD
   HWC  62.459999 0.657985  62.782185  62.947243  62.276114 54.691701 44.654646        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.188924       SALUD
  RDDT 235.399994 5.796906 239.854134 245.082996 230.434140 57.805868 41.676524        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.054555  TECNOLOGÍA
    AN 217.244995 2.692136 217.464141 219.192754 216.594031 58.358653 46.302803        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.382383  TECNOLOGÍA
    ZM  83.224998 0.810635  83.788890  83.806721  81.296697 59.979400 42.426454        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.980111  TECNOLOGÍA
  AVGO 329.149994 5.022136 334.093463 338.261863 324.849217 44.006877 38.189238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.052670  TECNOLOGÍA
2025-09-30 15:55:07,204 INFO === RUN PIPELINE START 2025-09-30T13:55:07.204029 UTC ===
2025-09-30 15:55:07,205 INFO Stage=fetch attempt 1/2
2025-09-30 15:55:07,206 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 15:56:37,274 INFO Salida (1_fetch_indicators.py): returncode=0 (t=90.1s)
2025-09-30 15:56:37,274 WARNING stderr: 2025-09-30 15:55:08,147 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-09-30 15:55:08,158 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-09-30 15:55:08,170 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 15:55:09,504 ERROR HTTP Error 404: 
2025-09-30 15:55:16,482 ERROR 
32 Failed downloads:
2025-09-30 15:55:16,482 ERROR ['CEZ', 'AF', 'ACS', 'ANA', 'BNP', 'BMW', 'COL', 'CABK', 'CIE', 'AYV']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 15:55:16,482 ERROR ['BHIA3', 'CHK', 'ADS', 'AYDEN', 'CAP', 'CNC.MI', 'ANTM', 'CERN', 'BAS', 'ALO', 'AIXA', 'CMIN3', 'BP.LS', 'CBK', 'BC8', 'BAYN', 'CPFE3', 'ALFAA', 'AGUA', 'AMNB', 'BBSE3']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-30 15:55:16,482 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759240593. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a futu
2025-09-30 15:56:37,275 INFO Stage fetch completado correctamente.
2025-09-30 15:56:37,277 INFO Stage=score attempt 1/2
2025-09-30 15:56:37,278 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 15:56:37,979 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-30 15:56:37,980 WARNING stderr: 2025-09-30 15:56:37,846 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 15:56:37,855 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 15:56:37,867 INFO Hard filters applied: passed=22 rejected=1076 (total=1098)
2025-09-30 15:56:37,875 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 15:56:37,886 INFO Scoring computed. Score stats: min=25.13 median=47.88 max=72.02
2025-09-30 15:56:37,888 INFO Selected top 4 per sector. Selected rows=17
2025-09-30 15:56:37,898 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 15:56:37,901 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 15:56:37,901 INFO SUMMARY: total_indicators=1098 passed=22 selected=17 rejected=1076
2025-09-30 15:56:37,902 INFO Sector=COMMODITIES -> STRL, GATX, MKSI, ADS.DE
2025-09-30 15:56:37,902 INFO Sector=ENERGIA -> BE, OKLO, OXY, GE
2025-09-30 15:56:37,903 INFO Sector=FINANCIERO -> FDX, QS, FWONK, JOBY
2025-09-30 15:56:37,903 INFO Sector=SALUD -> UTHR
2025-09-30 15:56:37,903 INFO Sector=TECNOLOGÍA -> RBLX, NTNX, GLBE, UBER
2025-09-30 15:56:37,980 INFO Stage score completado correctamente.
2025-09-30 15:56:37,981 INFO Stage=export attempt 1/2
2025-09-30 15:56:37,981 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 15:56:59,376 INFO Salida (3_export_sheets.py): returncode=0 (t=21.4s)
2025-09-30 15:56:59,377 WARNING stderr: 2025-09-30 15:56:38,866 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 15:56:38,867 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 15:56:38,872 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 15:56:38,872 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 15:56:40,864 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 15:56:40,864 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 15:56:42,087 INFO export_sheets: Ticker OXY omitido en 'ENERGÍA' por duplicado reciente.
2025-09-30 15:56:43,591 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A11:H13 (cols=8) filas=3 (tickers: BE, OKLO, GE)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:56:43,957 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 15:56:43,957 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 15:56:47,602 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H7 (cols=8) filas=1 (tickers: UTHR)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:56:48,344 INFO export_sheets: Hoja 'SALUD': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 15:56:48,344 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 15:56:51,144 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A9:H12 (cols=8) filas=4 (tickers: STRL, GATX, MKSI, ADS.DE)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:56:51,842 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 15:56:51,842 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 15:56:55,494 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A9:H12 (cols=8) filas=4 (tickers: FDX, QS, FWONK, JOBY)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 15:56:55,723 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 15:56:55,724 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 15:56:58,531 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H10 (cols=8) filas=4 (tickers: RBLX, NTNX, GLBE, UBER)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-
2025-09-30 15:56:59,378 INFO Stage export completado correctamente.
2025-09-30 15:56:59,379 INFO === RUN PIPELINE END 2025-09-30T13:56:59.379732 UTC (duración 112.2 s) ===
2025-09-30 15:56:59,843 INFO Resumen candidatos: total=17 (preview):
2025-09-30 15:56:59,850 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  STRL 339.970001 8.470064 344.070632 336.437728 308.752771 44.812171 46.760344        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.988836 COMMODITIES
  GATX 174.570007 1.463928 175.303328 173.295966 167.674305 58.712352 49.166263        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.566688 COMMODITIES
  MKSI 122.279999 1.938922 123.081809 121.310963 113.042377 34.642966 46.615895        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.995169 COMMODITIES
ADS.DE 181.149994 1.819644 181.650885 180.797250 178.563786 35.456943 48.295671        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.816138 COMMODITIES
    BE  72.175201 2.660956  72.252591  71.151066  59.376079 72.361096 48.896061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 72.015337     ENERGIA
  OKLO 112.415001 6.909065 117.945605 111.370507  91.956317 39.544848 43.834051        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.156864     ENERGIA
   OXY  46.959999 0.695865  47.521038  46.955282  46.095361 36.304006 47.086753        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.894514     ENERGIA
    GE 295.203613 3.192612 296.222875 293.611331 282.739803 45.757205 47.530284        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 37.198456     ENERGIA
   FDX 233.330002 2.707078 235.681657 232.659528 230.606677 74.548320 46.963626        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.829825  FINANCIERO
    QS  12.360000 0.656593  12.523458  11.749886  10.270133 60.552791 49.769206        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.609185  FINANCIERO
 FWONK 103.654999 0.987886 104.121358 102.897038 101.634761 60.387850 49.817186        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.956431  FINANCIERO
  JOBY  15.710000 0.629222  15.959988  15.429948  15.037119 50.457090 48.964533        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.812605  FINANCIERO
  UTHR 421.970001 7.306501 424.728944 414.266554 375.080851 60.836958 49.277900        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 68.859849       SALUD
  RBLX 135.070007 3.065848 136.061025 134.198365 129.360920 61.009401 49.619905        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 70.723998  TECNOLOGÍA
  NTNX  76.370003 0.825964  76.696014  76.195152  74.359091 60.630854 48.401898        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 63.733778  TECNOLOGÍA
  GLBE  36.505001 0.627101  36.731487  36.419019  35.139038 59.254546 48.092676        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 63.512846  TECNOLOGÍA
  UBER  97.620003 1.094444  98.486877  97.320601  95.315376 63.503876 47.237676        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.182282  TECNOLOGÍA
2025-09-30 16:07:45,334 INFO === RUN PIPELINE START 2025-09-30T14:07:45.334607 UTC ===
2025-09-30 16:07:45,335 INFO Stage=fetch attempt 1/2
2025-09-30 16:07:45,335 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 16:08:23,647 INFO Salida (1_fetch_indicators.py): returncode=0 (t=38.3s)
2025-09-30 16:08:23,647 WARNING stderr: 2025-09-30 16:07:46,450 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-30 16:08:23,648 INFO Stage fetch completado correctamente.
2025-09-30 16:08:23,649 INFO Stage=score attempt 1/2
2025-09-30 16:08:23,650 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 16:08:24,354 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-30 16:08:24,355 WARNING stderr: 2025-09-30 16:08:24,216 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 16:08:24,225 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 16:08:24,239 INFO Hard filters applied: passed=3 rejected=1095 (total=1098)
2025-09-30 16:08:24,248 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 16:08:24,256 INFO Scoring computed. Score stats: min=28.05 median=35.72 max=52.99
2025-09-30 16:08:24,258 INFO Selected top 4 per sector. Selected rows=3
2025-09-30 16:08:24,267 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 16:08:24,271 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 16:08:24,271 INFO SUMMARY: total_indicators=1098 passed=3 selected=3 rejected=1095
2025-09-30 16:08:24,272 INFO Sector=COMMODITIES -> STRL
2025-09-30 16:08:24,272 INFO Sector=ENERGIA -> GE
2025-09-30 16:08:24,272 INFO Sector=TECNOLOGÍA -> QRVO
2025-09-30 16:08:24,355 INFO Stage score completado correctamente.
2025-09-30 16:08:24,356 INFO Stage=export attempt 1/2
2025-09-30 16:08:24,356 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 16:08:36,177 INFO Salida (3_export_sheets.py): returncode=0 (t=11.8s)
2025-09-30 16:08:36,178 WARNING stderr: 2025-09-30 16:08:25,251 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 16:08:25,252 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 16:08:25,257 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 16:08:25,258 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 16:08:27,213 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 16:08:27,213 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 16:08:28,969 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H7 (cols=8) filas=1 (tickers: GE)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:08:29,742 INFO export_sheets: Hoja 'ENERGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 16:08:29,742 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 16:08:29,979 INFO export_sheets: No se encontraron candidatos para sheet 'SALUD' (ni exact ni fuzzy).
2025-09-30 16:08:29,980 INFO export_sheets: No hay candidatos para sheet 'SALUD'. Saltando.
2025-09-30 16:08:29,980 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 16:08:32,638 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H6 (cols=8) filas=1 (tickers: STRL)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:08:33,378 INFO export_sheets: Hoja 'COMMODITIES': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 16:08:33,378 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 16:08:33,607 INFO export_sheets: No se encontraron candidatos para sheet 'FINANCIERO' (ni exact ni fuzzy).
2025-09-30 16:08:33,607 INFO export_sheets: No hay candidatos para sheet 'FINANCIERO'. Saltando.
2025-09-30 16:08:33,607 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 16:08:35,799 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H7 (cols=8) filas=1 (tickers: QRVO)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:08:36,047 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 16:08:36,047 INFO export_sheets: Export finalizado.
2025-09-30 16:08:36,178 INFO Stage export completado correctamente.
2025-09-30 16:08:36,179 INFO === RUN PIPELINE END 2025-09-30T14:08:36.179779 UTC (duración 50.8 s) ===
2025-09-30 16:08:36,641 INFO Resumen candidatos: total=3 (preview):
2025-09-30 16:08:36,646 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  STRL 339.970001 8.470064 344.070632 336.437728 308.752771 44.812171 46.760344        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.988836 COMMODITIES
    GE 295.203613 3.192612 296.222875 293.611331 282.739803 45.757205 47.530284        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.723945     ENERGIA
  QRVO  91.599998 1.187400  92.097345  91.489750  90.150758 45.916800 47.616952        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.050121  TECNOLOGÍA
2025-09-30 16:16:13,753 INFO === RUN PIPELINE START 2025-09-30T14:16:13.753033 UTC ===
2025-09-30 16:16:13,755 INFO Stage=fetch attempt 1/2
2025-09-30 16:16:13,756 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 16:17:50,904 INFO Salida (1_fetch_indicators.py): returncode=0 (t=97.1s)
2025-09-30 16:17:50,904 WARNING stderr: 2025-09-30 16:16:14,774 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-09-30 16:16:14,787 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-09-30 16:16:14,798 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 16:16:16,052 ERROR HTTP Error 404: 
2025-09-30 16:16:23,363 ERROR 
32 Failed downloads:
2025-09-30 16:16:23,364 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759241858. The requested range must be within the last 60 days.")')
2025-09-30 16:16:23,364 ERROR ['AF', 'ANA', 'AYV', 'CABK', 'CEZ', 'BNP', 'ACS', 'BMW', 'COL', 'CIE']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 16:16:23,364 ERROR ['BHIA3', 'CHK', 'CPFE3', 'BP.LS', 'ALO', 'CBK', 'ANTM', 'AMNB', 'CERN', 'BAS', 'AYDEN', 'BBSE3', 'AIXA', 'CAP', 'ADS', 'AGUA', 'CNC.MI', 'BC8', 'ALFAA', 'BAYN', 'CMIN3']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a futu
2025-09-30 16:17:50,905 INFO Stage fetch completado correctamente.
2025-09-30 16:17:50,908 INFO Stage=score attempt 1/2
2025-09-30 16:17:50,909 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 16:17:51,678 INFO Salida (2_score_select.py): returncode=0 (t=0.8s)
2025-09-30 16:17:51,678 WARNING stderr: 2025-09-30 16:17:51,561 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 16:17:51,569 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 16:17:51,579 INFO Hard filters applied: passed=5 rejected=1093 (total=1098)
2025-09-30 16:17:51,586 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 16:17:51,594 INFO Scoring computed. Score stats: min=26.26 median=47.18 max=53.21
2025-09-30 16:17:51,596 INFO Selected top 4 per sector. Selected rows=5
2025-09-30 16:17:51,603 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 16:17:51,605 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 16:17:51,605 INFO SUMMARY: total_indicators=1098 passed=5 selected=5 rejected=1093
2025-09-30 16:17:51,606 INFO Sector=ENERGIA -> OKLO
2025-09-30 16:17:51,606 INFO Sector=FINANCIERO -> GS, RENT3.SA, WFC
2025-09-30 16:17:51,606 INFO Sector=TECNOLOGÍA -> WIX
2025-09-30 16:17:51,680 INFO Stage score completado correctamente.
2025-09-30 16:17:51,683 INFO Stage=export attempt 1/2
2025-09-30 16:17:51,684 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 16:18:04,234 INFO Salida (3_export_sheets.py): returncode=0 (t=12.5s)
2025-09-30 16:18:04,234 WARNING stderr: 2025-09-30 16:17:52,668 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 16:17:52,668 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 16:17:52,673 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 16:17:52,674 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 16:17:54,584 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 16:17:54,584 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 16:17:56,294 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-09-30 16:17:56,294 INFO export_sheets: No hay filas nuevas para añadir en 'ENERGÍA' (tras filtrar duplicados).
2025-09-30 16:17:56,294 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 16:17:57,023 INFO export_sheets: No se encontraron candidatos para sheet 'SALUD' (ni exact ni fuzzy).
2025-09-30 16:17:57,024 INFO export_sheets: No hay candidatos para sheet 'SALUD'. Saltando.
2025-09-30 16:17:57,024 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 16:17:57,353 INFO export_sheets: No se encontraron candidatos para sheet 'COMMODITIES' (ni exact ni fuzzy).
2025-09-30 16:17:57,353 INFO export_sheets: No hay candidatos para sheet 'COMMODITIES'. Saltando.
2025-09-30 16:17:57,353 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 16:18:00,812 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H8 (cols=8) filas=3 (tickers: GS, RENT3.SA, WFC)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:18:01,065 INFO export_sheets: Hoja 'FINANCIERO': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 16:18:01,065 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 16:18:03,405 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H7 (cols=8) filas=1 (tickers: WIX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:18:04,111 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 16:18:04,111 INFO export_sheets: Export finalizado.
2025-09-30 16:18:04,235 INFO Stage export completado correctamente.
2025-09-30 16:18:04,237 INFO === RUN PIPELINE END 2025-09-30T14:18:04.237529 UTC (duración 110.5 s) ===
2025-09-30 16:18:04,734 INFO Resumen candidatos: total=5 (preview):
2025-09-30 16:18:04,740 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
    OKLO 111.714996 6.565629 117.130138 111.371394  92.213643 42.406538 43.157881        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.179397    ENERGIA
      GS 795.909973 8.095856 800.924935 792.994764 765.620012 45.389183 46.699480        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.004400 FINANCIERO
RENT3.SA  39.970001 0.529285  40.156848  39.521159  37.888798 38.584481 49.372451        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.666149 FINANCIERO
     WFC  84.000000 0.678750  84.469761  83.543716  81.941263 41.484041 48.089408        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.258404 FINANCIERO
     WIX 177.130005 3.349100 177.965346 174.801547 160.816207 40.223823 48.468697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.211670 TECNOLOGÍA
2025-09-30 16:22:27,492 INFO === RUN PIPELINE START 2025-09-30T14:22:27.492486 UTC ===
2025-09-30 16:22:27,493 INFO Stage=fetch attempt 1/2
2025-09-30 16:22:27,493 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 16:23:05,883 INFO Salida (1_fetch_indicators.py): returncode=0 (t=38.4s)
2025-09-30 16:23:05,883 WARNING stderr: 2025-09-30 16:22:28,377 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-30 16:23:05,884 INFO Stage fetch completado correctamente.
2025-09-30 16:23:05,884 INFO Stage=score attempt 1/2
2025-09-30 16:23:05,884 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 16:23:06,604 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-30 16:23:06,604 WARNING stderr: 2025-09-30 16:23:06,443 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 16:23:06,451 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 16:23:06,467 INFO Hard filters applied: passed=6 rejected=1092 (total=1098)
2025-09-30 16:23:06,476 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 16:23:06,486 INFO Scoring computed. Score stats: min=26.26 median=48.06 max=53.21
2025-09-30 16:23:06,490 INFO Selected top 4 per sector. Selected rows=6
2025-09-30 16:23:06,499 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 16:23:06,502 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 16:23:06,502 INFO SUMMARY: total_indicators=1098 passed=6 selected=6 rejected=1092
2025-09-30 16:23:06,502 INFO Sector=ENERGIA -> OKLO
2025-09-30 16:23:06,502 INFO Sector=FINANCIERO -> GS, PSTG, RENT3.SA, WFC
2025-09-30 16:23:06,503 INFO Sector=TECNOLOGÍA -> WIX
2025-09-30 16:23:06,605 INFO Stage score completado correctamente.
2025-09-30 16:23:06,605 INFO Stage=export attempt 1/2
2025-09-30 16:23:06,606 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 16:23:18,243 INFO Salida (3_export_sheets.py): returncode=0 (t=11.6s)
2025-09-30 16:23:18,244 WARNING stderr: 2025-09-30 16:23:07,507 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 16:23:07,508 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 16:23:07,513 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 16:23:07,514 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 16:23:09,459 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 16:23:09,459 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 16:23:10,704 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-09-30 16:23:10,704 INFO export_sheets: No hay filas nuevas para añadir en 'ENERGÍA' (tras filtrar duplicados).
2025-09-30 16:23:10,704 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 16:23:11,070 INFO export_sheets: No se encontraron candidatos para sheet 'SALUD' (ni exact ni fuzzy).
2025-09-30 16:23:11,071 INFO export_sheets: No hay candidatos para sheet 'SALUD'. Saltando.
2025-09-30 16:23:11,071 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 16:23:11,302 INFO export_sheets: No se encontraron candidatos para sheet 'COMMODITIES' (ni exact ni fuzzy).
2025-09-30 16:23:11,302 INFO export_sheets: No hay candidatos para sheet 'COMMODITIES'. Saltando.
2025-09-30 16:23:11,302 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 16:23:14,007 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: GS, PSTG, RENT3.SA, WFC)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:23:14,259 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 16:23:14,259 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 16:23:17,401 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H7 (cols=8) filas=1 (tickers: WIX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:23:18,109 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 16:23:18,109 INFO export_sheets: Export finalizado.
2025-09-30 16:23:18,245 INFO Stage export completado correctamente.
2025-09-30 16:23:18,246 INFO === RUN PIPELINE END 2025-09-30T14:23:18.246225 UTC (duración 50.8 s) ===
2025-09-30 16:23:18,709 INFO Resumen candidatos: total=6 (preview):
2025-09-30 16:23:18,714 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
    OKLO 111.714996 6.565629 117.130138 111.371394  92.213643 42.406538 43.157881        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.179397    ENERGIA
      GS 795.909973 8.095856 800.924935 792.994764 765.620012 45.389183 46.699480        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.004400 FINANCIERO
    PSTG  83.669998 1.305858  83.767807  83.626878  75.672380 37.823677 46.139527        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.934286 FINANCIERO
RENT3.SA  39.970001 0.529285  40.156848  39.521159  37.888798 38.584481 49.372451        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.666149 FINANCIERO
     WFC  84.000000 0.678750  84.469761  83.543716  81.941263 41.484041 48.089408        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.258404 FINANCIERO
     WIX 177.130005 3.349100 177.965346 174.801547 160.816207 40.223823 48.468697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.211670 TECNOLOGÍA
2025-09-30 16:27:41,943 INFO === RUN PIPELINE START 2025-09-30T14:27:41.943313 UTC ===
2025-09-30 16:27:41,944 INFO Stage=fetch attempt 1/2
2025-09-30 16:27:41,947 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 16:28:16,956 INFO Salida (1_fetch_indicators.py): returncode=0 (t=35.0s)
2025-09-30 16:28:16,956 WARNING stderr: 2025-09-30 16:27:42,674 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-09-30 16:28:16,957 INFO Stage fetch completado correctamente.
2025-09-30 16:28:16,957 INFO Stage=score attempt 1/2
2025-09-30 16:28:16,957 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 16:28:17,534 INFO Salida (2_score_select.py): returncode=0 (t=0.6s)
2025-09-30 16:28:17,534 WARNING stderr: 2025-09-30 16:28:17,429 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 16:28:17,437 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 16:28:17,446 INFO Hard filters applied: passed=6 rejected=1092 (total=1098)
2025-09-30 16:28:17,453 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 16:28:17,460 INFO Scoring computed. Score stats: min=26.26 median=48.06 max=53.21
2025-09-30 16:28:17,462 INFO Selected top 4 per sector. Selected rows=6
2025-09-30 16:28:17,469 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 16:28:17,472 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 16:28:17,473 INFO SUMMARY: total_indicators=1098 passed=6 selected=6 rejected=1092
2025-09-30 16:28:17,473 INFO Sector=ENERGIA -> OKLO
2025-09-30 16:28:17,474 INFO Sector=FINANCIERO -> GS, PSTG, RENT3.SA, WFC
2025-09-30 16:28:17,474 INFO Sector=TECNOLOGÍA -> WIX
2025-09-30 16:28:17,535 INFO Stage score completado correctamente.
2025-09-30 16:28:17,536 INFO Stage=export attempt 1/2
2025-09-30 16:28:17,536 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 16:28:27,975 INFO Salida (3_export_sheets.py): returncode=0 (t=10.4s)
2025-09-30 16:28:27,975 WARNING stderr: 2025-09-30 16:28:18,242 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 16:28:18,243 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 16:28:18,248 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 16:28:18,249 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 16:28:19,861 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 16:28:19,861 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 16:28:21,603 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-09-30 16:28:21,603 INFO export_sheets: No hay filas nuevas para añadir en 'ENERGÍA' (tras filtrar duplicados).
2025-09-30 16:28:21,603 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 16:28:21,849 INFO export_sheets: No se encontraron candidatos para sheet 'SALUD' (ni exact ni fuzzy).
2025-09-30 16:28:21,849 INFO export_sheets: No hay candidatos para sheet 'SALUD'. Saltando.
2025-09-30 16:28:21,849 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 16:28:22,095 INFO export_sheets: No se encontraron candidatos para sheet 'COMMODITIES' (ni exact ni fuzzy).
2025-09-30 16:28:22,095 INFO export_sheets: No hay candidatos para sheet 'COMMODITIES'. Saltando.
2025-09-30 16:28:22,095 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 16:28:24,305 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: GS, PSTG, RENT3.SA, WFC)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:28:25,046 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 16:28:25,046 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 16:28:27,648 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H7 (cols=8) filas=1 (tickers: WIX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:28:27,871 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-09-30 16:28:27,871 INFO export_sheets: Export finalizado.
2025-09-30 16:28:27,976 INFO Stage export completado correctamente.
2025-09-30 16:28:27,977 INFO === RUN PIPELINE END 2025-09-30T14:28:27.977732 UTC (duración 46.0 s) ===
2025-09-30 16:28:28,414 INFO Resumen candidatos: total=6 (preview):
2025-09-30 16:28:28,422 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
    OKLO 111.714996 6.565629 117.130138 111.371394  92.213643 42.406538 43.157881        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.179397    ENERGIA
      GS 795.909973 8.095856 800.924935 792.994764 765.620012 45.389183 46.699480        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.004400 FINANCIERO
    PSTG  83.669998 1.305858  83.767807  83.626878  75.672380 37.823677 46.139527        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.934286 FINANCIERO
RENT3.SA  39.970001 0.529285  40.156848  39.521159  37.888798 38.584481 49.372451        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.666149 FINANCIERO
     WFC  84.000000 0.678750  84.469761  83.543716  81.941263 41.484041 48.089408        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.258404 FINANCIERO
     WIX 177.130005 3.349100 177.965346 174.801547 160.816207 40.223823 48.468697        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.211670 TECNOLOGÍA
2025-09-30 16:48:29,707 INFO === RUN PIPELINE START 2025-09-30T14:48:29.707383 UTC ===
2025-09-30 16:48:29,708 INFO Stage=fetch attempt 1/2
2025-09-30 16:48:29,708 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 16:49:59,473 INFO Salida (1_fetch_indicators.py): returncode=0 (t=89.8s)
2025-09-30 16:49:59,474 WARNING stderr: 2025-09-30 16:48:30,612 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-30 16:48:30,625 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 16:48:32,012 ERROR HTTP Error 404: 
2025-09-30 16:48:32,173 ERROR HTTP Error 404: 
2025-09-30 16:48:38,685 ERROR 
32 Failed downloads:
2025-09-30 16:48:38,685 ERROR ['CEZ', 'AYV', 'AF', 'CIE', 'CABK', 'ACS', 'COL', 'BNP', 'BMW', 'ANA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 16:48:38,685 ERROR ['BP.LS', 'ALFAA', 'CHK', 'BBSE3', 'ANTM', 'CPFE3', 'AMNB', 'AIXA', 'CERN', 'CNC.MI', 'ADS', 'CBK', 'ALO', 'AYDEN', 'CAP', 'BHIA3', 'AGUA', 'BAYN', 'BC8', 'BAS', 'CMIN3']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-30 16:48:38,685 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759243797. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-30 16:48:40
2025-09-30 16:49:59,475 INFO Stage fetch completado correctamente.
2025-09-30 16:49:59,475 INFO Stage=score attempt 1/2
2025-09-30 16:49:59,475 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 16:50:00,135 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-30 16:50:00,136 WARNING stderr: 2025-09-30 16:49:59,996 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 16:50:00,003 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 16:50:00,014 INFO Hard filters applied: passed=27 rejected=1071 (total=1098)
2025-09-30 16:50:00,022 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 16:50:00,052 INFO Scoring computed. Score stats: min=20.96 median=29.77 max=65.61
2025-09-30 16:50:00,055 INFO Selected top 4 per sector. Selected rows=16
2025-09-30 16:50:00,064 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 16:50:00,067 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 16:50:00,067 INFO SUMMARY: total_indicators=1098 passed=27 selected=16 rejected=1071
2025-09-30 16:50:00,068 INFO Sector=COMMODITIES -> STRL, TPR, MKSI, GATX
2025-09-30 16:50:00,068 INFO Sector=ENERGIA -> OKLO, MPC, PSX, WFRD
2025-09-30 16:50:00,068 INFO Sector=FINANCIERO -> GS, JPM, BCO, RENT3.SA
2025-09-30 16:50:00,068 INFO Sector=SALUD -> UTHR, EXAS, CVS
2025-09-30 16:50:00,068 INFO Sector=TECNOLOGÍA -> SW.PA
2025-09-30 16:50:00,136 INFO Stage score completado correctamente.
2025-09-30 16:50:00,137 INFO Stage=export attempt 1/2
2025-09-30 16:50:00,137 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 16:50:16,674 INFO Salida (3_export_sheets.py): returncode=0 (t=16.5s)
2025-09-30 16:50:16,675 WARNING stderr: 2025-09-30 16:50:00,964 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 16:50:00,965 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 16:50:00,970 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 16:50:00,970 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 16:50:02,905 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 16:50:02,905 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 16:50:03,671 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-09-30 16:50:05,140 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H9 (cols=8) filas=3 (tickers: MPC, PSX, WFRD)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:50:05,910 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 16:50:05,910 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 16:50:08,633 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H9 (cols=8) filas=3 (tickers: UTHR, EXAS, CVS)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:50:08,884 INFO export_sheets: Hoja 'SALUD': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 16:50:08,884 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 16:50:09,599 INFO export_sheets: Ticker MKSI omitido en 'COMMODITIES' por duplicado reciente.
2025-09-30 16:50:10,766 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H8 (cols=8) filas=3 (tickers: STRL, TPR, GATX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:50:11,005 INFO export_sheets: Hoja 'COMMODITIES': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 16:50:11,005 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 16:50:13,809 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: GS, JPM, BCO, RENT3.SA)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 16:50:14,498 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 16:50:14,498 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 16:50:16,321 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H7 (cols=8) filas=1 (tickers: SW.PA)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merg
2025-09-30 16:50:16,676 INFO Stage export completado correctamente.
2025-09-30 16:50:16,677 INFO === RUN PIPELINE END 2025-09-30T14:50:16.677783 UTC (duración 107.0 s) ===
2025-09-30 16:50:17,166 INFO Resumen candidatos: total=16 (preview):
2025-09-30 16:50:17,173 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    STRL 339.860107 8.527924 343.540488 336.570620 309.164332 50.297341 46.673707        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.426385 COMMODITIES
     TPR 110.639999 1.926571 110.658684 110.137018 106.833231 53.606294 49.432080        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.630861 COMMODITIES
    MKSI 122.900002 1.842136 123.124707 121.395885 113.180783 50.029678 48.642653        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.920219 COMMODITIES
    GATX 174.421402 1.444186 175.282227 173.370807 167.774323 71.130698 48.308215        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.291180 COMMODITIES
    OKLO 113.029999 6.573494 117.294513 111.422963  92.231060 41.726862 44.728431        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.677080     ENERGIA
     MPC 192.970001 2.540236 195.017300 189.802114 181.685044 56.774767 49.456064        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.560158     ENERGIA
     PSX 135.190002 1.910179 136.891306 134.567491 131.129175 65.168317 47.209864        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.083720     ENERGIA
    WFRD  66.300003 1.310950  67.958438  66.118611  62.657477 77.104125 44.934831        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.544988     ENERGIA
      GS 793.047485 8.402283 800.567124 792.882509 765.582098 42.764725 44.582256        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.605036  FINANCIERO
     JPM 312.934998 2.377882 314.608610 311.363103 303.561475 44.230237 47.645599        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.725158  FINANCIERO
     BCO 115.974998 0.835049 116.306591 115.584542 111.343647 35.048944 49.069659        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 43.503682  FINANCIERO
RENT3.SA  39.709999 0.560000  40.124348  39.510963  37.885354 37.045558 45.946407        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.636705  FINANCIERO
    UTHR 419.779999 7.475183 424.196733 414.512533 375.683218 63.739403 47.293807        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.639677       SALUD
    EXAS  53.187199 0.718214  53.429850  53.132247  51.336531 41.241879 47.145393        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.545872       SALUD
     CVS  75.060997 0.879393  75.400862  74.845826  72.155798 47.081096 47.743605        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.384579       SALUD
   SW.PA  53.400002 0.510714  53.728740  53.363453  52.792058 48.231599 46.486151        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.934857  TECNOLOGÍA
2025-09-30 17:03:06,669 INFO === RUN PIPELINE START 2025-09-30T15:03:06.669820 UTC ===
2025-09-30 17:03:06,671 INFO Stage=fetch attempt 1/2
2025-09-30 17:03:06,672 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 17:03:59,496 INFO === RUN PIPELINE START 2025-09-30T15:03:59.496289 UTC ===
2025-09-30 17:03:59,496 INFO Stage=fetch attempt 1/2
2025-09-30 17:03:59,496 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 17:05:29,082 INFO Salida (1_fetch_indicators.py): returncode=0 (t=89.6s)
2025-09-30 17:05:29,082 WARNING stderr: 2025-09-30 17:04:00,356 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-09-30 17:04:00,367 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "A:\pilim\Desktop\Financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-09-30 17:04:00,375 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 17:04:02,869 ERROR HTTP Error 404: 
2025-09-30 17:04:08,871 ERROR 
32 Failed downloads:
2025-09-30 17:04:08,871 ERROR ['ACS', 'CABK', 'CEZ', 'AYV', 'COL', 'AF', 'ANA', 'CIE', 'BMW', 'BNP']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 17:04:08,871 ERROR ['CAP', 'AGUA', 'BC8', 'BAS', 'ALO', 'CHK', 'ALFAA', 'ANTM', 'BBSE3', 'ADS', 'CBK', 'BAYN', 'CNC.MI', 'CMIN3', 'BHIA3', 'AYDEN', 'AIXA', 'AMNB', 'BP.LS', 'CPFE3', 'CERN']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-30 17:04:08,871 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759244729. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a futu
2025-09-30 17:05:29,082 INFO Stage fetch completado correctamente.
2025-09-30 17:05:29,083 INFO Stage=score attempt 1/2
2025-09-30 17:05:29,083 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 17:05:29,777 INFO Salida (2_score_select.py): returncode=0 (t=0.7s)
2025-09-30 17:05:29,777 WARNING stderr: 2025-09-30 17:05:29,662 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 17:05:29,671 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 17:05:29,682 INFO Hard filters applied: passed=31 rejected=1067 (total=1098)
2025-09-30 17:05:29,689 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 17:05:29,697 INFO Scoring computed. Score stats: min=19.13 median=33.37 max=61.83
2025-09-30 17:05:29,700 INFO Selected top 4 per sector. Selected rows=17
2025-09-30 17:05:29,708 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 17:05:29,710 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 17:05:29,710 INFO SUMMARY: total_indicators=1098 passed=31 selected=17 rejected=1067
2025-09-30 17:05:29,711 INFO Sector=COMMODITIES -> STRL, TPR, MKSI, GATX
2025-09-30 17:05:29,711 INFO Sector=ENERGIA -> OKLO, FSLR, MPC, PSX
2025-09-30 17:05:29,711 INFO Sector=FINANCIERO -> LITE, W, RJF, NTRS
2025-09-30 17:05:29,711 INFO Sector=SALUD -> UTHR, ENTG, EXAS
2025-09-30 17:05:29,711 INFO Sector=TECNOLOGÍA -> SNOW, QLYS
2025-09-30 17:05:29,778 INFO Stage score completado correctamente.
2025-09-30 17:05:29,778 INFO Stage=export attempt 1/2
2025-09-30 17:05:29,778 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 17:05:44,245 INFO Salida (3_export_sheets.py): returncode=0 (t=14.5s)
2025-09-30 17:05:44,246 WARNING stderr: 2025-09-30 17:05:30,698 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['ENERGÍA', 'SALUD', 'COMMODITIES', 'FINANCIERO', 'TECNOLOGÍA']
2025-09-30 17:05:30,699 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 17:05:30,704 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 17:05:30,704 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 17:05:32,657 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 17:05:32,657 INFO export_sheets: Procesando hoja config: 'ENERGÍA'
2025-09-30 17:05:33,888 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-09-30 17:05:34,375 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H9 (cols=8) filas=3 (tickers: FSLR, MPC, PSX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 17:05:34,624 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 17:05:34,624 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-09-30 17:05:36,339 INFO export_sheets: Ticker EXAS omitido en 'SALUD' por duplicado reciente.
2025-09-30 17:05:37,380 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H8 (cols=8) filas=2 (tickers: UTHR, ENTG)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 17:05:37,679 INFO export_sheets: Hoja 'SALUD': escritas 2 filas correctamente (preservando columnas derecha).
2025-09-30 17:05:37,679 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 17:05:38,421 INFO export_sheets: Ticker MKSI omitido en 'COMMODITIES' por duplicado reciente.
2025-09-30 17:05:38,923 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H8 (cols=8) filas=3 (tickers: STRL, TPR, GATX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 17:05:39,644 INFO export_sheets: Hoja 'COMMODITIES': escritas 3 filas correctamente (preservando columnas derecha).
2025-09-30 17:05:39,644 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 17:05:42,395 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: LITE, W, RJF, NTRS)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 17:05:42,613 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 17:05:42,613 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-09-30 17:05:43,899 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H8 (cols=8) filas=2 (tickers: SNOW, QLYS)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and ra
2025-09-30 17:05:44,246 INFO Stage export completado correctamente.
2025-09-30 17:05:44,247 INFO === RUN PIPELINE END 2025-09-30T15:05:44.247081 UTC (duración 104.8 s) ===
2025-09-30 17:05:44,689 INFO Resumen candidatos: total=17 (preview):
2025-09-30 17:05:44,696 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  STRL 342.363708 8.644616 343.853438 336.668800 309.197492 50.140718 48.878886        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.268079 COMMODITIES
   TPR 110.320000 1.943714 110.618684 110.124469 106.828993 53.128978 48.360010        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.072802 COMMODITIES
  MKSI 122.654999 1.842136 123.094082 121.386277 113.177538 50.940375 47.865601        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.372649 COMMODITIES
  GATX 174.470001 1.448571 175.288301 173.372713 167.774966 70.785674 48.511650        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.390940 COMMODITIES
  OKLO 113.620003 6.626351 117.368264 111.446100  92.238875 41.304554 45.453060        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.828042     ENERGIA
  FSLR 219.440002 4.283986 221.548639 215.650226 203.977171 46.032020 49.831170        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.990760     ENERGIA
   MPC 192.119995 2.547301 194.911049 189.768780 181.673785 56.504267 47.470580        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.307416     ENERGIA
   PSX 134.809998 1.910179 136.843805 134.552589 131.124142 64.862847 46.053824        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.289923     ENERGIA
  LITE 160.895004 3.572605 161.280453 160.015101 144.051590 58.829916 48.723530        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.240635  FINANCIERO
     W  86.529999 1.987822  86.861391  86.101335  80.820739 69.120497 49.949667        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.315706  FINANCIERO
   RJF 173.982498 1.919959 174.929524 172.956433 169.125468 62.006099 48.868685        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.198558  FINANCIERO
  NTRS 131.770004 1.439741 132.573483 131.281874 129.801963 70.077769 48.853971        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.243864  FINANCIERO
  UTHR 421.804993 7.475183 424.449857 414.591945 375.710039 62.662070 49.074956        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.214716       SALUD
  ENTG  92.730003 1.423930  93.500094  91.896513  87.442032 41.794208 47.241310        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.130986       SALUD
  EXAS  53.310001 0.721072  53.445200  53.137062  51.338157 41.077540 48.636421        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.923177       SALUD
  SNOW 223.639999 3.503496 224.510069 223.607473 219.231447 58.274334 48.314628        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.179289  TECNOLOGÍA
  QLYS 135.259995 1.541773 135.813263 135.041942 134.940670 68.960483 48.548410        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 24.774874  TECNOLOGÍA
2025-09-30 17:37:31,303 INFO === RUN PIPELINE START 2025-09-30T15:37:31.303596 UTC ===
2025-09-30 17:37:31,303 INFO Stage=fetch attempt 1/2
2025-09-30 17:37:31,303 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 17:38:45,260 INFO Salida (1_fetch_indicators.py): returncode=0 (t=74.0s)
2025-09-30 17:38:45,260 WARNING stderr: 2025-09-30 17:37:31,959 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-30 17:37:31,970 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 17:37:34,040 ERROR HTTP Error 404: 
2025-09-30 17:37:39,088 ERROR 
32 Failed downloads:
2025-09-30 17:37:39,088 ERROR ['ANA', 'CABK', 'BNP', 'CIE', 'AF', 'COL', 'BMW', 'AYV', 'ACS', 'CEZ']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 17:37:39,088 ERROR ['ADS', 'ANTM', 'ALFAA', 'BHIA3', 'CBK', 'AGUA', 'AIXA', 'BAYN', 'ALO', 'CNC.MI', 'AYDEN', 'CAP', 'AMNB', 'BBSE3', 'BAS', 'CERN', 'CHK', 'BC8', 'CMIN3', 'BP.LS', 'CPFE3']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-30 17:37:39,088 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759246741. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-30 17:37:40,335 ERROR 
1 Failed download:
2025-09-30 17:37
2025-09-30 17:38:45,261 INFO Stage fetch completado correctamente.
2025-09-30 17:38:45,262 INFO Stage=score attempt 1/2
2025-09-30 17:38:45,262 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 17:38:45,814 INFO Salida (2_score_select.py): returncode=0 (t=0.6s)
2025-09-30 17:38:45,814 WARNING stderr: 2025-09-30 17:38:45,715 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 17:38:45,725 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 17:38:45,737 INFO Hard filters applied: passed=36 rejected=1062 (total=1098)
2025-09-30 17:38:45,744 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 17:38:45,751 INFO Scoring computed. Score stats: min=17.68 median=40.20 max=75.43
2025-09-30 17:38:45,753 INFO Selected top 4 per sector. Selected rows=19
2025-09-30 17:38:45,760 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 17:38:45,763 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 17:38:45,763 INFO SUMMARY: total_indicators=1098 passed=36 selected=19 rejected=1062
2025-09-30 17:38:45,763 INFO Sector=COMMODITIES -> TPR, PII, STRL, MKSI
2025-09-30 17:38:45,763 INFO Sector=ENERGIA -> FSLR, BE, PSX, MPC
2025-09-30 17:38:45,764 INFO Sector=FINANCIERO -> LITE, RENT3.SA, VOE, JPM
2025-09-30 17:38:45,764 INFO Sector=SALUD -> UNH, EXAS, ENTG
2025-09-30 17:38:45,764 INFO Sector=TECNOLOGÍA -> KEYS, SNOW, FLEX, ONTO
2025-09-30 17:38:45,814 INFO Stage score completado correctamente.
2025-09-30 17:38:45,814 INFO Stage=export attempt 1/2
2025-09-30 17:38:45,814 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 17:38:49,861 INFO Salida (3_export_sheets.py): returncode=0 (t=4.0s)
2025-09-30 17:38:49,861 WARNING stderr: 2025-09-30 17:38:46,552 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['FINANCIERO']
2025-09-30 17:38:46,553 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 17:38:46,557 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 17:38:46,557 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 17:38:47,761 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 17:38:47,761 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-09-30 17:38:49,461 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A6:H9 (cols=8) filas=4 (tickers: LITE, RENT3.SA, VOE, JPM)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 17:38:49,767 INFO export_sheets: Hoja 'FINANCIERO': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 17:38:49,767 INFO export_sheets: Export finalizado.
2025-09-30 17:38:49,861 INFO Stage export completado correctamente.
2025-09-30 17:38:49,862 INFO === RUN PIPELINE END 2025-09-30T15:38:49.861988 UTC (duración 78.6 s) ===
2025-09-30 17:38:50,207 INFO Resumen candidatos: total=19 (preview):
2025-09-30 17:38:50,212 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
     TPR 110.379997 1.960857 110.626184 110.126822 106.829787 52.026680 48.557459        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.578807 COMMODITIES
     PII  57.557499 1.052029  57.975280  57.514160  56.192054 88.644291 49.377859        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.854992 COMMODITIES
    STRL 341.829987 8.729887 343.786723 336.647870 309.190423 49.515463 48.422496        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.453833 COMMODITIES
    MKSI 122.790001 1.842136 123.110957 121.391571 113.179326 52.526630 48.288731        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.909440 COMMODITIES
    FSLR 218.744995 4.353915 221.461764 215.622971 203.967966 44.774476 48.678727        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.163927     ENERGIA
      BE  72.089996 2.605956  72.259041  71.197111  59.547675 66.861915 48.669225        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.072593     ENERGIA
     PSX 135.071793 1.912322 136.876530 134.562856 131.127610 64.265986 46.844078        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.807596     ENERGIA
     MPC 192.304993 2.558808 194.934174 189.776035 181.676235 55.540607 47.889013        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.217549     ENERGIA
    LITE 160.690002 3.586176 161.254827 160.007061 144.048874 58.301655 48.300930        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.193351  FINANCIERO
RENT3.SA  39.720001 0.560000  40.125598  39.511355  37.885487 36.006236 46.069387        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.171652  FINANCIERO
     VOE 173.199997 0.854834 173.558119 173.146253 171.819726 66.163949 48.420560        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.634444  FINANCIERO
     JPM 311.410004 2.511455 314.417986 311.303300 303.541276 41.704045 43.974450        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.207949  FINANCIERO
     UNH 344.039886 3.751338 345.208284 341.839661 322.961703 38.811673 48.408776        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.433315       SALUD
    EXAS  53.299999 0.721072  53.443950  53.136670  51.338025 40.662002 48.511459        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.189056       SALUD
    ENTG  91.919998 1.486430  93.398843  91.864748  87.431303 38.571650 44.105086        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.482292       SALUD
    KEYS 173.804993 1.568572 173.967113 173.488788 169.703458 43.602593 48.432063        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 75.426364  TECNOLOGÍA
    SNOW 224.005005 3.503496 224.555694 223.621787 219.236281 57.040678 49.186303        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.833178  TECNOLOGÍA
    FLEX  57.355000 0.881678  57.368367  57.214473  55.224048 57.824148 49.173107        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.487872  TECNOLOGÍA
    ONTO 128.309998 2.307721 129.614964 124.601611 114.669901 33.990756 49.880337        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.096221  TECNOLOGÍA
2025-09-30 21:03:44,412 INFO === RUN PIPELINE START 2025-09-30T19:03:44.412093 UTC ===
2025-09-30 21:03:44,412 INFO Stage=fetch attempt 1/2
2025-09-30 21:03:44,412 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-09-30 21:05:03,953 INFO Salida (1_fetch_indicators.py): returncode=0 (t=79.5s)
2025-09-30 21:05:03,953 WARNING stderr: 2025-09-30 21:03:45,241 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-09-30 21:03:45,255 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-09-30 21:03:52,574 ERROR 
32 Failed downloads:
2025-09-30 21:03:52,575 ERROR ['BAS', 'CBK', 'ANTM', 'CERN', 'ADS', 'ALFAA', 'AIXA', 'CHK', 'BBSE3', 'BHIA3', 'CPFE3', 'BP.LS', 'AYDEN', 'BC8', 'CNC.MI', 'AGUA', 'ALO', 'CAP', 'BAYN', 'CMIN3', 'AMNB']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-09-30 21:03:52,575 ERROR ['COL', 'AF', 'ANA', 'BMW', 'CEZ', 'CIE', 'CABK', 'ACS', 'BNP', 'AYV']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-09-30 21:03:52,575 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759259112. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-09-30 21:03:53,919 ERROR 
1 Failed download:
2025-09-30 21:03:53,919 ERROR ['ACS']: YFPricesMissingError('po
2025-09-30 21:05:03,953 INFO Stage fetch completado correctamente.
2025-09-30 21:05:03,954 INFO Stage=score attempt 1/2
2025-09-30 21:05:03,954 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-09-30 21:05:04,527 INFO Salida (2_score_select.py): returncode=0 (t=0.6s)
2025-09-30 21:05:04,527 WARNING stderr: 2025-09-30 21:05:04,421 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-09-30 21:05:04,429 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-09-30 21:05:04,438 INFO Hard filters applied: passed=25 rejected=1073 (total=1098)
2025-09-30 21:05:04,445 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-09-30 21:05:04,452 INFO Scoring computed. Score stats: min=27.43 median=35.82 max=75.65
2025-09-30 21:05:04,454 INFO Selected top 4 per sector. Selected rows=18
2025-09-30 21:05:04,461 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-09-30 21:05:04,463 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-09-30 21:05:04,463 INFO SUMMARY: total_indicators=1098 passed=25 selected=18 rejected=1073
2025-09-30 21:05:04,464 INFO Sector=COMMODITIES -> LI, STRL, GATX, MOS
2025-09-30 21:05:04,464 INFO Sector=ENERGIA -> OKLO, MPC, PSX, MUR
2025-09-30 21:05:04,464 INFO Sector=FINANCIERO -> BK, FDX, CFG, QS
2025-09-30 21:05:04,464 INFO Sector=SALUD -> UNH, HLI
2025-09-30 21:05:04,465 INFO Sector=TECNOLOGÍA -> KEYS, PANW, WIX, UBER
2025-09-30 21:05:04,527 INFO Stage score completado correctamente.
2025-09-30 21:05:04,527 INFO Stage=export attempt 1/2
2025-09-30 21:05:04,528 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-09-30 21:05:11,510 INFO Salida (3_export_sheets.py): returncode=0 (t=7.0s)
2025-09-30 21:05:11,510 WARNING stderr: 2025-09-30 21:05:05,326 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['COMMODITIES']
2025-09-30 21:05:05,327 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-09-30 21:05:05,331 INFO export_sheets: Usando columna de sector: Sector
2025-09-30 21:05:05,332 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-09-30 21:05:07,143 INFO export_sheets: Spreadsheet abierto: Trades
2025-09-30 21:05:07,143 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-09-30 21:05:10,662 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A6:H9 (cols=8) filas=4 (tickers: LI, STRL, GATX, MOS)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-09-30 21:05:11,404 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-09-30 21:05:11,404 INFO export_sheets: Export finalizado.
2025-09-30 21:05:11,510 INFO Stage export completado correctamente.
2025-09-30 21:05:11,510 INFO === RUN PIPELINE END 2025-09-30T19:05:11.510702 UTC (duración 87.1 s) ===
2025-09-30 21:05:11,919 INFO Resumen candidatos: total=18 (preview):
2025-09-30 21:05:11,924 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    LI  25.375000 0.563000  25.398657  25.328641  25.238368 36.288215 49.447790        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 69.451174 COMMODITIES
  STRL 337.700989 6.707458 342.143025 336.649222 309.912548 41.963725 45.089912        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 63.194861 COMMODITIES
  GATX 174.800003 1.352500 175.191902 173.488550 167.961925 66.689493 49.993442        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 37.712434 COMMODITIES
   MOS  34.549999 0.529879  34.796885  34.402622  34.078178 22.131496 47.653603        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.880768 COMMODITIES
  OKLO 112.158897 5.409864 115.938327 111.417458  92.732912 42.273393 44.549030        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.802275     ENERGIA
   MPC 192.399994 2.483559 194.326214 189.975123 181.957724 48.594717 48.277161        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.985184     ENERGIA
   PSX 135.029999 1.791836 136.393538 134.582185 131.224618 61.315572 47.105569        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.399729     ENERGIA
   MUR  28.280001 0.590000  28.770738  27.946345  26.289123 24.782428 46.594447        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.722956     ENERGIA
    BK 108.709999 0.887323 109.032349 108.057788 105.174167 44.696755 49.438965        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.206783  FINANCIERO
   FDX 234.225006 2.608915 235.007220 232.769061 230.725065 65.300126 49.729335        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.699497  FINANCIERO
   CFG  52.724998 0.577729  53.013839  52.715897  51.341223 51.270088 47.167693        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.678624  FINANCIERO
    QS  12.115000 0.571229  12.411809  11.798925  10.345132 58.881803 46.480083        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.628893  FINANCIERO
   UNH 344.700012 3.326375 344.961473 342.013873 323.517692 46.341465 49.929323        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 63.566048       SALUD
   HLI 205.804993 1.734508 205.965262 205.235087 200.587347 39.418471 49.117309        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.060575       SALUD
  KEYS 173.755005 1.299286 173.863603 173.490516 169.803549 39.255766 48.504127        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 75.650301  TECNOLOGÍA
  PANW 202.990005 1.818697 203.374157 202.105149 196.265522 60.474103 49.050120        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.731716  TECNOLOGÍA
   WIX 174.759995 3.213036 176.760254 174.632946 161.124805 47.845146 45.313663        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 37.968009  TECNOLOGÍA
  UBER  97.785004 1.025872  98.168882  97.341559  95.401071 58.001422 48.730492        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.507170  TECNOLOGÍA
2025-10-01 10:00:14,160 INFO === RUN PIPELINE START 2025-10-01T08:00:14.160224 UTC ===
2025-10-01 10:00:14,160 INFO Stage=fetch attempt 1/2
2025-10-01 10:00:14,161 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 10:01:32,017 INFO Salida (1_fetch_indicators.py): returncode=0 (t=77.9s)
2025-10-01 10:01:32,017 WARNING stderr: 2025-10-01 10:00:15,059 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-10-01 10:00:15,070 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-10-01 10:00:16,247 ERROR HTTP Error 404: 
2025-10-01 10:00:16,249 ERROR HTTP Error 404: 
2025-10-01 10:00:22,406 ERROR 
32 Failed downloads:
2025-10-01 10:00:22,406 ERROR ['CEZ', 'BNP', 'ANA', 'CABK', 'BMW', 'ACS', 'COL', 'AYV', 'CIE', 'AF']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-10-01 10:00:22,407 ERROR ['BAYN', 'AGUA', 'CHK', 'BBSE3', 'CMIN3', 'BHIA3', 'CERN', 'ANTM', 'ADS', 'CAP', 'CNC.MI', 'BC8', 'AMNB', 'BAS', 'BP.LS', 'AYDEN', 'ALO', 'CPFE3', 'AIXA', 'CBK', 'ALFAA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-10-01 10:00:22,407 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759305703. The requested range must be within the last 60 days.")')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 10:00:23
2025-10-01 10:01:32,018 INFO Stage fetch completado correctamente.
2025-10-01 10:01:32,019 INFO Stage=score attempt 1/2
2025-10-01 10:01:32,019 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 10:01:32,544 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-01 10:01:32,544 WARNING stderr: 2025-10-01 10:01:32,450 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-01 10:01:32,457 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-10-01 10:01:32,466 INFO Hard filters applied: passed=23 rejected=1075 (total=1098)
2025-10-01 10:01:32,472 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 10:01:32,479 INFO Scoring computed. Score stats: min=23.30 median=34.08 max=54.82
2025-10-01 10:01:32,481 INFO Selected top 4 per sector. Selected rows=18
2025-10-01 10:01:32,489 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-10-01 10:01:32,491 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 10:01:32,491 INFO SUMMARY: total_indicators=1098 passed=23 selected=18 rejected=1075
2025-10-01 10:01:32,492 INFO Sector=COMMODITIES -> LI, RHM.DE, STRL, GATX
2025-10-01 10:01:32,492 INFO Sector=ENERGIA -> OKLO, MUR, MPC
2025-10-01 10:01:32,492 INFO Sector=FINANCIERO -> GS, WFC, JXN, BPOP
2025-10-01 10:01:32,492 INFO Sector=SALUD -> ENTG, UTHR, HLI
2025-10-01 10:01:32,493 INFO Sector=TECNOLOGÍA -> UBER, DOCS, BILL, WDAY
2025-10-01 10:01:32,544 INFO Stage score completado correctamente.
2025-10-01 10:01:32,544 INFO Stage=export attempt 1/2
2025-10-01 10:01:32,544 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 10:01:53,709 INFO Salida (3_export_sheets.py): returncode=0 (t=21.2s)
2025-10-01 10:01:53,709 WARNING stderr: 2025-10-01 10:01:33,775 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 10:01:33,776 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 10:01:33,779 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 10:01:33,780 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 10:01:35,541 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 10:01:35,541 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 10:01:39,136 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H9 (cols=8) filas=3 (tickers: ENTG, UTHR, HLI)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:01:39,893 INFO export_sheets: Hoja 'SALUD': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 10:01:39,893 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 10:01:42,074 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 10:01:43,507 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H8 (cols=8) filas=2 (tickers: MUR, MPC)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:01:44,262 INFO export_sheets: Hoja 'ENERGÍA': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-01 10:01:44,262 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 10:01:46,309 INFO export_sheets: Ticker STRL omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 10:01:47,717 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A7:H9 (cols=8) filas=3 (tickers: LI, RHM.DE, GATX)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:01:48,440 INFO export_sheets: Hoja 'COMMODITIES': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 10:01:48,440 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 10:01:50,609 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H10 (cols=8) filas=4 (tickers: UBER, DOCS, BILL, WDAY)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:01:50,863 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2025-10-01 10:01:50,864 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 10:01:52,938 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A8:H11 (cols=8) filas=4 (tickers: GS, WFC, JXN, BPOP)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_up
2025-10-01 10:01:53,710 INFO Stage export completado correctamente.
2025-10-01 10:01:53,710 INFO === RUN PIPELINE END 2025-10-01T08:01:53.710684 UTC (duración 99.6 s) ===
2025-10-01 10:01:54,064 INFO Resumen candidatos: total=18 (preview):
2025-10-01 10:01:54,070 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    LI   25.334999  0.564429   25.393657   25.327072   25.237838 43.150416 49.004266        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.790150 COMMODITIES
RHM.DE 1944.000000 22.357143 1968.441564 1941.161417 1852.491194 48.266527 44.144243        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.409974 COMMODITIES
  STRL  339.450012  6.867031  342.361653  336.717811  309.935714 48.899900 46.809493        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 37.839091 COMMODITIES
  GATX  174.759995  1.374643  175.186901  173.486981  167.961396 73.794951 49.807459        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.740437 COMMODITIES
  OKLO  111.580002  5.429857  115.865965  111.394756   92.725245 41.206393 43.963118        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.007137     ENERGIA
   MUR   28.420000  0.610000   28.788238   27.951836   26.290977 35.840691 48.184993        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.757501     ENERGIA
   MPC  192.729996  2.556773  194.367464  189.988064  181.962095 55.429017 49.141323        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.791493     ENERGIA
    GS  796.130005  8.215563  798.550216  792.790884  766.267050 41.157144 48.192838        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.815860  FINANCIERO
   WFC   83.830002  0.786871   84.126823   83.496353   81.966596 37.040795 48.411820        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.093400  FINANCIERO
   JXN  101.300003  1.222513  101.898746  100.672131   97.385018 47.457429 48.325282        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.401817  FINANCIERO
  BPOP  126.870003  1.174101  127.009018  126.469306  123.530747 64.407145 49.607067        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.558360  FINANCIERO
  ENTG   92.440002  1.357309   92.992142   91.846392   87.541404 45.702151 47.598460        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 47.645834       SALUD
  UTHR  419.260010  7.579112  424.076700  415.251591  376.961422 65.153336 46.437096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.525503       SALUD
   HLI  205.369995  1.773794  205.910888  205.218028  200.581585 48.966015 47.522297        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.076564       SALUD
  UBER   97.940002  1.048729   98.188257   97.347637   95.403124 60.519360 49.682617        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.230060  TECNOLOGÍA
  DOCS   73.139999  1.104092   73.954110   72.959711   69.304310 54.463442 46.118906        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.699900  TECNOLOGÍA
  BILL   52.959999  0.777858   53.487420   52.567052   49.323061 69.315125 47.324731        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.511717  TECNOLOGÍA
  WDAY  240.720001  2.751307  244.042697  238.793579  233.403883 75.815577 46.392108        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.397119  TECNOLOGÍA
2025-10-01 10:07:29,427 INFO === RUN PIPELINE START 2025-10-01T08:07:29.427527 UTC ===
2025-10-01 10:07:29,427 INFO Stage=fetch attempt 1/2
2025-10-01 10:07:29,427 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 10:08:13,872 INFO Salida (1_fetch_indicators.py): returncode=0 (t=44.4s)
2025-10-01 10:08:13,872 WARNING stderr: 2025-10-01 10:07:30,104 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Desktop\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg
2025-10-01 10:08:13,872 INFO Stage fetch completado correctamente.
2025-10-01 10:08:13,873 INFO Stage=score attempt 1/2
2025-10-01 10:08:13,873 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 10:08:14,409 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-01 10:08:14,409 WARNING stderr: 2025-10-01 10:08:14,302 WARNING Could not read parquet (intermediate/indicators.parquet): Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-01 10:08:14,309 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-10-01 10:08:14,318 INFO Hard filters applied: passed=23 rejected=1075 (total=1098)
2025-10-01 10:08:14,324 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 10:08:14,330 INFO Scoring computed. Score stats: min=23.25 median=33.79 max=58.06
2025-10-01 10:08:14,332 INFO Selected top 4 per sector. Selected rows=18
2025-10-01 10:08:14,338 INFO Wrote selected candidates (csv) to intermediate/candidates.csv
2025-10-01 10:08:14,340 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 10:08:14,341 INFO SUMMARY: total_indicators=1098 passed=23 selected=18 rejected=1075
2025-10-01 10:08:14,341 INFO Sector=COMMODITIES -> LI, RHM.DE, STRL, MOS
2025-10-01 10:08:14,341 INFO Sector=ENERGIA -> OKLO, MUR, MPC
2025-10-01 10:08:14,341 INFO Sector=FINANCIERO -> GS, WFC, JXN, BPOP
2025-10-01 10:08:14,341 INFO Sector=SALUD -> ENTG, UTHR, HLI
2025-10-01 10:08:14,342 INFO Sector=TECNOLOGÍA -> UBER, DOCS, BILL, WDAY
2025-10-01 10:08:14,409 INFO Stage score completado correctamente.
2025-10-01 10:08:14,409 INFO Stage=export attempt 1/2
2025-10-01 10:08:14,409 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 10:08:33,036 INFO Salida (3_export_sheets.py): returncode=0 (t=18.6s)
2025-10-01 10:08:33,036 WARNING stderr: 2025-10-01 10:08:15,070 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 10:08:15,070 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 10:08:15,074 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 10:08:15,074 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 10:08:16,674 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 10:08:16,674 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 10:08:18,737 INFO export_sheets: Ticker ENTG omitido en 'SALUD' por duplicado reciente.
2025-10-01 10:08:18,737 INFO export_sheets: Ticker UTHR omitido en 'SALUD' por duplicado reciente.
2025-10-01 10:08:18,738 INFO export_sheets: Ticker HLI omitido en 'SALUD' por duplicado reciente.
2025-10-01 10:08:18,738 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 10:08:18,738 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 10:08:20,787 INFO export_sheets: Ticker MUR omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 10:08:20,787 INFO export_sheets: Ticker MPC omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 10:08:22,203 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A9:H9 (cols=8) filas=1 (tickers: OKLO)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:08:22,885 INFO export_sheets: Hoja 'ENERGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 10:08:22,885 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 10:08:24,974 INFO export_sheets: Ticker RHM.DE omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 10:08:24,974 INFO export_sheets: Ticker STRL omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 10:08:26,454 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A8:H9 (cols=8) filas=2 (tickers: LI, MOS)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:08:27,140 INFO export_sheets: Hoja 'COMMODITIES': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-01 10:08:27,140 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 10:08:29,193 INFO export_sheets: Ticker UBER omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 10:08:29,193 INFO export_sheets: Ticker DOCS omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 10:08:30,612 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A8:H9 (cols=8) filas=2 (tickers: BILL, WDAY)
A:\pilim\Desktop\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 10:08:30,867 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-01 10:08:30,867 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 10:08:32,939 INFO export_sheets: Ticker GS omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 10:08:32,939 INFO export_sheets: Ticker WFC omitido en 'FINANCI
2025-10-01 10:08:33,036 INFO Stage export completado correctamente.
2025-10-01 10:08:33,036 INFO === RUN PIPELINE END 2025-10-01T08:08:33.036935 UTC (duración 63.6 s) ===
2025-10-01 10:08:33,387 INFO Resumen candidatos: total=18 (preview):
2025-10-01 10:08:33,393 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    LI   25.334999  0.564429   25.393657   25.327072   25.237838 43.150416 49.004266        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.783544 COMMODITIES
RHM.DE 1944.000000 22.357143 1968.441564 1941.161417 1852.491194 48.266527 44.144243        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.409974 COMMODITIES
  STRL  339.450012  6.867031  342.361653  336.717811  309.935714 48.899900 46.809493        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.388362 COMMODITIES
   MOS   34.665001  0.535600   34.811260   34.407132   34.079701 21.070170 49.301611        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.548600 COMMODITIES
  OKLO  111.580002  5.429857  115.865965  111.394756   92.725245 41.206393 43.963118        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.885710     ENERGIA
   MUR   28.420000  0.610000   28.788238   27.951836   26.290977 35.840691 48.184993        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.740453     ENERGIA
   MPC  192.729996  2.556773  194.367464  189.988064  181.962095 55.429017 49.141323        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.328379     ENERGIA
    GS  796.130005  8.215563  798.550216  792.790884  766.267050 41.157144 48.192838        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.056140  FINANCIERO
   WFC   83.830002  0.786871   84.126823   83.496353   81.966596 37.040795 48.411820        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.035826  FINANCIERO
   JXN  101.300003  1.222513  101.898746  100.672131   97.385018 47.457429 48.325282        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.244424  FINANCIERO
  BPOP  126.870003  1.174101  127.009018  126.469306  123.530747 64.407145 49.607067        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.412059  FINANCIERO
  ENTG   92.440002  1.357309   92.992142   91.846392   87.541404 45.702151 47.598460        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.457554       SALUD
  UTHR  419.260010  7.579112  424.076700  415.251591  376.961422 65.153336 46.437096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.911613       SALUD
   HLI  205.369995  1.773794  205.910888  205.218028  200.581585 48.966015 47.522297        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.792855       SALUD
  UBER   97.940002  1.048729   98.188257   97.347637   95.403124 60.519360 49.682617        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.112486  TECNOLOGÍA
  DOCS   73.139999  1.104092   73.954110   72.959711   69.304310 54.463442 46.118906        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.569640  TECNOLOGÍA
  BILL   52.959999  0.777858   53.487420   52.567052   49.323061 69.315125 47.324731        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.456209  TECNOLOGÍA
  WDAY  240.720001  2.751307  244.042697  238.793579  233.403883 75.815577 46.392108        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.889431  TECNOLOGÍA
2025-10-01 15:22:34,437 INFO === RUN PIPELINE START 2025-10-01T13:22:34.437406 UTC ===
2025-10-01 15:22:34,437 INFO Stage=fetch attempt 1/2
2025-10-01 15:22:34,438 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 15:24:19,049 INFO Salida (1_fetch_indicators.py): returncode=0 (t=104.6s)
2025-10-01 15:24:19,049 WARNING stderr: 2025-10-01 15:22:37,732 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 15:24:19,050 INFO Stage fetch completado correctamente.
2025-10-01 15:24:19,052 INFO Stage=score attempt 1/2
2025-10-01 15:24:19,053 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 15:24:21,452 INFO Salida (2_score_select.py): returncode=0 (t=2.4s)
2025-10-01 15:24:21,452 WARNING stderr: 2025-10-01 15:24:21,267 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 15:24:21,290 INFO Hard filters applied: passed=23 rejected=1075 (total=1098)
2025-10-01 15:24:21,299 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 15:24:21,315 INFO Scoring computed. Score stats: min=23.25 median=33.79 max=58.06
2025-10-01 15:24:21,321 INFO Selected top 2 per sector. Selected rows=10
2025-10-01 15:24:21,338 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 15:24:21,341 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 15:24:21,341 INFO SUMMARY: total_indicators=1098 passed=23 selected=10 rejected=1075
2025-10-01 15:24:21,342 INFO Sector=COMMODITIES -> LI, RHM.DE
2025-10-01 15:24:21,343 INFO Sector=ENERGIA -> OKLO, MUR
2025-10-01 15:24:21,343 INFO Sector=FINANCIERO -> GS, WFC
2025-10-01 15:24:21,343 INFO Sector=SALUD -> ENTG, UTHR
2025-10-01 15:24:21,343 INFO Sector=TECNOLOGÍA -> UBER, DOCS
2025-10-01 15:24:21,452 INFO Stage score completado correctamente.
2025-10-01 15:24:21,452 INFO Stage=export attempt 1/2
2025-10-01 15:24:21,453 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 15:24:34,075 INFO Salida (3_export_sheets.py): returncode=0 (t=12.6s)
2025-10-01 15:24:34,075 WARNING stderr: 2025-10-01 15:24:24,661 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA']
2025-10-01 15:24:24,663 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 15:24:24,690 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 15:24:24,691 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 15:24:28,358 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 15:24:28,358 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 15:24:31,122 INFO export_sheets: Ticker ENTG omitido en 'SALUD' por duplicado reciente.
2025-10-01 15:24:31,123 INFO export_sheets: Ticker UTHR omitido en 'SALUD' por duplicado reciente.
2025-10-01 15:24:31,123 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 15:24:31,123 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 15:24:33,784 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 15:24:33,784 INFO export_sheets: Ticker MUR omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 15:24:33,784 INFO export_sheets: No hay filas nuevas para añadir en 'ENERGÍA' (tras filtrar duplicados).
2025-10-01 15:24:33,785 INFO export_sheets: Export finalizado.
2025-10-01 15:24:34,075 INFO Stage export completado correctamente.
2025-10-01 15:24:34,076 INFO === RUN PIPELINE END 2025-10-01T13:24:34.076209 UTC (duración 119.6 s) ===
2025-10-01 15:24:35,552 INFO Resumen candidatos: total=10 (preview):
2025-10-01 15:24:35,570 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    LI   25.334999  0.564429   25.393657   25.327072   25.237838 43.150416 49.004266        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.783544 COMMODITIES
RHM.DE 1944.000000 22.357143 1968.441564 1941.161417 1852.491194 48.266527 44.144243        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.409974 COMMODITIES
  OKLO  111.580002  5.429857  115.865965  111.394756   92.725245 41.206393 43.963118        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.885710     ENERGIA
   MUR   28.420000  0.610000   28.788238   27.951836   26.290977 35.840691 48.184993        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.740453     ENERGIA
    GS  796.130005  8.215563  798.550216  792.790884  766.267050 41.157144 48.192838        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.056140  FINANCIERO
   WFC   83.830002  0.786871   84.126823   83.496353   81.966596 37.040795 48.411820        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.035826  FINANCIERO
  ENTG   92.440002  1.357309   92.992142   91.846392   87.541404 45.702151 47.598460        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.457554       SALUD
  UTHR  419.260010  7.579112  424.076700  415.251591  376.961422 65.153336 46.437096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.911613       SALUD
  UBER   97.940002  1.048729   98.188257   97.347637   95.403124 60.519360 49.682617        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.112486  TECNOLOGÍA
  DOCS   73.139999  1.104092   73.954110   72.959711   69.304310 54.463442 46.118906        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.569640  TECNOLOGÍA
2025-10-01 15:36:46,284 INFO === RUN PIPELINE START 2025-10-01T13:36:46.283980 UTC ===
2025-10-01 15:36:46,284 INFO Stage=fetch attempt 1/2
2025-10-01 15:36:46,284 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 15:40:52,960 INFO Salida (1_fetch_indicators.py): returncode=0 (t=246.7s)
2025-10-01 15:40:52,961 WARNING stderr: 2025-10-01 15:36:48,405 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-10-01 15:36:48,442 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-10-01 15:36:48,465 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-10-01 15:36:54,759 ERROR HTTP Error 404: 
2025-10-01 15:37:17,945 ERROR 
32 Failed downloads:
2025-10-01 15:37:17,946 ERROR ['ANA', 'ACS', 'CEZ', 'CIE', 'AF', 'CABK', 'BNP', 'AYV', 'COL', 'BMW']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-10-01 15:37:17,946 ERROR ['CBK', 'AGUA', 'AMNB', 'ANTM', 'CHK', 'AYDEN', 'BBSE3', 'ALFAA', 'BAYN', 'BP.LS', 'BHIA3', 'CMIN3', 'AIXA', 'ADS', 'BAS', 'CERN', 'CNC.MI', 'CAP', 'CPFE3', 'ALO', 'BC8']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-10-01 15:37:17,946 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759325821. The requested range must be within the last 60 days.")')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financie
2025-10-01 15:40:52,961 INFO Stage fetch completado correctamente.
2025-10-01 15:40:52,969 INFO Stage=score attempt 1/2
2025-10-01 15:40:52,970 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 15:40:54,567 INFO Salida (2_score_select.py): returncode=0 (t=1.6s)
2025-10-01 15:40:54,568 WARNING stderr: 2025-10-01 15:40:54,384 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 15:40:54,407 INFO Hard filters applied: passed=17 rejected=1081 (total=1098)
2025-10-01 15:40:54,421 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 15:40:54,436 INFO Scoring computed. Score stats: min=23.87 median=33.90 max=58.46
2025-10-01 15:40:54,441 INFO Selected top 3 per sector. Selected rows=13
2025-10-01 15:40:54,458 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 15:40:54,461 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 15:40:54,461 INFO SUMMARY: total_indicators=1098 passed=17 selected=13 rejected=1081
2025-10-01 15:40:54,462 INFO Sector=COMMODITIES -> GATX, AIR, GM
2025-10-01 15:40:54,462 INFO Sector=ENERGIA -> GE, MPC, PSX
2025-10-01 15:40:54,463 INFO Sector=FINANCIERO -> LITE, MLI, PSMT
2025-10-01 15:40:54,463 INFO Sector=SALUD -> ENTG
2025-10-01 15:40:54,463 INFO Sector=TECNOLOGÍA -> ONTO, WDAY, GDS
2025-10-01 15:40:54,568 INFO Stage score completado correctamente.
2025-10-01 15:40:54,568 INFO Stage=export attempt 1/2
2025-10-01 15:40:54,569 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 15:41:22,404 INFO Salida (3_export_sheets.py): returncode=0 (t=27.8s)
2025-10-01 15:41:22,404 WARNING stderr: 2025-10-01 15:40:56,556 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 15:40:56,558 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 15:40:56,583 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 15:40:56,591 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 15:41:00,129 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 15:41:00,129 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 15:41:02,460 INFO export_sheets: Ticker ENTG omitido en 'SALUD' por duplicado reciente.
2025-10-01 15:41:02,461 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 15:41:02,461 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 15:41:06,701 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H9 (cols=8) filas=3 (tickers: GE, MPC, PSX)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:41:07,740 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 15:41:07,740 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 15:41:12,379 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A8:H10 (cols=8) filas=3 (tickers: GATX, AIR, GM)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:41:13,384 INFO export_sheets: Hoja 'COMMODITIES': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 15:41:13,384 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 15:41:17,490 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H9 (cols=8) filas=3 (tickers: ONTO, WDAY, GDS)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:41:18,291 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 15:41:18,291 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 15:41:21,869 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A12:H14 (cols=8) filas=3 (tickers: LITE, MLI, PSMT)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:41:22,189 INFO export_sheets: Hoja 'FINANCIERO': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 15:41:22,189 INFO export_sheets: Export finalizado.
2025-10-01 15:41:22,405 INFO Stage export completado correctamente.
2025-10-01 15:41:22,406 INFO === RUN PIPELINE END 2025-10-01T13:41:22.406716 UTC (duración 276.1 s) ===
2025-10-01 15:41:23,613 INFO Resumen candidatos: total=13 (preview):
2025-10-01 15:41:23,625 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  GATX 174.759995 1.374643 175.186901 173.487025 167.985619 73.794951 49.807457        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.595747 COMMODITIES
   AIR  83.644997 1.970714  85.915072  81.238728  77.710857 85.397424 49.323568        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.633744 COMMODITIES
    GM  60.240002 0.691644  60.727888  59.788451  57.982154 57.161646 48.788096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.322053 COMMODITIES
    GE 296.570007 3.272993 297.168172 294.342825 283.554613 52.941341 49.445663        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.394159     ENERGIA
   MPC 191.854996 2.477486 194.053405 190.061346 182.134100 52.012624 46.903655        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.017036     ENERGIA
   PSX 135.404999 1.706842 136.377158 134.651504 131.368697 53.063117 48.419493        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.376533     ENERGIA
  LITE 161.279999 2.687134 161.400641 160.200030 144.650460 51.882678 49.494875        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.550997  FINANCIERO
   MLI 100.400002 0.869749 100.681308  99.841258  96.314367 73.580339 49.326189        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.899939  FINANCIERO
  PSMT 119.029999 1.499150 120.139291 117.581269 113.582920 88.921437 49.348962        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.165768  FINANCIERO
  ENTG  92.419998 1.352309  92.920624  91.869082  87.721400 49.150373 47.521475        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.791646       SALUD
  ONTO 127.700104 2.174085 129.029980 124.965490 115.341411 37.295397 48.550095        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.456790  TECNOLOGÍA
  WDAY 241.029999 2.785592 243.666109 238.881343 233.534055 71.551343 47.199686        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.992797  TECNOLOGÍA
   GDS  39.080002 1.091657  39.815258  39.006866  36.772112 33.154633 46.540388        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.726234  TECNOLOGÍA
2025-10-01 15:43:58,280 INFO === RUN PIPELINE START 2025-10-01T13:43:58.280451 UTC ===
2025-10-01 15:43:58,281 INFO Stage=fetch attempt 1/2
2025-10-01 15:43:58,281 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 15:45:49,222 INFO Salida (1_fetch_indicators.py): returncode=0 (t=110.9s)
2025-10-01 15:45:49,223 WARNING stderr: 2025-10-01 15:44:00,309 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 15:45:49,224 INFO Stage fetch completado correctamente.
2025-10-01 15:45:49,226 INFO Stage=score attempt 1/2
2025-10-01 15:45:49,227 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 15:45:51,122 INFO Salida (2_score_select.py): returncode=0 (t=1.9s)
2025-10-01 15:45:51,123 WARNING stderr: 2025-10-01 15:45:50,909 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 15:45:50,935 INFO Hard filters applied: passed=17 rejected=1081 (total=1098)
2025-10-01 15:45:50,945 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 15:45:50,963 INFO Scoring computed. Score stats: min=23.87 median=33.90 max=58.46
2025-10-01 15:45:50,967 INFO Selected top 3 per sector. Selected rows=13
2025-10-01 15:45:50,986 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 15:45:50,989 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 15:45:50,989 INFO SUMMARY: total_indicators=1098 passed=17 selected=13 rejected=1081
2025-10-01 15:45:50,991 INFO Sector=COMMODITIES -> GATX, AIR, GM
2025-10-01 15:45:50,991 INFO Sector=ENERGIA -> GE, MPC, PSX
2025-10-01 15:45:50,991 INFO Sector=FINANCIERO -> LITE, MLI, PSMT
2025-10-01 15:45:50,992 INFO Sector=SALUD -> ENTG
2025-10-01 15:45:50,992 INFO Sector=TECNOLOGÍA -> ONTO, WDAY, GDS
2025-10-01 15:45:51,123 INFO Stage score completado correctamente.
2025-10-01 15:45:51,123 INFO Stage=export attempt 1/2
2025-10-01 15:45:51,124 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 15:46:00,038 INFO Salida (3_export_sheets.py): returncode=0 (t=8.9s)
2025-10-01 15:46:00,038 WARNING stderr: 2025-10-01 15:45:53,148 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['FINANCIERO']
2025-10-01 15:45:53,150 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 15:45:53,175 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 15:45:53,177 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 15:45:56,006 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 15:45:56,006 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 15:45:58,966 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A5:H7 (cols=8) filas=3 (tickers: LITE, MLI, PSMT)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:45:59,809 INFO export_sheets: Hoja 'FINANCIERO': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 15:45:59,809 INFO export_sheets: Export finalizado.
2025-10-01 15:46:00,039 INFO Stage export completado correctamente.
2025-10-01 15:46:00,039 INFO === RUN PIPELINE END 2025-10-01T13:46:00.039426 UTC (duración 121.8 s) ===
2025-10-01 15:46:01,242 INFO Resumen candidatos: total=13 (preview):
2025-10-01 15:46:01,254 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  GATX 174.759995 1.374643 175.186901 173.487025 167.985619 73.794951 49.807457        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.595747 COMMODITIES
   AIR  83.644997 1.970714  85.915072  81.238728  77.710857 85.397424 49.323568        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.633744 COMMODITIES
    GM  60.240002 0.691644  60.727888  59.788451  57.982154 57.161646 48.788096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.322053 COMMODITIES
    GE 296.570007 3.272993 297.168172 294.342825 283.554613 52.941341 49.445663        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.394159     ENERGIA
   MPC 191.854996 2.477486 194.053405 190.061346 182.134100 52.012624 46.903655        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.017036     ENERGIA
   PSX 135.404999 1.706842 136.377158 134.651504 131.368697 53.063117 48.419493        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.376533     ENERGIA
  LITE 161.279999 2.687134 161.400641 160.200030 144.650460 51.882678 49.494875        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.550997  FINANCIERO
   MLI 100.400002 0.869749 100.681308  99.841258  96.314367 73.580339 49.326189        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.899939  FINANCIERO
  PSMT 119.029999 1.499150 120.139291 117.581269 113.582920 88.921437 49.348962        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.165768  FINANCIERO
  ENTG  92.419998 1.352309  92.920624  91.869082  87.721400 49.150373 47.521475        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.791646       SALUD
  ONTO 127.700104 2.174085 129.029980 124.965490 115.341411 37.295397 48.550095        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.456790  TECNOLOGÍA
  WDAY 241.029999 2.785592 243.666109 238.881343 233.534055 71.551343 47.199686        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.992797  TECNOLOGÍA
   GDS  39.080002 1.091657  39.815258  39.006866  36.772112 33.154633 46.540388        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.726234  TECNOLOGÍA
2025-10-01 15:48:07,519 INFO === RUN PIPELINE START 2025-10-01T13:48:07.518979 UTC ===
2025-10-01 15:48:07,519 INFO Stage=fetch attempt 1/2
2025-10-01 15:48:07,519 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 15:49:56,183 INFO Salida (1_fetch_indicators.py): returncode=0 (t=108.7s)
2025-10-01 15:49:56,184 WARNING stderr: 2025-10-01 15:48:09,652 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 15:49:56,184 INFO Stage fetch completado correctamente.
2025-10-01 15:49:56,186 INFO Stage=score attempt 1/2
2025-10-01 15:49:56,186 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 15:49:57,746 INFO Salida (2_score_select.py): returncode=0 (t=1.6s)
2025-10-01 15:49:57,746 WARNING stderr: 2025-10-01 15:49:57,567 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 15:49:57,589 INFO Hard filters applied: passed=17 rejected=1081 (total=1098)
2025-10-01 15:49:57,598 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 15:49:57,615 INFO Scoring computed. Score stats: min=23.87 median=33.90 max=58.46
2025-10-01 15:49:57,619 INFO Selected top 8 per sector. Selected rows=17
2025-10-01 15:49:57,637 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 15:49:57,640 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 15:49:57,640 INFO SUMMARY: total_indicators=1098 passed=17 selected=17 rejected=1081
2025-10-01 15:49:57,641 INFO Sector=COMMODITIES -> GATX, AIR, GM
2025-10-01 15:49:57,642 INFO Sector=ENERGIA -> GE, MPC, PSX
2025-10-01 15:49:57,642 INFO Sector=FINANCIERO -> LITE, MLI, PSMT, RENT3.SA, STT, BHF
2025-10-01 15:49:57,642 INFO Sector=SALUD -> ENTG
2025-10-01 15:49:57,643 INFO Sector=TECNOLOGÍA -> ONTO, WDAY, GDS, SW.PA
2025-10-01 15:49:57,746 INFO Stage score completado correctamente.
2025-10-01 15:49:57,747 INFO Stage=export attempt 1/2
2025-10-01 15:49:57,747 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 15:50:09,882 INFO Salida (3_export_sheets.py): returncode=0 (t=12.1s)
2025-10-01 15:50:09,882 WARNING stderr: 2025-10-01 15:49:59,704 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['FINANCIERO']
2025-10-01 15:49:59,706 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 15:49:59,731 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 15:49:59,733 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 15:50:03,203 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 15:50:03,203 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 15:50:06,993 INFO export_sheets: Ticker LITE omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 15:50:06,993 INFO export_sheets: Ticker MLI omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 15:50:06,994 INFO export_sheets: Ticker PSMT omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 15:50:09,212 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A8:H10 (cols=8) filas=3 (tickers: RENT3.SA, STT, BHF)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:50:09,620 INFO export_sheets: Hoja 'FINANCIERO': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 15:50:09,621 INFO export_sheets: Export finalizado.
2025-10-01 15:50:09,883 INFO Stage export completado correctamente.
2025-10-01 15:50:09,883 INFO === RUN PIPELINE END 2025-10-01T13:50:09.883417 UTC (duración 122.4 s) ===
2025-10-01 15:50:11,043 INFO Resumen candidatos: total=17 (preview):
2025-10-01 15:50:11,055 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
    GATX 174.759995 1.374643 175.186901 173.487025 167.985619 73.794951 49.807457        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.595747 COMMODITIES
     AIR  83.644997 1.970714  85.915072  81.238728  77.710857 85.397424 49.323568        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.633744 COMMODITIES
      GM  60.240002 0.691644  60.727888  59.788451  57.982154 57.161646 48.788096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.322053 COMMODITIES
      GE 296.570007 3.272993 297.168172 294.342825 283.554613 52.941341 49.445663        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.394159     ENERGIA
     MPC 191.854996 2.477486 194.053405 190.061346 182.134100 52.012624 46.903655        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.017036     ENERGIA
     PSX 135.404999 1.706842 136.377158 134.651504 131.368697 53.063117 48.419493        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.376533     ENERGIA
    LITE 161.279999 2.687134 161.400641 160.200030 144.650460 51.882678 49.494875        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.550997  FINANCIERO
     MLI 100.400002 0.869749 100.681308  99.841258  96.314367 73.580339 49.326189        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.899939  FINANCIERO
    PSMT 119.029999 1.499150 120.139291 117.581269 113.582920 88.921437 49.348962        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.165768  FINANCIERO
RENT3.SA  39.779999 0.528572  39.953896  39.520939  37.898203 15.365052 47.966712        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.523360  FINANCIERO
     STT 114.230003 1.190972 115.331898 114.094112 112.901059 68.136386 46.942897        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.591219  FINANCIERO
     BHF  52.889999 0.738972  53.963661  52.442162  49.854709 65.342899 44.377233        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 23.869956  FINANCIERO
    ENTG  92.419998 1.352309  92.920624  91.869082  87.721400 49.150373 47.521475        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.791646       SALUD
    ONTO 127.700104 2.174085 129.029980 124.965490 115.341411 37.295397 48.550095        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.456790  TECNOLOGÍA
    WDAY 241.029999 2.785592 243.666109 238.881343 233.534055 71.551343 47.199686        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.992797  TECNOLOGÍA
     GDS  39.080002 1.091657  39.815258  39.006866  36.772112 33.154633 46.540388        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.726234  TECNOLOGÍA
   SW.PA  53.450001 0.546428  53.756829  53.432983  52.850264 27.456839 46.793409        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.765068  TECNOLOGÍA
2025-10-01 15:52:51,027 INFO === RUN PIPELINE START 2025-10-01T13:52:51.027244 UTC ===
2025-10-01 15:52:51,027 INFO Stage=fetch attempt 1/2
2025-10-01 15:52:51,028 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 15:56:26,468 INFO Salida (1_fetch_indicators.py): returncode=0 (t=215.4s)
2025-10-01 15:56:26,469 WARNING stderr: 2025-10-01 15:52:53,291 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-10-01 15:52:53,325 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:
2025-10-01 15:56:26,470 INFO Stage fetch completado correctamente.
2025-10-01 15:56:26,471 INFO Stage=score attempt 1/2
2025-10-01 15:56:26,471 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 15:56:28,060 INFO Salida (2_score_select.py): returncode=0 (t=1.6s)
2025-10-01 15:56:28,060 WARNING stderr: 2025-10-01 15:56:27,877 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 15:56:27,899 INFO Hard filters applied: passed=14 rejected=1084 (total=1098)
2025-10-01 15:56:27,908 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 15:56:27,924 INFO Scoring computed. Score stats: min=23.54 median=34.80 max=51.80
2025-10-01 15:56:27,928 INFO Selected top 8 per sector. Selected rows=14
2025-10-01 15:56:27,946 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 15:56:27,949 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 15:56:27,949 INFO SUMMARY: total_indicators=1098 passed=14 selected=14 rejected=1084
2025-10-01 15:56:27,950 INFO Sector=COMMODITIES -> ACM, GATX, AIR
2025-10-01 15:56:27,950 INFO Sector=ENERGIA -> MUR, PSX, MPC
2025-10-01 15:56:27,951 INFO Sector=FINANCIERO -> MLI, RENT3.SA, PSMT, BHF
2025-10-01 15:56:27,951 INFO Sector=SALUD -> AAP
2025-10-01 15:56:27,951 INFO Sector=TECNOLOGÍA -> WIX, IDCC, WDAY
2025-10-01 15:56:28,060 INFO Stage score completado correctamente.
2025-10-01 15:56:28,061 INFO Stage=export attempt 1/2
2025-10-01 15:56:28,061 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 15:56:38,475 INFO Salida (3_export_sheets.py): returncode=0 (t=10.4s)
2025-10-01 15:56:38,476 WARNING stderr: 2025-10-01 15:56:30,024 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD']
2025-10-01 15:56:30,025 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 15:56:30,051 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 15:56:30,052 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 15:56:33,310 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 15:56:33,310 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 15:56:37,437 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H7 (cols=8) filas=1 (tickers: AAP)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 15:56:38,186 INFO export_sheets: Hoja 'SALUD': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 15:56:38,186 INFO export_sheets: Export finalizado.
2025-10-01 15:56:38,476 INFO Stage export completado correctamente.
2025-10-01 15:56:38,476 INFO === RUN PIPELINE END 2025-10-01T13:56:38.476777 UTC (duración 227.4 s) ===
2025-10-01 15:56:39,766 INFO Resumen candidatos: total=14 (preview):
2025-10-01 15:56:39,781 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
     ACM 129.720001 0.985727 129.899334 129.298122 125.649966 70.973552 49.168939        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.300365 COMMODITIES
    GATX 174.490005 1.383571 175.099789 173.526358 168.071770 71.766860 48.496321        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 34.536747 COMMODITIES
     AIR  83.071098 2.035714  85.843335  81.216222  77.703255 77.787233 47.483632        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.280670 COMMODITIES
     MUR  28.512699 0.623214  28.753796  27.973899  26.362554 39.171532 49.262502        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.796401     ENERGIA
     PSX 135.539993 1.706842 136.394032 134.656798 131.370485 52.715608 48.860876        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.058437     ENERGIA
     MPC 191.279999 2.506772 193.981531 190.038797 182.126484 51.770719 45.540929        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.740401     ENERGIA
     MLI 100.169998 0.869749 100.652557  99.832238  96.311321 73.422890 47.660671        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.721298  FINANCIERO
RENT3.SA  39.669998 0.528572  39.940146  39.516625  37.896746 15.825329 46.308426        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.365719  FINANCIERO
    PSMT 118.665001 1.499150 120.093667 117.566955 113.578086 88.188076 47.519623        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.256761  FINANCIERO
     BHF  52.889999 0.738972  53.963661  52.442162  49.854709 65.342899 44.377233        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 23.542538  FINANCIERO
     AAP  60.900002 1.009462  61.202556  60.856862  60.032171 87.374630 49.101115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.242393       SALUD
     WIX 176.830002 3.676994 177.092723 174.830468 161.275254 65.822375 49.090061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.958132  TECNOLOGÍA
    IDCC 341.799988 4.365411 345.093737 335.800316 304.739168 76.243103 48.044333        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 43.237160  TECNOLOGÍA
    WDAY 240.990005 2.785592 243.661110 238.879775 233.533525 70.919054 47.096868        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.396001  TECNOLOGÍA
2025-10-01 15:57:41,114 INFO === RUN PIPELINE START 2025-10-01T13:57:41.114277 UTC ===
2025-10-01 15:57:41,114 INFO Stage=fetch attempt 1/2
2025-10-01 15:57:41,115 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 15:59:35,189 INFO Salida (1_fetch_indicators.py): returncode=0 (t=114.1s)
2025-10-01 15:59:35,189 WARNING stderr: 2025-10-01 15:57:43,448 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 15:59:35,190 INFO Stage fetch completado correctamente.
2025-10-01 15:59:35,191 INFO Stage=score attempt 1/2
2025-10-01 15:59:35,192 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 15:59:36,752 INFO Salida (2_score_select.py): returncode=0 (t=1.6s)
2025-10-01 15:59:36,752 WARNING stderr: 2025-10-01 15:59:36,577 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 15:59:36,598 INFO Hard filters applied: passed=14 rejected=1084 (total=1098)
2025-10-01 15:59:36,608 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 15:59:36,623 INFO Scoring computed. Score stats: min=22.97 median=31.68 max=61.55
2025-10-01 15:59:36,627 INFO Selected top 8 per sector. Selected rows=14
2025-10-01 15:59:36,646 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 15:59:36,648 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 15:59:36,648 INFO SUMMARY: total_indicators=1098 passed=14 selected=14 rejected=1084
2025-10-01 15:59:36,649 INFO Sector=COMMODITIES -> ACM, GATX, AIR
2025-10-01 15:59:36,650 INFO Sector=ENERGIA -> MUR, PSX, MPC
2025-10-01 15:59:36,650 INFO Sector=FINANCIERO -> RENT3.SA, MLI, PSMT, BHF
2025-10-01 15:59:36,650 INFO Sector=SALUD -> AAP
2025-10-01 15:59:36,651 INFO Sector=TECNOLOGÍA -> WIX, IDCC, WDAY
2025-10-01 15:59:36,752 INFO Stage score completado correctamente.
2025-10-01 15:59:36,753 INFO Stage=export attempt 1/2
2025-10-01 15:59:36,753 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 15:59:44,481 INFO Salida (3_export_sheets.py): returncode=0 (t=7.7s)
2025-10-01 15:59:44,482 WARNING stderr: 2025-10-01 15:59:38,803 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD']
2025-10-01 15:59:38,805 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 15:59:38,835 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 15:59:38,837 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 15:59:42,099 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 15:59:42,099 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 15:59:44,280 INFO export_sheets: Ticker AAP omitido en 'SALUD' por duplicado reciente.
2025-10-01 15:59:44,280 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 15:59:44,280 INFO export_sheets: Export finalizado.
2025-10-01 15:59:44,482 INFO Stage export completado correctamente.
2025-10-01 15:59:44,482 INFO === RUN PIPELINE END 2025-10-01T13:59:44.482892 UTC (duración 123.4 s) ===
2025-10-01 15:59:45,686 INFO Resumen candidatos: total=14 (preview):
2025-10-01 15:59:45,698 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
     ACM 129.720001 0.985727 129.899334 129.298122 125.649966 70.973552 49.168939        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.108876 COMMODITIES
    GATX 174.490005 1.383571 175.099789 173.526358 168.071770 71.766860 48.496321        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.308352 COMMODITIES
     AIR  83.071098 2.035714  85.843335  81.216222  77.703255 77.787233 47.483632        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 24.352586 COMMODITIES
     MUR  28.512699 0.623214  28.753796  27.973899  26.362554 39.171532 49.262502        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.549733     ENERGIA
     PSX 135.539993 1.706842 136.394032 134.656798 131.370485 52.715608 48.860876        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.987497     ENERGIA
     MPC 191.279999 2.506772 193.981531 190.038797 182.126484 51.770719 45.540929        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.584595     ENERGIA
RENT3.SA  39.669998 0.528572  39.940146  39.516625  37.896746 15.825329 46.308426        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.365719  FINANCIERO
     MLI 100.169998 0.869749 100.652557  99.832238  96.311321 73.422890 47.660671        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.832083  FINANCIERO
    PSMT 118.665001 1.499150 120.093667 117.566955 113.578086 88.188076 47.519623        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.727130  FINANCIERO
     BHF  52.880001 0.742415  53.962412  52.441770  49.854577 64.720577 44.319611        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 22.971246  FINANCIERO
     AAP  60.900002 1.009462  61.202556  60.856862  60.032171 87.374630 49.101115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 42.989043       SALUD
     WIX 176.830002 3.676994 177.092723 174.830468 161.275254 65.822375 49.090061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.752360  TECNOLOGÍA
    IDCC 341.799988 4.365411 345.093737 335.800316 304.739168 76.243103 48.044333        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.237160  TECNOLOGÍA
    WDAY 240.990005 2.785592 243.661110 238.879775 233.533525 70.919054 47.096868        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 29.513501  TECNOLOGÍA
2025-10-01 16:03:03,773 INFO === RUN PIPELINE START 2025-10-01T14:03:03.773756 UTC ===
2025-10-01 16:03:03,774 INFO Stage=fetch attempt 1/2
2025-10-01 16:03:03,774 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 16:04:37,483 INFO Salida (1_fetch_indicators.py): returncode=0 (t=93.7s)
2025-10-01 16:04:37,483 WARNING stderr: 2025-10-01 16:03:06,048 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 16:04:37,484 INFO Stage fetch completado correctamente.
2025-10-01 16:04:37,486 INFO Stage=score attempt 1/2
2025-10-01 16:04:37,486 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 16:04:39,146 INFO Salida (2_score_select.py): returncode=0 (t=1.7s)
2025-10-01 16:04:39,147 WARNING stderr: 2025-10-01 16:04:38,952 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 16:04:38,975 INFO Hard filters applied: passed=14 rejected=1084 (total=1098)
2025-10-01 16:04:38,987 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 16:04:39,004 INFO Scoring computed. Score stats: min=17.55 median=25.97 max=57.68
2025-10-01 16:04:39,008 INFO Selected top 8 per sector. Selected rows=14
2025-10-01 16:04:39,028 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 16:04:39,031 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 16:04:39,031 INFO SUMMARY: total_indicators=1098 passed=14 selected=14 rejected=1084
2025-10-01 16:04:39,033 INFO Sector=COMMODITIES -> ACM, GATX, AIR
2025-10-01 16:04:39,033 INFO Sector=ENERGIA -> MUR, PSX, MPC
2025-10-01 16:04:39,034 INFO Sector=FINANCIERO -> RENT3.SA, MLI, PSMT, BHF
2025-10-01 16:04:39,034 INFO Sector=SALUD -> AAP
2025-10-01 16:04:39,035 INFO Sector=TECNOLOGÍA -> WIX, IDCC, WDAY
2025-10-01 16:04:39,147 INFO Stage score completado correctamente.
2025-10-01 16:04:39,147 INFO Stage=export attempt 1/2
2025-10-01 16:04:39,147 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 16:04:54,178 INFO Salida (3_export_sheets.py): returncode=0 (t=15.0s)
2025-10-01 16:04:54,179 WARNING stderr: 2025-10-01 16:04:41,491 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'TECNOLOGÍA']
2025-10-01 16:04:41,493 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 16:04:41,520 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 16:04:41,521 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 16:04:43,996 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 16:04:43,996 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 16:04:47,647 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H7 (cols=8) filas=1 (tickers: AAP)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:04:48,486 INFO export_sheets: Hoja 'SALUD': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 16:04:48,486 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 16:04:53,198 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H9 (cols=8) filas=3 (tickers: WIX, IDCC, WDAY)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:04:53,976 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 16:04:53,976 INFO export_sheets: Export finalizado.
2025-10-01 16:04:54,179 INFO Stage export completado correctamente.
2025-10-01 16:04:54,179 INFO === RUN PIPELINE END 2025-10-01T14:04:54.179879 UTC (duración 110.4 s) ===
2025-10-01 16:04:55,334 INFO Resumen candidatos: total=14 (preview):
2025-10-01 16:04:55,345 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
     ACM 129.720001 0.985727 129.899334 129.298122 125.649966 70.973552 49.168939        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 42.289582 COMMODITIES
    GATX 174.490005 1.383571 175.099789 173.526358 168.071770 71.766860 48.496321        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.901034 COMMODITIES
     AIR  83.071098 2.035714  85.843335  81.216222  77.703255 77.787233 47.483632        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 17.970589 COMMODITIES
     MUR  28.512699 0.623214  28.753796  27.973899  26.362554 39.171532 49.262502        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.681131     ENERGIA
     PSX 135.539993 1.706842 136.394032 134.656798 131.370485 52.715608 48.860876        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.983875     ENERGIA
     MPC 191.279999 2.506772 193.981531 190.038797 182.126484 51.770719 45.540929        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.361532     ENERGIA
RENT3.SA  39.669998 0.528572  39.940146  39.516625  37.896746 15.825329 46.308426        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.254808  FINANCIERO
     MLI 100.169998 0.869749 100.652557  99.832238  96.311321 73.422890 47.660671        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.283825  FINANCIERO
    PSMT 118.665001 1.499150 120.093667 117.566955 113.578086 88.188076 47.519623        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 18.197294  FINANCIERO
     BHF  52.880001 0.742415  53.962412  52.441770  49.854577 64.720577 44.319611        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 17.550827  FINANCIERO
     AAP  60.900002 1.009462  61.202556  60.856862  60.032171 87.374630 49.101115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.991857       SALUD
     WIX 176.830002 3.676994 177.092723 174.830468 161.275254 65.822375 49.090061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 38.037860  TECNOLOGÍA
    IDCC 341.799988 4.365411 345.093737 335.800316 304.739168 76.243103 48.044333        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.692053  TECNOLOGÍA
    WDAY 240.990005 2.785592 243.661110 238.879775 233.533525 70.919054 47.096868        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.924500  TECNOLOGÍA
2025-10-01 16:06:27,846 INFO === RUN PIPELINE START 2025-10-01T14:06:27.846722 UTC ===
2025-10-01 16:06:27,847 INFO Stage=export attempt 1/2
2025-10-01 16:06:27,847 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 16:06:38,677 INFO === RUN PIPELINE START 2025-10-01T14:06:38.677482 UTC ===
2025-10-01 16:06:38,678 INFO Stage=score attempt 1/2
2025-10-01 16:06:38,678 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 16:06:40,418 INFO Salida (2_score_select.py): returncode=0 (t=1.7s)
2025-10-01 16:06:40,418 WARNING stderr: 2025-10-01 16:06:40,208 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 16:06:40,236 INFO Hard filters applied: passed=14 rejected=1084 (total=1098)
2025-10-01 16:06:40,247 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 16:06:40,266 INFO Scoring computed. Score stats: min=17.26 median=29.62 max=51.89
2025-10-01 16:06:40,271 INFO Selected top 4 per sector. Selected rows=14
2025-10-01 16:06:40,293 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 16:06:40,295 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 16:06:40,296 INFO SUMMARY: total_indicators=1098 passed=14 selected=14 rejected=1084
2025-10-01 16:06:40,297 INFO Sector=COMMODITIES -> ACM, GATX, AIR
2025-10-01 16:06:40,297 INFO Sector=ENERGIA -> MUR, PSX, MPC
2025-10-01 16:06:40,298 INFO Sector=FINANCIERO -> RENT3.SA, MLI, PSMT, BHF
2025-10-01 16:06:40,298 INFO Sector=SALUD -> AAP
2025-10-01 16:06:40,298 INFO Sector=TECNOLOGÍA -> WIX, IDCC, WDAY
2025-10-01 16:06:40,418 INFO Stage score completado correctamente.
2025-10-01 16:06:40,419 INFO === RUN PIPELINE END 2025-10-01T14:06:40.419125 UTC (duración 1.7 s) ===
2025-10-01 16:06:41,565 INFO Resumen candidatos: total=14 (preview):
2025-10-01 16:06:41,576 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
     ACM 129.720001 0.985727 129.899334 129.298122 125.649966 70.973552 49.168939        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.892574 COMMODITIES
    GATX 174.490005 1.383571 175.099789 173.526358 168.071770 71.766860 48.496321        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.661205 COMMODITIES
     AIR  83.071098 2.035714  85.843335  81.216222  77.703255 77.787233 47.483632        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.682994 COMMODITIES
     MUR  28.512699 0.623214  28.753796  27.973899  26.362554 39.171532 49.262502        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.796415     ENERGIA
     PSX 135.539993 1.706842 136.394032 134.656798 131.370485 52.715608 48.860876        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.903621     ENERGIA
     MPC 191.279999 2.506772 193.981531 190.038797 182.126484 51.770719 45.540929        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 21.493528     ENERGIA
RENT3.SA  39.669998 0.528572  39.940146  39.516625  37.896746 15.825329 46.308426        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.330195  FINANCIERO
     MLI 100.169998 0.869749 100.652557  99.832238  96.311321 73.422890 47.660671        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.720372  FINANCIERO
    PSMT 118.665001 1.499150 120.093667 117.566955 113.578086 88.188076 47.519623        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.449153  FINANCIERO
     BHF  52.880001 0.742415  53.962412  52.441770  49.854577 64.720577 44.319611        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 17.261460  FINANCIERO
     AAP  60.900002 1.009462  61.202556  60.856862  60.032171 87.374630 49.101115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.030050       SALUD
     WIX 176.830002 3.676994 177.092723 174.830468 161.275254 65.822375 49.090061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.692501  TECNOLOGÍA
    IDCC 341.799988 4.365411 345.093737 335.800316 304.739168 76.243103 48.044333        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.723933  TECNOLOGÍA
    WDAY 240.990005 2.785592 243.661110 238.879775 233.533525 70.919054 47.096868        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 22.780936  TECNOLOGÍA
2025-10-01 16:06:48,365 INFO === RUN PIPELINE START 2025-10-01T14:06:48.365390 UTC ===
2025-10-01 16:06:48,365 INFO Stage=export attempt 1/2
2025-10-01 16:06:48,366 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 16:06:58,352 INFO Salida (3_export_sheets.py): returncode=0 (t=10.0s)
2025-10-01 16:06:58,353 WARNING stderr: 2025-10-01 16:06:50,636 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'TECNOLOGÍA']
2025-10-01 16:06:50,638 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 16:06:50,647 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 16:06:50,649 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 16:06:53,722 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 16:06:53,722 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 16:06:55,437 INFO export_sheets: Ticker AAP omitido en 'SALUD' por duplicado reciente.
2025-10-01 16:06:55,438 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 16:06:55,438 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 16:06:57,816 INFO export_sheets: Ticker WIX omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 16:06:57,817 INFO export_sheets: Ticker IDCC omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 16:06:57,817 INFO export_sheets: Ticker WDAY omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 16:06:57,817 INFO export_sheets: No hay filas nuevas para añadir en 'TECNOLOGÍA' (tras filtrar duplicados).
2025-10-01 16:06:57,817 INFO export_sheets: Export finalizado.
2025-10-01 16:06:58,353 INFO Stage export completado correctamente.
2025-10-01 16:06:58,354 INFO === RUN PIPELINE END 2025-10-01T14:06:58.354007 UTC (duración 10.0 s) ===
2025-10-01 16:06:59,682 INFO Resumen candidatos: total=14 (preview):
2025-10-01 16:06:59,695 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
     ACM 129.720001 0.985727 129.899334 129.298122 125.649966 70.973552 49.168939        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.892574 COMMODITIES
    GATX 174.490005 1.383571 175.099789 173.526358 168.071770 71.766860 48.496321        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.661205 COMMODITIES
     AIR  83.071098 2.035714  85.843335  81.216222  77.703255 77.787233 47.483632        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.682994 COMMODITIES
     MUR  28.512699 0.623214  28.753796  27.973899  26.362554 39.171532 49.262502        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 50.796415     ENERGIA
     PSX 135.539993 1.706842 136.394032 134.656798 131.370485 52.715608 48.860876        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 30.903621     ENERGIA
     MPC 191.279999 2.506772 193.981531 190.038797 182.126484 51.770719 45.540929        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 21.493528     ENERGIA
RENT3.SA  39.669998 0.528572  39.940146  39.516625  37.896746 15.825329 46.308426        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.330195  FINANCIERO
     MLI 100.169998 0.869749 100.652557  99.832238  96.311321 73.422890 47.660671        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.720372  FINANCIERO
    PSMT 118.665001 1.499150 120.093667 117.566955 113.578086 88.188076 47.519623        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 19.449153  FINANCIERO
     BHF  52.880001 0.742415  53.962412  52.441770  49.854577 64.720577 44.319611        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 17.261460  FINANCIERO
     AAP  60.900002 1.009462  61.202556  60.856862  60.032171 87.374630 49.101115        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.030050       SALUD
     WIX 176.830002 3.676994 177.092723 174.830468 161.275254 65.822375 49.090061        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.692501  TECNOLOGÍA
    IDCC 341.799988 4.365411 345.093737 335.800316 304.739168 76.243103 48.044333        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.723933  TECNOLOGÍA
    WDAY 240.990005 2.785592 243.661110 238.879775 233.533525 70.919054 47.096868        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 22.780936  TECNOLOGÍA
2025-10-01 16:11:25,418 INFO === RUN PIPELINE START 2025-10-01T14:11:25.418725 UTC ===
2025-10-01 16:11:25,419 INFO Stage=fetch attempt 1/2
2025-10-01 16:11:25,419 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 16:14:09,168 INFO Salida (1_fetch_indicators.py): returncode=0 (t=163.7s)
2025-10-01 16:14:09,169 WARNING stderr: 2025-10-01 16:11:27,630 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:229: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-10-01 16:11:27,673 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py", line 230, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:301: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:
2025-10-01 16:14:09,169 INFO Stage fetch completado correctamente.
2025-10-01 16:14:09,171 INFO Stage=score attempt 1/2
2025-10-01 16:14:09,171 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 16:14:10,771 INFO Salida (2_score_select.py): returncode=0 (t=1.6s)
2025-10-01 16:14:10,772 WARNING stderr: 2025-10-01 16:14:10,590 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 16:14:10,613 INFO Hard filters applied: passed=5 rejected=1093 (total=1098)
2025-10-01 16:14:10,622 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 16:14:10,638 INFO Scoring computed. Score stats: min=36.47 median=54.44 max=55.81
2025-10-01 16:14:10,649 INFO Selected top 4 per sector. Selected rows=5
2025-10-01 16:14:10,667 INFO Wrote selected candidates (parquet) to intermediate/candidates.parquet
2025-10-01 16:14:10,669 INFO Wrote sheet-ready CSV to intermediate/candidates.sheet_ready.csv (columns will match sheet layout)
2025-10-01 16:14:10,669 INFO SUMMARY: total_indicators=1098 passed=5 selected=5 rejected=1093
2025-10-01 16:14:10,671 INFO Sector=ENERGIA -> OKLO
2025-10-01 16:14:10,671 INFO Sector=FINANCIERO -> FWONK, JPM, RENT3.SA
2025-10-01 16:14:10,672 INFO Sector=TECNOLOGÍA -> KEYS
2025-10-01 16:14:10,772 INFO Stage score completado correctamente.
2025-10-01 16:14:10,772 INFO Stage=export attempt 1/2
2025-10-01 16:14:10,772 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 16:14:20,558 INFO Salida (3_export_sheets.py): returncode=0 (t=9.8s)
2025-10-01 16:14:20,558 WARNING stderr: 2025-10-01 16:14:12,730 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'TECNOLOGÍA']
2025-10-01 16:14:12,732 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 16:14:12,755 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 16:14:12,756 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 16:14:15,132 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 16:14:15,132 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 16:14:15,908 INFO export_sheets: No se encontraron candidatos para sheet 'SALUD' (ni exact ni fuzzy).
2025-10-01 16:14:15,908 INFO export_sheets: No hay candidatos para sheet 'SALUD'. Saltando.
2025-10-01 16:14:15,908 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 16:14:19,528 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A7:H7 (cols=8) filas=1 (tickers: KEYS)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:14:20,339 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 16:14:20,339 INFO export_sheets: Export finalizado.
2025-10-01 16:14:20,558 INFO Stage export completado correctamente.
2025-10-01 16:14:20,559 INFO === RUN PIPELINE END 2025-10-01T14:14:20.559074 UTC (duración 175.1 s) ===
2025-10-01 16:14:21,698 INFO Resumen candidatos: total=5 (preview):
2025-10-01 16:14:21,708 INFO   TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
    OKLO 111.699997 4.909857 114.821207 111.394545  93.133553 36.513854 44.332100        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.807799    ENERGIA
   FWONK 103.489899 1.144178 103.777920 102.990189 101.771818 47.502226 49.334113        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.311655 FINANCIERO
     JPM 312.114990 2.957877 313.768207 311.554821 303.899227 45.267395 46.750220        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.546668 FINANCIERO
RENT3.SA  39.889999 0.528572  39.967647  39.525253  37.899660 17.002852 49.525634        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.469811 FINANCIERO
    KEYS 173.779999 1.358929 173.935267 173.548276 169.945349 33.694175 48.660838        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.440544 TECNOLOGÍA
2025-10-01 16:36:00,376 INFO === RUN PIPELINE START 2025-10-01T14:36:00.376479 UTC ===
2025-10-01 16:36:00,377 INFO Stage=fetch attempt 1/2
2025-10-01 16:36:00,377 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 16:40:44,518 INFO Salida (1_fetch_indicators.py): returncode=0 (t=284.1s)
2025-10-01 16:40:44,518 WARNING stderr: 2025-10-01 16:36:02,693 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-10-01 16:36:02,720 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-10-01 16:36:06,956 ERROR HTTP Error 404: 
2025-10-01 16:36:24,476 ERROR 
32 Failed downloads:
2025-10-01 16:36:24,477 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759329365. The requested range must be within the last 60 days.")')
2025-10-01 16:36:24,477 ERROR ['AYV', 'CEZ', 'CIE', 'COL', 'BNP', 'CABK', 'BMW', 'AF', 'ACS', 'ANA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-10-01 16:36:24,477 ERROR ['BAS', 'BP.LS', 'AGUA', 'ANTM', 'CERN', 'BAYN', 'AYDEN', 'ALO', 'ALFAA', 'BBSE3', 'BC8', 'BHIA3', 'ADS', 'CNC.MI', 'CMIN3', 'AIXA', 'CPFE3', 'CAP', 'CBK', 'AMNB', 'CHK']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').a
2025-10-01 16:40:44,519 INFO Stage fetch completado correctamente.
2025-10-01 16:40:44,520 INFO Stage=score attempt 1/2
2025-10-01 16:40:44,520 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 16:40:46,355 INFO Salida (2_score_select.py): returncode=1 (t=1.8s)
2025-10-01 16:40:46,356 WARNING stderr: 2025-10-01 16:40:46,033 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
Traceback (most recent call last):
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\2_score_select.py", line 430, in <module>
    main()
    ~~~~^^
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\2_score_select.py", line 381, in main
    passed, rejected = apply_hard_filters(df, cfg)
                       ~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\2_score_select.py", line 201, in apply_hard_filters
    dist_macro = (df['LastClose'] - df[col]) / df['ATR_2H']
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\arraylike.py", line 210, in __truediv__
    return self._arith_method(other, operator.truediv)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\series.py", line 6146, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\ops\array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\ops\array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\computation\expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\computation\expressions.py", line 73, in _evaluate_standard
    return op(a, b)
ZeroDivisionError: float division by zero
2025-10-01 16:40:46,356 WARNING Stage score fallo con code=1
2025-10-01 16:40:46,356 INFO Reintentando en 5s...
2025-10-01 16:40:51,357 INFO Stage=score attempt 2/2
2025-10-01 16:40:51,358 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 16:40:53,016 INFO Salida (2_score_select.py): returncode=1 (t=1.7s)
2025-10-01 16:40:53,016 WARNING stderr: 2025-10-01 16:40:52,881 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
Traceback (most recent call last):
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\2_score_select.py", line 430, in <module>
    main()
    ~~~~^^
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\2_score_select.py", line 381, in main
    passed, rejected = apply_hard_filters(df, cfg)
                       ~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\2_score_select.py", line 201, in apply_hard_filters
    dist_macro = (df['LastClose'] - df[col]) / df['ATR_2H']
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\arraylike.py", line 210, in __truediv__
    return self._arith_method(other, operator.truediv)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\series.py", line 6146, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\ops\array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\ops\array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\computation\expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
  File "C:\Users\admin\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\computation\expressions.py", line 73, in _evaluate_standard
    return op(a, b)
ZeroDivisionError: float division by zero
2025-10-01 16:40:53,016 WARNING Stage score fallo con code=1
2025-10-01 16:40:53,016 ERROR Stage=score falló después de 2 intentos.
2025-10-01 16:40:53,017 ERROR Pipeline abortado: Stage score failed after 2 attempts.
Traceback (most recent call last):
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\run_pipeline.py", line 137, in main
    run_stage("score", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\admin\Downloads\Financiero (3)\Financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage score failed after 2 attempts.
2025-10-01 16:40:53,027 INFO Revisa run_pipeline.log para más detalles.
2025-10-01 16:46:23,260 INFO === RUN PIPELINE START 2025-10-01T14:46:23.260577 UTC ===
2025-10-01 16:46:23,261 INFO Stage=fetch attempt 1/2
2025-10-01 16:46:23,261 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 16:49:49,351 INFO Salida (1_fetch_indicators.py): returncode=0 (t=206.1s)
2025-10-01 16:49:49,351 WARNING stderr: 2025-10-01 16:46:25,372 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
C:\Users\admin\Downloads\Financiero (3)\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-01 16:49:49,352 INFO Stage fetch completado correctamente.
2025-10-01 16:49:49,353 INFO Stage=score attempt 1/2
2025-10-01 16:49:49,353 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 16:49:50,985 INFO Salida (2_score_select.py): returncode=0 (t=1.6s)
2025-10-01 16:49:50,986 WARNING stderr: 2025-10-01 16:49:50,777 INFO Loaded indicators from parquet: intermediate/indicators.parquet (rows=1098)
2025-10-01 16:49:50,803 INFO Hard filters: passed=13 rejected=1085 total=1098
2025-10-01 16:49:50,821 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 16:49:50,841 INFO Scoring computed. Score stats: min=23.17 median=44.36 max=59.10
2025-10-01 16:49:50,846 INFO Selected top 4 per sector -> 12 rows
2025-10-01 16:49:50,865 INFO Wrote selected parquet: intermediate/candidates.parquet
2025-10-01 16:49:50,868 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-01 16:49:50,868 INFO SUMMARY: total_indicators=1098 passed=13 selected=12 rejected=1085
2025-10-01 16:49:50,869 INFO Sector=COMMODITIES -> RHM.DE, STRL
2025-10-01 16:49:50,870 INFO Sector=ENERGIA -> OKLO, PSX, MPC
2025-10-01 16:49:50,870 INFO Sector=FINANCIERO -> JPM, CFG, FWONK, RENT3.SA
2025-10-01 16:49:50,870 INFO Sector=SALUD -> GHC
2025-10-01 16:49:50,871 INFO Sector=TECNOLOGÍA -> GDS, QCOM
2025-10-01 16:49:50,986 INFO Stage score completado correctamente.
2025-10-01 16:49:50,986 INFO Stage=export attempt 1/2
2025-10-01 16:49:50,987 INFO Ejecutando: 'C:\Users\admin\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 16:50:18,412 INFO Salida (3_export_sheets.py): returncode=0 (t=27.4s)
2025-10-01 16:50:18,412 WARNING stderr: 2025-10-01 16:49:53,007 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 16:49:53,009 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 16:49:53,040 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 16:49:53,041 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 16:49:55,960 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 16:49:55,961 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 16:50:00,158 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A7:H7 (cols=8) filas=1 (tickers: GHC)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:50:00,985 INFO export_sheets: Hoja 'SALUD': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 16:50:00,985 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 16:50:03,146 INFO export_sheets: Ticker OKLO omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 16:50:04,639 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H8 (cols=8) filas=2 (tickers: PSX, MPC)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:50:05,398 INFO export_sheets: Hoja 'ENERGÍA': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-01 16:50:05,398 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 16:50:07,858 INFO export_sheets: Ticker STRL omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 16:50:09,483 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A8:H8 (cols=8) filas=1 (tickers: RHM.DE)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:50:10,396 INFO export_sheets: Hoja 'COMMODITIES': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 16:50:10,396 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 16:50:13,488 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A8:H9 (cols=8) filas=2 (tickers: GDS, QCOM)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 16:50:14,302 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-01 16:50:14,302 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 16:50:16,784 INFO export_sheets: Ticker RENT3.SA omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 16:50:17,956 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A8:H10 (cols=8) filas=3 (tickers: JPM, CFG, FWONK)
C:\Users\admin\Downloads\Financiero (3)\Financiero\3_export_sheets.py:355: Deprecatio
2025-10-01 16:50:18,413 INFO Stage export completado correctamente.
2025-10-01 16:50:18,414 INFO === RUN PIPELINE END 2025-10-01T14:50:18.414123 UTC (duración 235.2 s) ===
2025-10-01 16:50:19,579 INFO Resumen candidatos: total=12 (preview):
2025-10-01 16:50:19,591 INFO   TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  RHM.DE 1941.000000 21.535714 1954.651613 1940.243020 1856.771277 41.841296 45.234502        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.582005 COMMODITIES
    STRL  340.200012  7.370283  340.900721  336.656456  310.379559 33.580183 48.636402        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.081190 COMMODITIES
    OKLO  113.120003  5.049143  114.998708  111.450232   93.152361 38.393550 46.285555        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.095657     ENERGIA
     PSX  134.830002  1.749927  136.182123  134.657938  131.414346 41.386136 46.496412        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.337706     ENERGIA
     MPC  191.330093  2.504323  193.697133  190.105638  182.254006 44.656818 45.589005        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 44.355541     ENERGIA
     JPM  311.970001  2.976092  313.750083  311.549135  303.897307 46.231819 46.399086        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.464351  FINANCIERO
     CFG   52.900002  0.654214   52.987226   52.731506   51.396796 51.134415 49.354046        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 42.487483  FINANCIERO
   FWONK  103.019997  1.151328  103.719182  102.971761  101.765594 47.928213 46.397257        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.541686  FINANCIERO
RENT3.SA   39.720001  0.517857   39.937785   39.533267   37.923901 20.855763 47.178658        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.502811  FINANCIERO
     GHC 1165.000000  9.640712 1172.251644 1158.362339 1102.823564 51.658178 48.023797        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 26.128646       SALUD
     GDS   39.294998  1.085772   39.709210   39.004036   36.800627 40.025972 47.869390        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.011447  TECNOLOGÍA
    QCOM  166.600006  1.632214  167.051625  166.527416  162.356264 33.776570 46.572825        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.870582  TECNOLOGÍA
2025-10-01 21:45:52,789 INFO === RUN PIPELINE START 2025-10-01T19:45:52.789278 UTC ===
2025-10-01 21:45:52,789 INFO Stage=fetch attempt 1/2
2025-10-01 21:45:52,789 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 21:46:10,664 INFO === RUN PIPELINE START 2025-10-01T19:46:10.664196 UTC ===
2025-10-01 21:46:10,664 INFO Stage=fetch attempt 1/2
2025-10-01 21:46:10,664 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 21:47:48,590 INFO Salida (1_fetch_indicators.py): returncode=0 (t=97.9s)
2025-10-01 21:47:48,590 WARNING stderr: 2025-10-01 21:46:11,342 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' i
2025-10-01 21:47:48,590 INFO Stage fetch completado correctamente.
2025-10-01 21:47:48,591 INFO Stage=score attempt 1/2
2025-10-01 21:47:48,591 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 21:47:49,112 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-01 21:47:49,112 WARNING stderr: 2025-10-01 21:47:49,014 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-01 21:47:49,021 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-10-01 21:47:49,031 INFO Hard filters: passed=8 rejected=1090 total=1098
2025-10-01 21:47:49,043 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 21:47:49,053 INFO Scoring computed. Score stats: min=28.18 median=42.24 max=64.56
2025-10-01 21:47:49,057 INFO Selected top 6 per sector -> 8 rows
2025-10-01 21:47:49,064 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-01 21:47:49,066 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-01 21:47:49,066 INFO SUMMARY: total_indicators=1098 passed=8 selected=8 rejected=1090
2025-10-01 21:47:49,067 INFO Sector=COMMODITIES -> RHM.DE
2025-10-01 21:47:49,067 INFO Sector=ENERGIA -> DVN, MPC, PSX
2025-10-01 21:47:49,067 INFO Sector=FINANCIERO -> CFG
2025-10-01 21:47:49,067 INFO Sector=SALUD -> GHC
2025-10-01 21:47:49,067 INFO Sector=TECNOLOGÍA -> KEYS, GFS
2025-10-01 21:47:49,112 INFO Stage score completado correctamente.
2025-10-01 21:47:49,112 INFO Stage=export attempt 1/2
2025-10-01 21:47:49,112 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 21:48:10,800 INFO Salida (3_export_sheets.py): returncode=0 (t=21.7s)
2025-10-01 21:48:10,800 WARNING stderr: 2025-10-01 21:47:49,907 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 21:47:49,908 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 21:47:49,911 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 21:47:49,911 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 21:47:51,648 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 21:47:51,648 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 21:47:53,944 INFO export_sheets: Ticker GHC omitido en 'SALUD' por duplicado reciente.
2025-10-01 21:47:53,944 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 21:47:53,944 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 21:47:57,525 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A7:H9 (cols=8) filas=3 (tickers: DVN, MPC, PSX)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 21:47:58,283 INFO export_sheets: Hoja 'ENERGÍA': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-01 21:47:58,283 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 21:48:01,746 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A8:H8 (cols=8) filas=1 (tickers: RHM.DE)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 21:48:02,409 INFO export_sheets: Hoja 'COMMODITIES': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 21:48:02,409 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 21:48:04,436 INFO export_sheets: Ticker KEYS omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 21:48:05,810 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A8:H8 (cols=8) filas=1 (tickers: GFS)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 21:48:06,467 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 21:48:06,467 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 21:48:10,013 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A8:H8 (cols=8) filas=1 (tickers: CFG)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 21:48:10,721 INFO export_sheets: Hoja 'FINANCIERO': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 21:48:10,721 INFO export_sheets: Export finalizado.
2025-10-01 21:48:10,800 INFO Stage export completado correctamente.
2025-10-01 21:48:10,800 INFO === RUN PIPELINE END 2025-10-01T19:48:10.800960 UTC (duración 120.1 s) ===
2025-10-01 21:48:11,136 INFO Resumen candidatos: total=8 (preview):
2025-10-01 21:48:11,141 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
RHM.DE 1948.500000 22.285714 1955.589113 1940.537137 1856.870615 45.926497 47.704562        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 64.556150 COMMODITIES
   DVN   35.365002  0.532200   35.386520   35.250321   34.811448 45.896082 49.925187        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.418713     ENERGIA
   MPC  192.779999  2.184629  193.461439  190.306752  182.529698 37.727518 49.883483        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.327341     ENERGIA
   PSX  134.764008  1.604571  135.898805  134.685643  131.509551 31.966684 46.420443        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.588766     ENERGIA
   CFG   52.799999  0.594572   52.939107   52.735280   51.433200 54.190674 48.435908        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.026286  FINANCIERO
   GHC 1159.140015  8.232500 1169.107597 1158.369673 1104.284234 38.545144 44.812678        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.154521       SALUD
  KEYS  173.619995  1.367857  173.760658  173.516311  170.028741 34.773815 48.421156        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.046479  TECNOLOGÍA
   GFS   34.580002  0.871028   35.238784   34.236420   34.301454 43.082463 48.016920        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.176117  TECNOLOGÍA
2025-10-01 22:00:04,442 INFO === RUN PIPELINE START 2025-10-01T20:00:04.442195 UTC ===
2025-10-01 22:00:04,442 INFO Stage=fetch attempt 1/2
2025-10-01 22:00:04,442 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 22:01:18,186 INFO Salida (1_fetch_indicators.py): returncode=0 (t=73.7s)
2025-10-01 22:01:18,186 WARNING stderr: 2025-10-01 22:00:05,186 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' i
2025-10-01 22:01:18,186 INFO Stage fetch completado correctamente.
2025-10-01 22:01:18,187 INFO Stage=score attempt 1/2
2025-10-01 22:01:18,187 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 22:01:18,691 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-01 22:01:18,692 WARNING stderr: 2025-10-01 22:01:18,593 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-01 22:01:18,601 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-10-01 22:01:18,611 INFO Hard filters: passed=8 rejected=1090 total=1098
2025-10-01 22:01:18,622 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 22:01:18,631 INFO Scoring computed. Score stats: min=28.18 median=42.24 max=64.56
2025-10-01 22:01:18,633 INFO Selected top 6 per sector -> 8 rows
2025-10-01 22:01:18,639 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-01 22:01:18,641 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-01 22:01:18,641 INFO SUMMARY: total_indicators=1098 passed=8 selected=8 rejected=1090
2025-10-01 22:01:18,642 INFO Sector=COMMODITIES -> RHM.DE
2025-10-01 22:01:18,642 INFO Sector=ENERGIA -> DVN, MPC, PSX
2025-10-01 22:01:18,642 INFO Sector=FINANCIERO -> CFG
2025-10-01 22:01:18,642 INFO Sector=SALUD -> GHC
2025-10-01 22:01:18,642 INFO Sector=TECNOLOGÍA -> KEYS, GFS
2025-10-01 22:01:18,692 INFO Stage score completado correctamente.
2025-10-01 22:01:18,692 INFO Stage=export attempt 1/2
2025-10-01 22:01:18,692 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 22:01:33,812 INFO Salida (3_export_sheets.py): returncode=0 (t=15.1s)
2025-10-01 22:01:33,812 WARNING stderr: 2025-10-01 22:01:19,312 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 22:01:19,312 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 22:01:19,316 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 22:01:19,316 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 22:01:21,147 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 22:01:21,147 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 22:01:23,351 INFO export_sheets: Ticker GHC omitido en 'SALUD' por duplicado reciente.
2025-10-01 22:01:23,351 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-01 22:01:23,351 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 22:01:25,584 INFO export_sheets: Ticker MPC omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 22:01:25,584 INFO export_sheets: Ticker PSX omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 22:01:27,064 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A8:H8 (cols=8) filas=1 (tickers: DVN)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 22:01:27,795 INFO export_sheets: Hoja 'ENERGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 22:01:27,795 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 22:01:29,971 INFO export_sheets: Ticker RHM.DE omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 22:01:29,971 INFO export_sheets: No hay filas nuevas para añadir en 'COMMODITIES' (tras filtrar duplicados).
2025-10-01 22:01:29,971 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 22:01:31,611 INFO export_sheets: Ticker KEYS omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 22:01:31,612 INFO export_sheets: Ticker GFS omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 22:01:31,612 INFO export_sheets: No hay filas nuevas para añadir en 'TECNOLOGÍA' (tras filtrar duplicados).
2025-10-01 22:01:31,612 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 22:01:33,739 INFO export_sheets: Ticker CFG omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 22:01:33,740 INFO export_sheets: No hay filas nuevas para añadir en 'FINANCIERO' (tras filtrar duplicados).
2025-10-01 22:01:33,740 INFO export_sheets: Export finalizado.
2025-10-01 22:01:33,812 INFO Stage export completado correctamente.
2025-10-01 22:01:33,812 INFO === RUN PIPELINE END 2025-10-01T20:01:33.812783 UTC (duración 89.4 s) ===
2025-10-01 22:01:34,139 INFO Resumen candidatos: total=8 (preview):
2025-10-01 22:01:34,143 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
RHM.DE 1948.500000 22.285714 1955.589113 1940.537137 1856.870615 45.926497 47.704562        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 64.556150 COMMODITIES
   DVN   35.365002  0.532200   35.386520   35.250321   34.811448 45.896082 49.925187        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.418713     ENERGIA
   MPC  192.779999  2.184629  193.461439  190.306752  182.529698 37.727518 49.883483        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.327341     ENERGIA
   PSX  134.764008  1.604571  135.898805  134.685643  131.509551 31.966684 46.420443        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.588766     ENERGIA
   CFG   52.799999  0.594572   52.939107   52.735280   51.433200 54.190674 48.435908        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 36.026286  FINANCIERO
   GHC 1159.140015  8.232500 1169.107597 1158.369673 1104.284234 38.545144 44.812678        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.154521       SALUD
  KEYS  173.619995  1.367857  173.760658  173.516311  170.028741 34.773815 48.421156        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.046479  TECNOLOGÍA
   GFS   34.580002  0.871028   35.238784   34.236420   34.301454 43.082463 48.016920        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.176117  TECNOLOGÍA
2025-10-01 22:02:52,307 INFO === RUN PIPELINE START 2025-10-01T20:02:52.307266 UTC ===
2025-10-01 22:02:52,307 INFO Stage=fetch attempt 1/2
2025-10-01 22:02:52,307 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-01 22:04:50,110 INFO Salida (1_fetch_indicators.py): returncode=0 (t=117.8s)
2025-10-01 22:04:50,110 WARNING stderr: 2025-10-01 22:02:53,009 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:266: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df = pd.read_csv(p, index_col=0, parse_dates=True)
2025-10-01 22:02:53,016 ERROR Failed to load cache for ARX
Traceback (most recent call last):
  File "A:\pilim\Downloads\Financiero\1_fetch_indicators.py", line 267, in load_cache
    if df.index.tz is None:
       ^^^^^^^^^^^
AttributeError: 'Index' object has no attribute 'tz'
2025-10-01 22:02:53,023 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-10-01 22:02:54,178 ERROR HTTP Error 404: 
2025-10-01 22:02:54,576 ERROR HTTP Error 404: 
2025-10-01 22:03:00,500 ERROR 
32 Failed downloads:
2025-10-01 22:03:00,500 ERROR ['BNP', 'BMW', 'COL', 'CIE', 'AYV', 'ANA', 'CABK', 'ACS', 'CEZ', 'AF']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-10-01 22:03:00,500 ERROR ['AMNB', 'BP.LS', 'AGUA', 'BAS', 'CAP', 'AYDEN', 'ADS', 'ALFAA', 'BC8', 'BHIA3', 'BAYN', 'BBSE3', 'ALO', 'CMIN3', 'CERN', 'CNC.MI', 'CBK', 'CHK', 'CPFE3', 'ANTM', 'AIXA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-10-01 22:03:00,500 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759349061. The requested range must be within the last 60 days.")')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indica
2025-10-01 22:04:50,110 INFO Stage fetch completado correctamente.
2025-10-01 22:04:50,111 INFO Stage=score attempt 1/2
2025-10-01 22:04:50,111 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-01 22:04:50,629 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-01 22:04:50,629 WARNING stderr: 2025-10-01 22:04:50,536 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-01 22:04:50,544 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2025-10-01 22:04:50,553 INFO Hard filters: passed=11 rejected=1087 total=1098
2025-10-01 22:04:50,565 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-01 22:04:50,573 INFO Scoring computed. Score stats: min=22.53 median=31.40 max=58.19
2025-10-01 22:04:50,576 INFO Selected top 6 per sector -> 11 rows
2025-10-01 22:04:50,582 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-01 22:04:50,584 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-01 22:04:50,584 INFO SUMMARY: total_indicators=1098 passed=11 selected=11 rejected=1087
2025-10-01 22:04:50,584 INFO Sector=COMMODITIES -> RHM.DE, STRL, GATX
2025-10-01 22:04:50,585 INFO Sector=ENERGIA -> DVN, MPC
2025-10-01 22:04:50,585 INFO Sector=FINANCIERO -> BHF, CFG, JXN
2025-10-01 22:04:50,585 INFO Sector=SALUD -> ADUS
2025-10-01 22:04:50,585 INFO Sector=TECNOLOGÍA -> QCOM, GFS
2025-10-01 22:04:50,629 INFO Stage score completado correctamente.
2025-10-01 22:04:50,629 INFO Stage=export attempt 1/2
2025-10-01 22:04:50,630 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-01 22:05:13,034 INFO Salida (3_export_sheets.py): returncode=0 (t=22.4s)
2025-10-01 22:05:13,034 WARNING stderr: 2025-10-01 22:04:51,274 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-01 22:04:51,275 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-01 22:04:51,278 INFO export_sheets: Usando columna de sector: Sector
2025-10-01 22:04:51,279 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-01 22:04:52,327 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-01 22:04:52,327 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-01 22:04:55,749 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A8:H8 (cols=8) filas=1 (tickers: ADUS)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 22:04:56,523 INFO export_sheets: Hoja 'SALUD': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 22:04:56,523 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-01 22:04:58,259 INFO export_sheets: Ticker MPC omitido en 'ENERGÍA' por duplicado reciente.
2025-10-01 22:04:59,602 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A8:H8 (cols=8) filas=1 (tickers: DVN)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 22:05:00,336 INFO export_sheets: Hoja 'ENERGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 22:05:00,336 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-01 22:05:02,439 INFO export_sheets: Ticker RHM.DE omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 22:05:02,439 INFO export_sheets: Ticker STRL omitido en 'COMMODITIES' por duplicado reciente.
2025-10-01 22:05:03,904 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A9:H9 (cols=8) filas=1 (tickers: GATX)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 22:05:04,611 INFO export_sheets: Hoja 'COMMODITIES': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 22:05:04,612 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-01 22:05:06,814 INFO export_sheets: Ticker GFS omitido en 'TECNOLOGÍA' por duplicado reciente.
2025-10-01 22:05:08,152 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A8:H8 (cols=8) filas=1 (tickers: QCOM)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-01 22:05:08,822 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-01 22:05:08,822 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-01 22:05:10,941 INFO export_sheets: Ticker CFG omitido en 'FINANCIERO' por duplicado reciente.
2025-10-01 22:05:12,296 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A7:H8 (cols=8) filas=2 (tic
2025-10-01 22:05:13,034 INFO Stage export completado correctamente.
2025-10-01 22:05:13,035 INFO === RUN PIPELINE END 2025-10-01T20:05:13.035439 UTC (duración 140.7 s) ===
2025-10-01 22:05:13,391 INFO Resumen candidatos: total=11 (preview):
2025-10-01 22:05:13,396 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
RHM.DE 1948.500000 22.285714 1955.589113 1940.537137 1856.870615 45.926497 47.704562        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.194125 COMMODITIES
  STRL  337.920013  6.640710  340.432797  336.836248  311.133272 44.267559 46.815045        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.098269 COMMODITIES
  GATX  174.690002  1.259642  174.959143  173.654587  168.329933 52.183827 49.642009        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 27.265435 COMMODITIES
   DVN   35.314999  0.532200   35.380269   35.248360   34.810785 45.061274 49.320255        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.072767     ENERGIA
   MPC  192.350006  2.184629  193.407690  190.289889  182.524003 40.027169 48.583761        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 33.398782     ENERGIA
   BHF   53.200001  0.733801   53.792448   52.555613   49.995489 45.002632 46.975489        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 31.395154  FINANCIERO
   CFG   52.744999  0.594572   52.932232   52.733123   51.432472 52.351931 47.862040        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.893967  FINANCIERO
   JXN  101.269997  1.189327  101.608755  100.746296   97.559758 54.835834 48.799548        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 24.691065  FINANCIERO
  ADUS  115.779999  1.323494  116.786812  114.915621  113.424464 27.433892 48.194124        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.369323       SALUD
  QCOM  166.490005  1.575965  166.615890  166.414657  162.426388 34.872310 47.355860        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.978972  TECNOLOGÍA
   GFS   34.490002  0.871028   35.227534   34.232891   34.300262 41.393417 47.404248        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 22.528155  TECNOLOGÍA
2025-10-02 21:37:12,328 INFO === RUN PIPELINE START 2025-10-02T19:37:12.328585 UTC ===
2025-10-02 21:37:12,328 INFO Stage=fetch attempt 1/2
2025-10-02 21:37:12,329 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-02 21:37:25,842 INFO === RUN PIPELINE START 2025-10-02T19:37:25.842190 UTC ===
2025-10-02 21:37:25,842 INFO Stage=fetch attempt 1/2
2025-10-02 21:37:25,842 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-02 21:39:12,200 INFO Salida (1_fetch_indicators.py): returncode=0 (t=106.4s)
2025-10-02 21:39:12,200 WARNING stderr: 2025-10-02 21:37:26,560 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' i
2025-10-02 21:39:12,200 INFO Stage fetch completado correctamente.
2025-10-02 21:39:12,201 INFO Stage=score attempt 1/2
2025-10-02 21:39:12,201 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-02 21:39:12,742 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-02 21:39:12,742 WARNING stderr: 2025-10-02 21:39:12,645 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-02 21:39:12,652 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-10-02 21:39:12,662 INFO Hard filters: passed=5 rejected=1094 total=1099
2025-10-02 21:39:12,675 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-02 21:39:12,683 INFO Scoring computed. Score stats: min=37.51 median=54.02 max=62.03
2025-10-02 21:39:12,685 INFO Selected top 8 per sector -> 5 rows
2025-10-02 21:39:12,691 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-02 21:39:12,693 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-02 21:39:12,693 INFO SUMMARY: total_indicators=1099 passed=5 selected=5 rejected=1094
2025-10-02 21:39:12,694 INFO Sector=ENERGIA -> PSX, NFG, DTE
2025-10-02 21:39:12,694 INFO Sector=FINANCIERO -> JXN, YUM
2025-10-02 21:39:12,742 INFO Stage score completado correctamente.
2025-10-02 21:39:12,742 INFO Stage=export attempt 1/2
2025-10-02 21:39:12,742 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-02 21:39:26,046 INFO Salida (3_export_sheets.py): returncode=0 (t=13.3s)
2025-10-02 21:39:26,046 WARNING stderr: 2025-10-02 21:39:13,486 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-02 21:39:13,486 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-02 21:39:13,490 INFO export_sheets: Usando columna de sector: Sector
2025-10-02 21:39:13,490 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-02 21:39:15,186 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-02 21:39:15,186 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-02 21:39:15,897 INFO export_sheets: No se encontraron candidatos para sheet 'SALUD' (ni exact ni fuzzy).
2025-10-02 21:39:15,897 INFO export_sheets: No hay candidatos para sheet 'SALUD'. Saltando.
2025-10-02 21:39:15,897 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-02 21:39:17,897 INFO export_sheets: Ticker PSX omitido en 'ENERGÍA' por duplicado reciente.
2025-10-02 21:39:19,259 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A8:H9 (cols=8) filas=2 (tickers: NFG, DTE)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-02 21:39:20,014 INFO export_sheets: Hoja 'ENERGÍA': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-02 21:39:20,014 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-02 21:39:20,672 INFO export_sheets: No se encontraron candidatos para sheet 'COMMODITIES' (ni exact ni fuzzy).
2025-10-02 21:39:20,672 INFO export_sheets: No hay candidatos para sheet 'COMMODITIES'. Saltando.
2025-10-02 21:39:20,672 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-02 21:39:21,621 INFO export_sheets: No se encontraron candidatos para sheet 'TECNOLOGÍA' (ni exact ni fuzzy).
2025-10-02 21:39:21,621 INFO export_sheets: No hay candidatos para sheet 'TECNOLOGÍA'. Saltando.
2025-10-02 21:39:21,621 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-02 21:39:25,292 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A8:H9 (cols=8) filas=2 (tickers: JXN, YUM)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-02 21:39:25,957 INFO export_sheets: Hoja 'FINANCIERO': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-02 21:39:25,957 INFO export_sheets: Export finalizado.
2025-10-02 21:39:26,046 INFO Stage export completado correctamente.
2025-10-02 21:39:26,046 INFO === RUN PIPELINE END 2025-10-02T19:39:26.046905 UTC (duración 120.2 s) ===
2025-10-02 21:39:26,405 INFO Resumen candidatos: total=5 (preview):
2025-10-02 21:39:26,410 INFO TICKER     PRECIO   ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
   PSX 134.750000 1.495356 135.459519 134.710618 131.725249 41.854447 46.771238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.032873    ENERGIA
   NFG  91.665001 0.622216  92.187611  90.817877  88.589476 46.979910 48.210028        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.245494    ENERGIA
   DTE 138.940002 0.879951 139.801336 138.572001 137.532629 41.443638 45.974022        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 37.514041    ENERGIA
   JXN 101.345001 1.103220 101.374022 100.788946  97.647504 42.880492 49.723036        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.076383 FINANCIERO
   YUM 151.190002 1.201783 152.103633 150.506974 148.550697 42.640372 47.580063        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.019224 FINANCIERO
2025-10-02 22:29:10,028 INFO === RUN PIPELINE START 2025-10-02T20:29:10.028612 UTC ===
2025-10-02 22:29:10,028 INFO Stage=fetch attempt 1/2
2025-10-02 22:29:10,029 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-02 22:31:19,094 INFO Salida (1_fetch_indicators.py): returncode=0 (t=129.1s)
2025-10-02 22:31:19,095 WARNING stderr: 2025-10-02 22:29:10,779 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-10-02 22:29:10,790 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-10-02 22:29:12,570 ERROR HTTP Error 404: 
2025-10-02 22:29:18,674 ERROR 
31 Failed downloads:
2025-10-02 22:29:18,674 ERROR ['ACS', 'AYV', 'COL', 'CABK', 'AF', 'ANA', 'CEZ', 'BMW', 'BNP', 'CIE']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-10-02 22:29:18,674 ERROR ['CPFE3', 'ALO', 'BAS', 'AGUA', 'CAP', 'BHIA3', 'ALFAA', 'CNC.MI', 'ANTM', 'AMNB', 'CMIN3', 'CERN', 'AIXA', 'BP.LS', 'BAYN', 'BC8', 'ADS', 'BBSE3', 'CHK', 'AYDEN']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-10-02 22:29:18,674 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759437038. The requested range must be within the last 60 days.")')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-02 22:29:20,075 ERROR 
1 Failed downl
2025-10-02 22:31:19,095 INFO Stage fetch completado correctamente.
2025-10-02 22:31:19,096 INFO Stage=score attempt 1/2
2025-10-02 22:31:19,096 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-02 22:31:19,684 INFO Salida (2_score_select.py): returncode=0 (t=0.6s)
2025-10-02 22:31:19,684 WARNING stderr: 2025-10-02 22:31:19,574 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-02 22:31:19,583 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-10-02 22:31:19,593 INFO Hard filters: passed=8 rejected=1091 total=1099
2025-10-02 22:31:19,606 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-02 22:31:19,616 INFO Scoring computed. Score stats: min=28.15 median=41.09 max=49.72
2025-10-02 22:31:19,618 INFO Selected top 8 per sector -> 8 rows
2025-10-02 22:31:19,624 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-02 22:31:19,626 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-02 22:31:19,627 INFO SUMMARY: total_indicators=1099 passed=8 selected=8 rejected=1091
2025-10-02 22:31:19,627 INFO Sector=ENERGIA -> PSX, WEC, NFG
2025-10-02 22:31:19,628 INFO Sector=FINANCIERO -> JXN, YUM, MET
2025-10-02 22:31:19,628 INFO Sector=SALUD -> GHC, ADUS
2025-10-02 22:31:19,684 INFO Stage score completado correctamente.
2025-10-02 22:31:19,684 INFO Stage=export attempt 1/2
2025-10-02 22:31:19,684 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-02 22:31:34,877 INFO Salida (3_export_sheets.py): returncode=0 (t=15.2s)
2025-10-02 22:31:34,877 WARNING stderr: 2025-10-02 22:31:20,384 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-02 22:31:20,384 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-02 22:31:20,388 INFO export_sheets: Usando columna de sector: Sector
2025-10-02 22:31:20,388 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-02 22:31:22,110 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-02 22:31:22,111 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-02 22:31:24,279 INFO export_sheets: Ticker GHC omitido en 'SALUD' por duplicado reciente.
2025-10-02 22:31:24,279 INFO export_sheets: Ticker ADUS omitido en 'SALUD' por duplicado reciente.
2025-10-02 22:31:24,279 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-02 22:31:24,279 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-02 22:31:26,405 INFO export_sheets: Ticker PSX omitido en 'ENERGÍA' por duplicado reciente.
2025-10-02 22:31:26,406 INFO export_sheets: Ticker NFG omitido en 'ENERGÍA' por duplicado reciente.
2025-10-02 22:31:27,986 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A10:H10 (cols=8) filas=1 (tickers: WEC)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-02 22:31:28,834 INFO export_sheets: Hoja 'ENERGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-02 22:31:28,834 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-02 22:31:29,556 INFO export_sheets: No se encontraron candidatos para sheet 'COMMODITIES' (ni exact ni fuzzy).
2025-10-02 22:31:29,556 INFO export_sheets: No hay candidatos para sheet 'COMMODITIES'. Saltando.
2025-10-02 22:31:29,556 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-02 22:31:30,303 INFO export_sheets: No se encontraron candidatos para sheet 'TECNOLOGÍA' (ni exact ni fuzzy).
2025-10-02 22:31:30,303 INFO export_sheets: No hay candidatos para sheet 'TECNOLOGÍA'. Saltando.
2025-10-02 22:31:30,303 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-02 22:31:32,528 INFO export_sheets: Ticker JXN omitido en 'FINANCIERO' por duplicado reciente.
2025-10-02 22:31:32,528 INFO export_sheets: Ticker YUM omitido en 'FINANCIERO' por duplicado reciente.
2025-10-02 22:31:34,071 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A10:H10 (cols=8) filas=1 (tickers: MET)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-02 22:31:34,776 INFO export_sheets: Hoja 'FINANCIERO': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-02 22:31:34,777 INFO export_sheets: Export finalizado.
2025-10-02 22:31:34,877 INFO Stage export completado correctamente.
2025-10-02 22:31:34,877 INFO === RUN PIPELINE END 2025-10-02T20:31:34.877775 UTC (duración 144.8 s) ===
2025-10-02 22:31:35,268 INFO Resumen candidatos: total=8 (preview):
2025-10-02 22:31:35,272 INFO TICKER      PRECIO   ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
   PSX  134.940002 1.495356  135.483269  134.718069  131.727766 44.336892 47.617940        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.919480    ENERGIA
   WEC  112.029999 0.718850  112.893280  111.812823  109.891606 38.682114 44.498662        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.078812    ENERGIA
   NFG   91.714996 0.622216   92.193860   90.819837   88.590138 44.067692 48.742257        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.550499    ENERGIA
   JXN  101.330002 1.103220  101.372147  100.788358   97.647305 45.608771 49.644238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.724697 FINANCIERO
   YUM  151.360001 1.222497  152.124883  150.513641  148.552949 39.255468 48.523403        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.108073 FINANCIERO
   MET   81.330002 0.721278   81.662493   80.965927   79.894422 41.105740 49.328074        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.699119 FINANCIERO
   GHC 1159.425049 9.285357 1162.864840 1157.379703 1105.735233 19.572430 47.635827        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.127536      SALUD
  ADUS  115.410004 1.376352  116.148180  114.963883  113.553162 24.577934 46.780826        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.147557      SALUD
2025-10-03 09:49:19,268 INFO === RUN PIPELINE START 2025-10-03T07:49:19.268675 UTC ===
2025-10-03 09:49:19,268 INFO Stage=fetch attempt 1/2
2025-10-03 09:49:19,269 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-03 09:51:13,018 INFO Salida (1_fetch_indicators.py): returncode=0 (t=113.7s)
2025-10-03 09:51:13,018 WARNING stderr: 2025-10-03 09:49:20,000 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2025-10-03 09:49:20,011 INFO Batch 1/6: downloading 200 tickers (of 200)
2025-10-03 09:49:27,357 ERROR 
31 Failed downloads:
2025-10-03 09:49:27,358 ERROR ['COL', 'ACS', 'BMW', 'AF', 'BNP', 'ANA', 'AYV', 'CEZ', 'CABK', 'CIE']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2025-10-03 09:49:27,358 ERROR ['CAP', 'AGUA', 'ALO', 'BBSE3', 'ALFAA', 'CHK', 'CERN', 'BAYN', 'CPFE3', 'ANTM', 'BHIA3', 'AMNB', 'BP.LS', 'AIXA', 'ADS', 'CMIN3', 'CNC.MI', 'BC8', 'BAS', 'AYDEN']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2025-10-03 09:49:27,358 ERROR ['ARX']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "15m data not available for startTime=1753363800 and endTime=1759477845. The requested range must be within the last 60 days.")')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2025-10-03 09:49:28,741 ERROR 
1 Failed download:
2025-10-03 09:49:28,741 ERROR ['ACS']: YFP
2025-10-03 09:51:13,018 INFO Stage fetch completado correctamente.
2025-10-03 09:51:13,019 INFO Stage=score attempt 1/2
2025-10-03 09:51:13,019 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-03 09:51:13,781 INFO Salida (2_score_select.py): returncode=0 (t=0.8s)
2025-10-03 09:51:13,782 WARNING stderr: 2025-10-03 09:51:13,635 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-03 09:51:13,644 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-10-03 09:51:13,661 INFO Hard filters: passed=8 rejected=1091 total=1099
2025-10-03 09:51:13,677 INFO Wrote rejected sample to intermediate\rejected_sample.csv
2025-10-03 09:51:13,690 INFO Scoring computed. Score stats: min=28.15 median=41.09 max=49.72
2025-10-03 09:51:13,696 INFO Selected top 8 per sector -> 8 rows
2025-10-03 09:51:13,704 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-03 09:51:13,707 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-03 09:51:13,707 INFO SUMMARY: total_indicators=1099 passed=8 selected=8 rejected=1091
2025-10-03 09:51:13,708 INFO Sector=ENERGIA -> PSX, WEC, NFG
2025-10-03 09:51:13,708 INFO Sector=FINANCIERO -> JXN, YUM, MET
2025-10-03 09:51:13,708 INFO Sector=SALUD -> GHC, ADUS
2025-10-03 09:51:13,782 INFO Stage score completado correctamente.
2025-10-03 09:51:13,782 INFO Stage=export attempt 1/2
2025-10-03 09:51:13,782 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-03 09:51:28,358 INFO Salida (3_export_sheets.py): returncode=0 (t=14.6s)
2025-10-03 09:51:28,358 WARNING stderr: 2025-10-03 09:51:14,870 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-03 09:51:14,871 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-03 09:51:14,874 INFO export_sheets: Usando columna de sector: Sector
2025-10-03 09:51:14,875 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-03 09:51:16,553 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-03 09:51:16,553 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-03 09:51:18,677 INFO export_sheets: Ticker GHC omitido en 'SALUD' por duplicado reciente.
2025-10-03 09:51:18,677 INFO export_sheets: Ticker ADUS omitido en 'SALUD' por duplicado reciente.
2025-10-03 09:51:18,677 INFO export_sheets: No hay filas nuevas para añadir en 'SALUD' (tras filtrar duplicados).
2025-10-03 09:51:18,677 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-03 09:51:20,816 INFO export_sheets: Ticker PSX omitido en 'ENERGÍA' por duplicado reciente.
2025-10-03 09:51:20,816 INFO export_sheets: Ticker NFG omitido en 'ENERGÍA' por duplicado reciente.
2025-10-03 09:51:22,260 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A10:H10 (cols=8) filas=1 (tickers: WEC)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-03 09:51:23,034 INFO export_sheets: Hoja 'ENERGÍA': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-03 09:51:23,034 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-03 09:51:23,741 INFO export_sheets: No se encontraron candidatos para sheet 'COMMODITIES' (ni exact ni fuzzy).
2025-10-03 09:51:23,741 INFO export_sheets: No hay candidatos para sheet 'COMMODITIES'. Saltando.
2025-10-03 09:51:23,741 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-03 09:51:23,978 INFO export_sheets: No se encontraron candidatos para sheet 'TECNOLOGÍA' (ni exact ni fuzzy).
2025-10-03 09:51:23,978 INFO export_sheets: No hay candidatos para sheet 'TECNOLOGÍA'. Saltando.
2025-10-03 09:51:23,978 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2025-10-03 09:51:26,168 INFO export_sheets: Ticker JXN omitido en 'FINANCIERO' por duplicado reciente.
2025-10-03 09:51:26,168 INFO export_sheets: Ticker YUM omitido en 'FINANCIERO' por duplicado reciente.
2025-10-03 09:51:28,041 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A10:H10 (cols=8) filas=1 (tickers: MET)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-03 09:51:28,281 INFO export_sheets: Hoja 'FINANCIERO': escritas 1 filas correctamente (preservando columnas derecha).
2025-10-03 09:51:28,281 INFO export_sheets: Export finalizado.
2025-10-03 09:51:28,358 INFO Stage export completado correctamente.
2025-10-03 09:51:28,358 INFO === RUN PIPELINE END 2025-10-03T07:51:28.358393 UTC (duración 129.1 s) ===
2025-10-03 09:51:28,698 INFO Resumen candidatos: total=8 (preview):
2025-10-03 09:51:28,702 INFO TICKER      PRECIO   ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score     Sector
   PSX  134.940002 1.495356  135.483269  134.718069  131.727766 44.336892 47.617940        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 48.919480    ENERGIA
   WEC  112.029999 0.718850  112.893280  111.812823  109.891606 38.744292 44.498662        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.078812    ENERGIA
   NFG   91.714996 0.622216   92.193860   90.819837   88.590138 44.067692 48.742257        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.550499    ENERGIA
   JXN  101.330002 1.103220  101.372147  100.788358   97.647305 45.608771 49.644238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.724697 FINANCIERO
   YUM  151.360001 1.222497  152.124883  150.513641  148.552949 39.255468 48.523403        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.108073 FINANCIERO
   MET   81.330002 0.721278   81.662493   80.965927   79.894422 41.105740 49.328074        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 32.699119 FINANCIERO
   GHC 1159.425049 9.285357 1162.864840 1157.379703 1105.735233 19.572430 47.635827        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.127536      SALUD
  ADUS  115.410004 1.376352  116.148180  114.963883  113.553162 24.577934 46.780826        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.147557      SALUD
2025-10-03 10:02:49,238 INFO === RUN PIPELINE START 2025-10-03T08:02:49.238565 UTC ===
2025-10-03 10:02:49,238 INFO Stage=fetch attempt 1/2
2025-10-03 10:02:49,238 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2025-10-03 10:03:58,126 INFO Salida (1_fetch_indicators.py): returncode=0 (t=68.9s)
2025-10-03 10:03:58,127 WARNING stderr: 2025-10-03 10:02:49,897 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' i
2025-10-03 10:03:58,127 INFO Stage fetch completado correctamente.
2025-10-03 10:03:58,128 INFO Stage=score attempt 1/2
2025-10-03 10:03:58,128 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2025-10-03 10:03:58,628 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2025-10-03 10:03:58,628 WARNING stderr: 2025-10-03 10:03:58,527 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-10-03 10:03:58,535 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2025-10-03 10:03:58,550 INFO Hard filters (relaxed): total=1099 passed=48 rejected=1051 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok']
2025-10-03 10:03:58,551 INFO Optional failures distribution (fail_count:rows)={0: 21, 1: 66, 2: 123, 3: 602, 4: 135, 5: 99, 6: 53}
2025-10-03 10:03:58,563 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2025-10-03 10:03:58,571 INFO Scoring computed. Score stats: min=8.46 median=32.67 max=75.18
2025-10-03 10:03:58,573 INFO Selected top 5 per sector -> 25 rows
2025-10-03 10:03:58,573 INFO Selected 25 < min_target 40 -> rellenando con top global 15
2025-10-03 10:03:58,582 INFO Wrote selected csv: intermediate/candidates.csv
2025-10-03 10:03:58,585 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2025-10-03 10:03:58,585 INFO SUMMARY: total_indicators=1099 passed=48 selected=40 rejected=1051
2025-10-03 10:03:58,585 INFO Sector=COMMODITIES -> COOP, UNP, AGI, WAB, PKG, PCOR, HII, GM
2025-10-03 10:03:58,586 INFO Sector=ENERGIA -> PSX, XEL, WEC, NFG, PBF, MPC, WFRD, DTE
2025-10-03 10:03:58,586 INFO Sector=FINANCIERO -> LMND, JXN, STEP, TKO, YUM, RENT3.SA, GS, MET, JPM, BN, BCO, WELL
2025-10-03 10:03:58,586 INFO Sector=SALUD -> MDGL, GHC, ADUS, LH, EHC
2025-10-03 10:03:58,586 INFO Sector=TECNOLOGÍA -> QRVO, SWKS, DOCS, RBLX, TCOM, HSAI, UBER
2025-10-03 10:03:58,628 INFO Stage score completado correctamente.
2025-10-03 10:03:58,628 INFO Stage=export attempt 1/2
2025-10-03 10:03:58,628 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2025-10-03 10:04:18,597 INFO Salida (3_export_sheets.py): returncode=0 (t=20.0s)
2025-10-03 10:04:18,597 WARNING stderr: 2025-10-03 10:03:59,240 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2025-10-03 10:03:59,241 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2025-10-03 10:03:59,244 INFO export_sheets: Usando columna de sector: Sector
2025-10-03 10:03:59,245 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2025-10-03 10:04:00,889 INFO export_sheets: Spreadsheet abierto: Trades
2025-10-03 10:04:00,890 INFO export_sheets: Procesando hoja config: 'SALUD'
2025-10-03 10:04:02,587 INFO export_sheets: Ticker GHC omitido en 'SALUD' por duplicado reciente.
2025-10-03 10:04:02,587 INFO export_sheets: Ticker ADUS omitido en 'SALUD' por duplicado reciente.
2025-10-03 10:04:03,111 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A9:H11 (cols=8) filas=3 (tickers: MDGL, LH, EHC)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-03 10:04:03,816 INFO export_sheets: Hoja 'SALUD': escritas 3 filas correctamente (preservando columnas derecha).
2025-10-03 10:04:03,816 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2025-10-03 10:04:05,979 INFO export_sheets: Ticker PSX omitido en 'ENERGÍA' por duplicado reciente.
2025-10-03 10:04:05,979 INFO export_sheets: Ticker WEC omitido en 'ENERGÍA' por duplicado reciente.
2025-10-03 10:04:05,979 INFO export_sheets: Ticker NFG omitido en 'ENERGÍA' por duplicado reciente.
2025-10-03 10:04:07,446 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A11:H12 (cols=8) filas=2 (tickers: XEL, PBF)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-03 10:04:08,108 INFO export_sheets: Hoja 'ENERGÍA': escritas 2 filas correctamente (preservando columnas derecha).
2025-10-03 10:04:08,108 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2025-10-03 10:04:09,770 INFO export_sheets: Ticker COOP omitido en 'COMMODITIES' por duplicado reciente.
2025-10-03 10:04:11,159 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A8:H11 (cols=8) filas=4 (tickers: UNP, AGI, WAB, PKG)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-03 10:04:11,858 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2025-10-03 10:04:11,858 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2025-10-03 10:04:15,017 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A9:H13 (cols=8) filas=5 (tickers: QRVO, SWKS, DOCS, RBLX, TCOM)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2025-10-03 10:04:15,686 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2025-10-03 10:04:15,686 INFO export_sheets: Procesan
2025-10-03 10:04:18,597 INFO Stage export completado correctamente.
2025-10-03 10:04:18,598 INFO === RUN PIPELINE END 2025-10-03T08:04:18.598432 UTC (duración 89.4 s) ===
2025-10-03 10:04:18,933 INFO Resumen candidatos: total=40 (preview):
2025-10-03 10:04:18,939 INFO TICKER      PRECIO   ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector
  COOP  210.789993 5.446947  212.188163  212.859374  201.344573 20.268671 46.570281        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.509658 COMMODITIES
   UNP  234.550003 1.452132  234.563741  229.926094  225.893241 50.380499 57.216717        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.783324 COMMODITIES
   AGI   34.404999 0.652043   34.467127   33.671591   31.409288 38.607717 52.036412        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 46.528485 COMMODITIES
   WAB  197.830002 2.016908  198.480336  195.665053  194.855686 47.812633 51.622477        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 40.550240 COMMODITIES
   PKG  215.639999 1.581778  215.716382  214.801988  211.523290 51.775433 51.258306        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 35.525436 COMMODITIES
   PSX  134.940002 1.495356  135.483269  134.718069  131.727766 44.336892 47.617940        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.163910     ENERGIA
   XEL   79.589996 0.653929   79.696228   76.993604   74.266166 49.390599 60.055199        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 43.846002     ENERGIA
   WEC  112.029999 0.718850  112.893280  111.812823  109.891606 38.744292 44.498662        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.347607     ENERGIA
   NFG   91.714996 0.622216   92.193860   90.819837   88.590138 44.067692 48.742257        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 39.822326     ENERGIA
   PBF   30.120001 0.796357   30.398534   30.575314   28.609621 51.749602 43.933610        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.245823     ENERGIA
  LMND   53.299999 1.288428   53.348553   54.163083   52.653729 47.070216 47.726906        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.477680  FINANCIERO
   JXN  101.330002 1.103220  101.372147  100.788358   97.647305 45.608771 49.644238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 49.981432  FINANCIERO
  STEP   64.705002 0.951801   64.712965   64.533382   62.840195 62.016737 48.968524        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 45.880788  FINANCIERO
   TKO  197.990005 3.131132  199.247020  199.386333  192.901803 44.894216 45.584442        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.412065  FINANCIERO
   YUM  151.360001 1.222497  152.124883  150.513641  148.552949 39.255468 48.523403        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.361065  FINANCIERO
  MDGL  449.540009 7.872849  449.856016  441.036928  416.341654 51.725841 53.652692        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 75.177804       SALUD
   GHC 1159.425049 9.285357 1162.864840 1157.379703 1105.735233 19.572430 47.635827        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.127536       SALUD
  ADUS  115.410004 1.376352  116.148180  114.963883  113.553162 24.577934 46.780826        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 28.395721       SALUD
    LH  279.364990 2.520338  281.167840  279.989846  275.406172 48.473287 44.486256        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 25.962830       SALUD
   EHC  123.550003 0.988679  125.024825  125.354498  123.132648 42.658229 34.243461        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 10.630314       SALUD
2026-01-06 22:52:36,842 INFO === RUN PIPELINE START 2026-01-06T21:52:36.842557 UTC ===
2026-01-06 22:52:36,842 INFO Stage=fetch attempt 1/2
2026-01-06 22:52:36,843 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2026-01-06 22:55:40,927 INFO Salida (1_fetch_indicators.py): returncode=0 (t=184.1s)
2026-01-06 22:55:40,927 WARNING stderr: 2026-01-06 22:52:44,142 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2026-01-06 22:52:44,162 INFO Batch 1/6: downloading 200 tickers (of 200)
2026-01-06 22:52:47,717 ERROR HTTP Error 404: 
2026-01-06 22:52:53,562 ERROR 
32 Failed downloads:
2026-01-06 22:52:53,563 ERROR ['BAS', 'CMIN3', 'AIXA', 'CPFE3', 'BAYN', 'BP.LS', 'CAP', 'AGUA', 'AMNB', 'BBSE3', 'BC8', 'ALFAA', 'BHIA3', 'CNC.MI', 'ALO', 'AYDEN', 'COOP', 'CHK', 'AC', 'ADS', 'ANTM', 'CERN']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-01-06 22:52:53,563 ERROR ['AF', 'CABK', 'CEZ', 'BMW', 'AYV', 'BNP', 'ACS', 'ANA', 'COL', 'CIE']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-01-06 22:52:55,195 ERROR 
1 Failed download:
2026-01-06 22:52:55,195 ERROR ['AC']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-01-06 22:52:55,197 WARNING No data after 1h fallback for AC
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-01-06 22:52:55,354 ERROR 
1 Failed download:
2026-01-06 22:52:55,354 ERROR ['ACS']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2026-01-06 22:52:55,355 WARNING No data after 1
2026-01-06 22:55:40,928 INFO Stage fetch completado correctamente.
2026-01-06 22:55:40,928 INFO Stage=score attempt 1/2
2026-01-06 22:55:40,929 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-01-06 22:55:41,437 INFO Salida (2_score_select.py): returncode=1 (t=0.5s)
2026-01-06 22:55:41,437 WARNING stderr: 2026-01-06 22:55:41,349 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-01-06 22:55:41,357 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2026-01-06 22:55:41,368 INFO Hard filters (relaxed): total=1099 passed=91 rejected=1008 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-01-06 22:55:41,370 INFO Optional failures distribution (fail_count:rows)={0: 34, 1: 148, 2: 212, 3: 567, 4: 91, 5: 45, 6: 2}
2026-01-06 22:55:41,381 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-01-06 22:55:41,387 ERROR Error en scoring relajado: 'float' object has no attribute 'clip'
Traceback (most recent call last):
  File "A:\pilim\Downloads\Financiero\2_score_select.py", line 477, in main
    scored = compute_scores(passed, cfg)
  File "A:\pilim\Downloads\Financiero\2_score_select.py", line 351, in compute_scores
    score_at_cut = (1.0 - (abs(mfi_cut - mfi_peak) / max(mfi_span, 1e-9))).clip(0.0, 1.0)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'float' object has no attribute 'clip'
2026-01-06 22:55:41,437 WARNING Stage score fallo con code=1
2026-01-06 22:55:41,437 INFO Reintentando en 5s...
2026-01-06 22:55:46,437 INFO Stage=score attempt 2/2
2026-01-06 22:55:46,437 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-01-06 22:55:46,925 INFO Salida (2_score_select.py): returncode=1 (t=0.5s)
2026-01-06 22:55:46,926 WARNING stderr: 2026-01-06 22:55:46,842 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-01-06 22:55:46,850 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2026-01-06 22:55:46,861 INFO Hard filters (relaxed): total=1099 passed=91 rejected=1008 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-01-06 22:55:46,861 INFO Optional failures distribution (fail_count:rows)={0: 34, 1: 148, 2: 212, 3: 567, 4: 91, 5: 45, 6: 2}
2026-01-06 22:55:46,875 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-01-06 22:55:46,880 ERROR Error en scoring relajado: 'float' object has no attribute 'clip'
Traceback (most recent call last):
  File "A:\pilim\Downloads\Financiero\2_score_select.py", line 477, in main
    scored = compute_scores(passed, cfg)
  File "A:\pilim\Downloads\Financiero\2_score_select.py", line 351, in compute_scores
    score_at_cut = (1.0 - (abs(mfi_cut - mfi_peak) / max(mfi_span, 1e-9))).clip(0.0, 1.0)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'float' object has no attribute 'clip'
2026-01-06 22:55:46,926 WARNING Stage score fallo con code=1
2026-01-06 22:55:46,926 ERROR Stage=score falló después de 2 intentos.
2026-01-06 22:55:46,926 ERROR Pipeline abortado: Stage score failed after 2 attempts.
Traceback (most recent call last):
  File "A:\pilim\Downloads\Financiero\run_pipeline.py", line 137, in main
    run_stage("score", retries=args.retries, dry_run=args.dry_run, timeout=args.timeout, continue_on_error=args.continue_on_error)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "A:\pilim\Downloads\Financiero\run_pipeline.py", line 110, in run_stage
    raise RuntimeError(f"Stage {stage} failed after {retries+1} attempts.")
RuntimeError: Stage score failed after 2 attempts.
2026-01-06 22:55:46,929 INFO Revisa run_pipeline.log para más detalles.
2026-01-06 23:02:12,118 INFO === RUN PIPELINE START 2026-01-06T22:02:12.118856 UTC ===
2026-01-06 23:02:12,119 INFO Stage=fetch attempt 1/2
2026-01-06 23:02:12,119 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2026-01-06 23:03:40,927 INFO Salida (1_fetch_indicators.py): returncode=0 (t=88.8s)
2026-01-06 23:03:40,927 WARNING stderr: 2026-01-06 23:02:12,827 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' i
2026-01-06 23:03:40,927 INFO Stage fetch completado correctamente.
2026-01-06 23:03:40,928 INFO Stage=score attempt 1/2
2026-01-06 23:03:40,928 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-01-06 23:03:41,449 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2026-01-06 23:03:41,449 WARNING stderr: 2026-01-06 23:03:41,342 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-01-06 23:03:41,350 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1099)
2026-01-06 23:03:41,362 INFO Hard filters (relaxed): total=1099 passed=91 rejected=1008 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-01-06 23:03:41,362 INFO Optional failures distribution (fail_count:rows)={0: 34, 1: 148, 2: 212, 3: 567, 4: 91, 5: 45, 6: 2}
2026-01-06 23:03:41,375 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-01-06 23:03:41,386 INFO Scoring computed. Score stats: min=14.58 median=45.90 max=83.99
2026-01-06 23:03:41,390 INFO Selected top 5 per sector -> 25 rows
2026-01-06 23:03:41,390 INFO Selected 25 < min_target 40 -> rellenando con top global 15
2026-01-06 23:03:41,400 INFO Wrote selected csv: intermediate/candidates.csv
2026-01-06 23:03:41,403 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2026-01-06 23:03:41,403 INFO SUMMARY: total_indicators=1099 passed=91 selected=40 rejected=1008
2026-01-06 23:03:41,404 INFO Sector=COMMODITIES -> ASR, AIT, SPG, GWW, HEI.DE, CAP.PA, GLW, STLD
2026-01-06 23:03:41,404 INFO Sector=ENERGIA -> FSLR, COP, OXY, EIX, NWE
2026-01-06 23:03:41,404 INFO Sector=FINANCIERO -> EQR, TLN, LNW, PRI, MKL, MORN, MAA, RGA, MA, FRPT, TJX, RL, LOW, PB, WEX
2026-01-06 23:03:41,404 INFO Sector=SALUD -> LLY, GHC, JAZZ, USFD, REGN, MDGL, EW
2026-01-06 23:03:41,404 INFO Sector=TECNOLOGÍA -> PUB.PA, FIS, TWLO, OMC, GIB
2026-01-06 23:03:41,449 INFO Stage score completado correctamente.
2026-01-06 23:03:41,449 INFO Stage=export attempt 1/2
2026-01-06 23:03:41,449 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2026-01-06 23:04:05,283 INFO Salida (3_export_sheets.py): returncode=0 (t=23.8s)
2026-01-06 23:04:05,283 WARNING stderr: 2026-01-06 23:03:42,597 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2026-01-06 23:03:42,597 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2026-01-06 23:03:42,601 INFO export_sheets: Usando columna de sector: Sector
2026-01-06 23:03:42,602 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2026-01-06 23:03:44,351 INFO export_sheets: Spreadsheet abierto: Trades
2026-01-06 23:03:44,351 INFO export_sheets: Procesando hoja config: 'SALUD'
2026-01-06 23:03:48,097 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A12:H16 (cols=8) filas=5 (tickers: LLY, GHC, JAZZ, USFD, REGN)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-06 23:03:48,811 INFO export_sheets: Hoja 'SALUD': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-06 23:03:48,811 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2026-01-06 23:03:52,294 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A15:H19 (cols=8) filas=5 (tickers: FSLR, COP, OXY, EIX, NWE)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-06 23:03:52,981 INFO export_sheets: Hoja 'ENERGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-06 23:03:52,981 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2026-01-06 23:03:56,542 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A14:H18 (cols=8) filas=5 (tickers: ASR, AIT, SPG, GWW, HEI.DE)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-06 23:03:57,229 INFO export_sheets: Hoja 'COMMODITIES': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-06 23:03:57,229 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2026-01-06 23:04:00,753 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A13:H17 (cols=8) filas=5 (tickers: PUB.PA, FIS, TWLO, OMC, GIB)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-06 23:04:01,432 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-06 23:04:01,432 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2026-01-06 23:04:04,963 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A17:H21 (cols=8) filas=5 (tickers: EQR, TLN, LNW, PRI, MKL)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-06 23:04:05,193 INFO export_sheets: Hoja 
2026-01-06 23:04:05,283 INFO Stage export completado correctamente.
2026-01-06 23:04:05,284 INFO === RUN PIPELINE END 2026-01-06T22:04:05.284764 UTC (duración 113.2 s) ===
2026-01-06 23:04:05,652 INFO Resumen candidatos: total=40 (preview):
2026-01-06 23:04:05,662 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector  _sc_rsi_low  _sc_mfi_rsi_soft  _sc_macd_pos  _sc_ema15_close_gap  _sc_atr_score  _sc_ema150_distance  _sc_ema50_below  _sc_fib_soft  _sc_mfi_score  _sc_mfi_diff
   ASR  325.200012  3.742211  324.584480  322.487427  315.411655 41.927314 51.877648        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 67.452040 COMMODITIES     1.624470              15.0           0.0            10.736526       2.509492            10.000000             10.0      7.662713       7.265417      2.653422
   AIT  265.410004  3.593203  262.946326  261.757236  258.902318 41.000272 56.510113        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.248736 COMMODITIES     0.697977              15.0           5.0             0.000000       2.393601            10.000000             10.0      6.921445       8.099755      4.135957
   SPG  186.300003  1.420864  184.845777  185.106653  183.719418 44.401494 56.179221        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.063351 COMMODITIES     0.764156              15.0           5.0             0.000000       0.704083            10.000000             10.0      5.415730       5.038655      3.140727
   GWW 1029.020020  9.844256 1020.946953 1016.893463  995.439593 45.741064 57.392997        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.716930 COMMODITIES     0.521401              15.0           5.0             0.000000       7.255305            10.000000             10.0      0.000000       3.833043      3.107182
HEI.DE  222.800003  2.114286  222.122634  221.540681  217.783716 23.798716 53.215157        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 53.611515 COMMODITIES     1.356969               0.0           5.0             5.747931       1.243387            10.000000             10.0      0.000000      12.418844      7.844384
  FSLR  269.420013  5.648536  269.587239  267.459675  261.658173 35.612451 50.782745        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 83.990924     ENERGIA     1.843451              15.0           0.0            15.052635       3.992119            10.000000             10.0     11.108513      12.948794      4.045412
   COP   97.040001  1.508552   97.075629   94.829767   92.575061 48.051425 57.297073        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 66.595109     ENERGIA     0.540585              15.0           5.0            15.244249       0.772282            10.000000             10.0      5.818769       1.753717      2.465506
   OXY   41.700001  0.683395   41.503727   41.010673   41.204476 40.740705 54.990363        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.719798     ENERGIA     1.001927              15.0           0.0             6.809452       0.130523             6.250921             10.0      3.393701       8.333366      3.799909
   EIX   60.415001  0.673965   60.236700   59.903776   58.714496 46.684227 52.554008        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.748356     ENERGIA     1.489198              15.0           0.0             7.534231       0.123189            10.000000             10.0      3.052267       2.984196      1.565275
   NWE   64.970001  0.563171   64.583499   64.821896   64.763416 44.671513 55.160099        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 41.265848     ENERGIA     0.967980              15.0           5.0             0.000000       0.037020             2.668253             10.0      0.000000       4.795639      2.796956
   EQR   62.459999  0.580000   62.051455   62.113152   61.584187 36.714516 53.337478        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.771375  FINANCIERO     1.332504              15.0           0.0             0.000000       0.050109            10.000000             10.0      7.999036      11.956936      4.432790
   TLN  393.484985  7.941960  389.014778  381.485747  380.488192 45.569793 58.123368        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.186262  FINANCIERO     0.375326              15.0           5.0             0.000000       5.775810            10.000000             10.0      5.700320       3.987186      3.347620
   LNW   86.279999  2.996607   85.791451   80.584064   79.153250 52.360874 58.307221        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.829413  FINANCIERO     0.338556              15.0           0.0            10.782923       1.929604            10.000000             10.0      7.192637       0.000000      1.585692
   PRI  260.325012  2.969642  260.850632  259.877947  259.279284 37.158303 49.508196        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.715294  FINANCIERO     2.098361              15.0           0.0            10.336074       1.908632             2.521395             10.0      0.000000      11.557528      3.293305
   MKL 2133.219971 21.087960 2145.983894 2152.007561 2104.343046 37.965034 41.359511        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.464761  FINANCIERO     3.728098              15.0           0.0             0.000000      16.000000            10.000000              0.0      0.000000      10.831469      0.905194
   LLY 1063.949951 13.024048 1061.453090 1061.921900 1026.946851 46.911551 49.773987        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.181713       SALUD     2.045203              15.0           0.0             9.865229       9.728361            10.000000             10.0      0.000000       2.779604      0.763316
   GHC 1113.089966 12.384382 1107.753338 1104.845546 1089.935019 51.046183 54.771527        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.277015       SALUD     1.045695              15.0           5.0             2.210691       9.230866            10.000000             10.0      4.796338       0.000000      0.993425
  JAZZ  166.929993  2.689091  169.858388  169.727299  164.401508 37.176481 40.162442        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.043913       SALUD     3.967512              15.0           0.0             0.000000       1.690436             8.402749              0.0     10.645793      11.541167      0.796256
  USFD   76.860001  0.722143   76.042191   76.096919   75.709551 56.863343 59.230537        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.432001       SALUD     0.153893              15.0           5.0             0.000000       0.160659            10.000000             10.0     10.486197       0.000000      0.631252
  REGN  776.309998  8.028922  772.082391  767.367523  733.903434 34.590365 54.659034        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 51.131954       SALUD     1.068193               0.0           5.0             0.000000       5.843444            10.000000             10.0      0.000000      13.868671      5.351645
2026-01-22 16:44:23,104 INFO === RUN PIPELINE START 2026-01-22T15:44:23.104682 UTC ===
2026-01-22 16:44:23,105 INFO Stage=fetch attempt 1/2
2026-01-22 16:44:23,105 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2026-01-22 16:46:34,325 INFO Salida (1_fetch_indicators.py): returncode=0 (t=131.2s)
2026-01-22 16:46:34,325 WARNING stderr: 2026-01-22 16:44:24,043 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2026-01-22 16:44:24,060 INFO Batch 1/6: downloading 200 tickers (of 200)
2026-01-22 16:44:26,102 ERROR HTTP Error 404: 
2026-01-22 16:44:31,705 ERROR 
32 Failed downloads:
2026-01-22 16:44:31,706 ERROR ['CIE', 'BMW', 'AYV', 'CABK', 'BNP', 'ANA', 'ACS', 'COL', 'AF', 'CEZ']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2026-01-22 16:44:31,706 ERROR ['AIXA', 'CMIN3', 'CERN', 'CAP', 'BP.LS', 'AYDEN', 'ANTM', 'CNC.MI', 'AC', 'BHIA3', 'BAYN', 'CPFE3', 'BBSE3', 'COOP', 'BAS', 'ALO', 'CHK', 'ADS', 'AMNB', 'ALFAA', 'AGUA', 'BC8']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-01-22 16:44:33,349 ERROR 
1 Failed download:
2026-01-22 16:44:33,349 ERROR ['AC']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-01-22 16:44:33,351 WARNING No data after 1h fallback for AC
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-01-22 16:44:33,504 ERROR 
1 Failed download:
2026-01-22 16:44:33,504 ERROR ['ACS']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2026-01-22 16:44:33,505 WARNING No data after 1
2026-01-22 16:46:34,325 INFO Stage fetch completado correctamente.
2026-01-22 16:46:34,326 INFO Stage=score attempt 1/2
2026-01-22 16:46:34,327 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-01-22 16:46:34,875 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2026-01-22 16:46:34,875 WARNING stderr: 2026-01-22 16:46:34,759 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-01-22 16:46:34,766 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1098)
2026-01-22 16:46:34,777 INFO Hard filters (relaxed): total=1098 passed=182 rejected=916 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-01-22 16:46:34,779 INFO Optional failures distribution (fail_count:rows)={0: 47, 1: 222, 2: 243, 3: 443, 4: 121, 5: 20, 6: 2}
2026-01-22 16:46:34,792 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-01-22 16:46:34,804 INFO Scoring computed. Score stats: min=14.15 median=48.65 max=73.32
2026-01-22 16:46:34,807 INFO Selected top 5 per sector -> 25 rows
2026-01-22 16:46:34,807 INFO Selected 25 < min_target 40 -> rellenando con top global 15
2026-01-22 16:46:34,819 INFO Wrote selected csv: intermediate/candidates.csv
2026-01-22 16:46:34,823 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2026-01-22 16:46:34,823 INFO SUMMARY: total_indicators=1098 passed=182 selected=40 rejected=916
2026-01-22 16:46:34,824 INFO Sector=COMMODITIES -> PM, MTZ, AU, POWL, PKG, OTIS, SPSC, GD
2026-01-22 16:46:34,824 INFO Sector=ENERGIA -> DVN, PSX, PNW, CQP, PWR, MPLX, EIX, PSIX
2026-01-22 16:46:34,824 INFO Sector=FINANCIERO -> MTDR, PSA, SCI, STE, SARO, EXR, VOYA, MSI, UVV, W, SHAK, DG, AIZ, WH
2026-01-22 16:46:34,824 INFO Sector=SALUD -> REGN, MO, EXEL, BMY, HSY
2026-01-22 16:46:34,824 INFO Sector=TECNOLOGÍA -> KLAC, VRTS, ACLS, TSM, OMC
2026-01-22 16:46:34,875 INFO Stage score completado correctamente.
2026-01-22 16:46:34,875 INFO Stage=export attempt 1/2
2026-01-22 16:46:34,876 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2026-01-22 16:46:52,439 INFO Salida (3_export_sheets.py): returncode=0 (t=17.6s)
2026-01-22 16:46:52,440 WARNING stderr: 2026-01-22 16:46:35,766 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2026-01-22 16:46:35,766 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2026-01-22 16:46:35,771 INFO export_sheets: Usando columna de sector: Sector
2026-01-22 16:46:35,771 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2026-01-22 16:46:37,670 INFO export_sheets: Spreadsheet abierto: Trades
2026-01-22 16:46:37,670 INFO export_sheets: Procesando hoja config: 'SALUD'
2026-01-22 16:46:40,939 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A16:H20 (cols=8) filas=5 (tickers: REGN, MO, EXEL, BMY, HSY)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-22 16:46:41,231 INFO export_sheets: Hoja 'SALUD': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-22 16:46:41,231 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2026-01-22 16:46:43,421 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A10:H14 (cols=8) filas=5 (tickers: DVN, PSX, PNW, CQP, PWR)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-22 16:46:44,138 INFO export_sheets: Hoja 'ENERGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-22 16:46:44,138 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2026-01-22 16:46:47,353 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A15:H19 (cols=8) filas=5 (tickers: PM, MTZ, AU, POWL, PKG)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-22 16:46:47,576 INFO export_sheets: Hoja 'COMMODITIES': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-22 16:46:47,576 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2026-01-22 16:46:49,760 INFO export_sheets: Ticker VRTS omitido en 'TECNOLOGÍA' por duplicado reciente.
2026-01-22 16:46:50,240 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A17:H20 (cols=8) filas=4 (tickers: KLAC, ACLS, TSM, OMC)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-22 16:46:50,466 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2026-01-22 16:46:50,466 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2026-01-22 16:46:51,667 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A22:H26 (cols=8) filas=5 (tickers: MTDR, PSA, SCI, STE, SARO)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("ap
2026-01-22 16:46:52,440 INFO Stage export completado correctamente.
2026-01-22 16:46:52,440 INFO === RUN PIPELINE END 2026-01-22T15:46:52.440906 UTC (duración 149.3 s) ===
2026-01-22 16:46:52,797 INFO Resumen candidatos: total=40 (preview):
2026-01-22 16:46:52,808 INFO TICKER     PRECIO    ATR 2H     EMA 15     EMA 50    EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector  _sc_rsi_low  _sc_mfi_rsi_soft  _sc_macd_pos  _sc_ema15_close_gap  _sc_atr_score  _sc_ema150_distance  _sc_ema50_below  _sc_fib_soft  _sc_mfi_score  _sc_mfi_diff
    PM 168.550003  2.142043 168.510790 165.797328 160.667153 40.155551 52.478869        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 72.098846 COMMODITIES     1.504226              15.0           0.0            15.414198       0.869389                 10.0             10.0      7.164811       8.860004      3.286218
   MTZ 240.000000  5.142929 240.167771 233.072902 224.320413 37.644902 55.210378        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.122511 COMMODITIES     0.957924              15.0           0.0            14.956104       2.459663                 10.0             10.0      1.945104      11.119588      4.684127
    AU 101.970001  2.534915 101.829201  97.155814  89.434966 35.662061 56.488920        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 69.460362 COMMODITIES     0.702216              15.0           0.0            14.222586       1.077585                 10.0             10.0      0.000000      12.904146      5.553829
  POWL 419.350006 14.667014 419.902834 394.095223 365.872446 47.273351 55.889096        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 68.543176 COMMODITIES     0.822181              15.0           0.0            14.793859       7.506810                 10.0             10.0      5.668810       2.453984      2.297532
   PKG 220.050003  2.310713 219.609884 216.500839 209.936702 35.675310 54.731108        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 64.891308 COMMODITIES     1.053778              15.0           0.0             9.904989       0.958773                 10.0             10.0      0.000000      12.892221      5.081546
   DVN  37.000000  0.636122  37.043324  36.691442  36.267321 44.913945 51.269296        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 72.683532     ENERGIA     1.746141              15.0           5.0            13.820619       0.071348                 10.0             10.0     10.773214       4.577450      1.694760
   PSX 140.875000  1.753164 140.367737 138.833657 136.961794 40.086405 53.699097        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.984439     ENERGIA     1.260181              15.0           5.0             6.741074       0.663308                 10.0             10.0     10.767590       8.922235      3.630051
   PNW  92.769997  0.760715  92.876848  91.287725  89.863223 42.421416 55.364339        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.030778     ENERGIA     0.927132              15.0           0.0            11.505216       0.137375                 10.0             10.0      7.188882       6.820726      3.451446
   CQP  56.500000  0.649100  56.436938  55.214509  54.246954 43.795237 57.692556        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.001657     ENERGIA     0.461489              15.0           0.0            12.891099       0.078226                 10.0             10.0      3.280605       5.584287      3.705952
   PWR 461.380005 10.003215 462.771580 448.462502 442.932446 52.458102 54.643963        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.264459     ENERGIA     1.071207              15.0           0.0            11.548392       5.035299                 10.0             10.0      7.026664       0.000000      0.582896
  MTDR  43.356998  0.701071  43.436239  42.854710  42.341752 35.632543 51.603727        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 73.319296  FINANCIERO     1.679255              15.0           0.0            12.383125       0.105767                 10.0             10.0      6.961456      12.930711      4.258982
   PSA 288.700012  2.941164 287.970594 280.769559 275.374426 36.771122 58.683418        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 67.151574  FINANCIERO     0.263316              15.0           0.0             8.063902       1.292871                 10.0             10.0      4.782216      11.905990      5.843279
   SCI  81.949997  0.885935  81.897130  80.759436  79.719693 45.152765 53.759066        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 67.021539  FINANCIERO     1.248187              15.0           0.0            14.090450       0.203733                 10.0             10.0      9.821644       4.362511      2.295013
   STE 262.970001  2.664991 262.867415 261.204493 257.945758 32.537385 51.105754        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 66.395145  FINANCIERO     1.778849               0.0           0.0            14.768188       1.146517                 10.0             10.0      8.033672      15.716353      4.951565
  SARO  32.130001  0.605357  32.125241  31.428423  29.630559 42.997575 52.599025        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.645324  FINANCIERO     1.480195              15.0           0.0            15.748401       0.055045                 10.0             10.0      4.499114       6.302182      2.560386
  REGN 757.489990  9.871682 744.633698 757.220638 745.620555 35.688186 56.867915        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 70.272496       SALUD     0.626417              15.0           5.0             0.000000       4.965596                 10.0             10.0      6.151923      12.880633      5.647928
    MO  61.180000  0.548922  61.095942  59.708130  59.010309 39.845306 58.523034        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.540211       SALUD     0.295393              15.0           0.0            11.099728       0.025138                 10.0             10.0      0.000000       9.139225      4.980728
  EXEL  44.790001  0.711600  44.501247  44.408313  43.639764 29.074406 53.711490        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.286601       SALUD     1.257702               0.0           5.0             3.014987       0.111347                 10.0             10.0      6.165710      17.166966      6.569889
   BMY  55.136600  0.629564  54.909070  55.110863  53.138815 36.028601 49.663014        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.780257       SALUD     2.067397              15.0           0.0             4.434884       0.067873                 10.0             10.0      0.000000      12.574259      3.635843
   HSY 195.339996  2.150919 196.912141 193.050560 187.301888 37.201919 48.437406        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 52.701015       SALUD     2.312519              15.0           0.0             0.000000       0.874093                 10.0             10.0      0.000000      11.518273      2.996130
2026-01-30 19:24:30,218 INFO === RUN PIPELINE START 2026-01-30T18:24:30.218751 UTC ===
2026-01-30 19:24:30,219 INFO Stage=fetch attempt 1/2
2026-01-30 19:24:30,219 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2026-01-30 19:26:33,053 INFO Salida (1_fetch_indicators.py): returncode=0 (t=122.8s)
2026-01-30 19:26:33,053 WARNING stderr: 2026-01-30 19:24:31,047 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2026-01-30 19:24:31,064 INFO Batch 1/6: downloading 200 tickers (of 200)
2026-01-30 19:24:33,153 ERROR HTTP Error 404: 
2026-01-30 19:24:33,639 ERROR HTTP Error 404: 
2026-01-30 19:24:38,802 ERROR 
32 Failed downloads:
2026-01-30 19:24:38,802 ERROR ['ACS', 'CEZ', 'BMW', 'ANA', 'AYV', 'AF', 'CABK', 'CIE', 'BNP', 'COL']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2026-01-30 19:24:38,802 ERROR ['AC', 'AMNB', 'CNC.MI', 'BC8', 'BAS', 'AIXA', 'BHIA3', 'ANTM', 'AYDEN', 'COOP', 'CAP', 'BAYN', 'ADS', 'BP.LS', 'CMIN3', 'BBSE3', 'ALO', 'CPFE3', 'CHK', 'AGUA', 'CERN', 'ALFAA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-01-30 19:24:40,382 ERROR 
1 Failed download:
2026-01-30 19:24:40,382 ERROR ['AC']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-01-30 19:24:40,384 WARNING No data after 1h fallback for AC
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-01-30 19:24:40,520 ERROR 
1 Failed download:
2026-01-30 19:24:40,520 ERROR ['ACS']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')

2026-01-30 19:26:33,053 INFO Stage fetch completado correctamente.
2026-01-30 19:26:33,054 INFO Stage=score attempt 1/2
2026-01-30 19:26:33,054 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-01-30 19:26:33,591 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2026-01-30 19:26:33,591 WARNING stderr: 2026-01-30 19:26:33,471 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-01-30 19:26:33,479 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1096)
2026-01-30 19:26:33,490 INFO Hard filters (relaxed): total=1096 passed=190 rejected=906 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-01-30 19:26:33,492 INFO Optional failures distribution (fail_count:rows)={0: 116, 1: 288, 2: 112, 3: 492, 4: 74, 5: 13, 6: 1}
2026-01-30 19:26:33,503 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-01-30 19:26:33,515 INFO Scoring computed. Score stats: min=8.42 median=44.20 max=80.82
2026-01-30 19:26:33,517 INFO Selected top 5 per sector -> 25 rows
2026-01-30 19:26:33,517 INFO Selected 25 < min_target 40 -> rellenando con top global 15
2026-01-30 19:26:33,529 INFO Wrote selected csv: intermediate/candidates.csv
2026-01-30 19:26:33,535 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2026-01-30 19:26:33,535 INFO SUMMARY: total_indicators=1096 passed=190 selected=40 rejected=906
2026-01-30 19:26:33,536 INFO Sector=COMMODITIES -> PH, SU.PA, HXL, GLW, STLD, UNP, NUE
2026-01-30 19:26:33,536 INFO Sector=ENERGIA -> NE, DVN, OXY, WEC, OKE, EOG, VAL, SHEL, AEP
2026-01-30 19:26:33,536 INFO Sector=FINANCIERO -> WSO, STE, VOYA, PNC, MAR, COR, EQR, DBK.DE, WPC, NTRS, PEN, IOSP, STT
2026-01-30 19:26:33,537 INFO Sector=SALUD -> MDLZ, GHC, HSY, VRTX, MNST
2026-01-30 19:26:33,537 INFO Sector=TECNOLOGÍA -> ASML.AS, SIE.DE, WDC, GOOG, FTNT, BABA
2026-01-30 19:26:33,591 INFO Stage score completado correctamente.
2026-01-30 19:26:33,591 INFO Stage=export attempt 1/2
2026-01-30 19:26:33,591 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2026-01-30 19:26:43,634 INFO Salida (3_export_sheets.py): returncode=0 (t=10.0s)
2026-01-30 19:26:43,635 WARNING stderr: 2026-01-30 19:26:34,365 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2026-01-30 19:26:34,366 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2026-01-30 19:26:34,370 INFO export_sheets: Usando columna de sector: Sector
2026-01-30 19:26:34,371 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2026-01-30 19:26:35,524 INFO export_sheets: Spreadsheet abierto: Trades
2026-01-30 19:26:35,524 INFO export_sheets: Procesando hoja config: 'SALUD'
2026-01-30 19:26:36,296 INFO export_sheets: Ticker HSY omitido en 'SALUD' por duplicado reciente.
2026-01-30 19:26:36,816 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A19:H22 (cols=8) filas=4 (tickers: MDLZ, GHC, VRTX, MNST)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-30 19:26:37,098 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente (preservando columnas derecha).
2026-01-30 19:26:37,098 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2026-01-30 19:26:37,833 INFO export_sheets: Ticker OXY omitido en 'ENERGÍA' por duplicado reciente.
2026-01-30 19:26:38,321 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A20:H23 (cols=8) filas=4 (tickers: NE, DVN, WEC, OKE)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-30 19:26:38,547 INFO export_sheets: Hoja 'ENERGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2026-01-30 19:26:38,547 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2026-01-30 19:26:39,807 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A16:H20 (cols=8) filas=5 (tickers: PH, SU.PA, HXL, GLW, STLD)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-30 19:26:40,040 INFO export_sheets: Hoja 'COMMODITIES': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-30 19:26:40,040 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2026-01-30 19:26:41,790 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A21:H25 (cols=8) filas=5 (tickers: ASML.AS, SIE.DE, WDC, GOOG, FTNT)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-01-30 19:26:42,015 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-01-30 19:26:42,015 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2026-01-30 19:26:43,280 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A26:H30 (cols=8) filas=5 (tickers: WSO, STE, VOYA, PNC, MAR)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named argume
2026-01-30 19:26:43,635 INFO Stage export completado correctamente.
2026-01-30 19:26:43,636 INFO === RUN PIPELINE END 2026-01-30T18:26:43.636734 UTC (duración 133.4 s) ===
2026-01-30 19:26:44,055 INFO Resumen candidatos: total=40 (preview):
2026-01-30 19:26:44,068 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector  _sc_rsi_low  _sc_mfi_rsi_soft  _sc_macd_pos  _sc_ema15_close_gap  _sc_atr_score  _sc_ema150_distance  _sc_ema50_below  _sc_fib_soft  _sc_mfi_score  _sc_mfi_diff
    PH  931.554993 11.873156  935.118121  931.150745  904.911660 40.462149 47.907531        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 73.105100 COMMODITIES     2.418494              15.0           5.0             6.396817       6.470111                 10.0             10.0      7.250178       8.584066      1.985435
 SU.PA  240.649994  2.910715  239.899658  235.773202  234.912040 39.220008 58.683434        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 72.110818 COMMODITIES     0.263313              15.0           5.0             7.750916       1.368235                 10.0             10.0      7.836114       9.701993      5.190247
   HXL   82.419998  1.828250   82.904277   82.120952   79.057996 43.618650 48.464011        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 67.290987 COMMODITIES     2.307198              15.0           5.0             7.523637       0.752041                 10.0             10.0      9.672800       5.743215      1.292096
   GLW  104.190002  2.671674  103.193451   98.007083   92.323514 30.354340 57.932756        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.354663 COMMODITIES     0.413449               0.0           0.0             4.063793       1.232161                 10.0             10.0     11.609923      17.681094      7.354244
  STLD  178.865005  2.828694  178.312819  176.214269  172.110296 53.876507 54.374194        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.686014 COMMODITIES     1.125161              15.0           5.0             9.753312       1.321544                 10.0             10.0      8.353280       0.000000      0.132717
    NE   35.299999  0.752857   35.256579   33.860358   31.800471 26.763918 55.923311        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.935078     ENERGIA     0.815338               0.0           0.0            14.154447       0.139873                 10.0             10.0      4.962056      15.087527      7.775838
   DVN   39.424999  0.658215   39.527667   38.371095   37.087692 46.943753 55.560580        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.501731     ENERGIA     0.887884              15.0           0.0            11.008670       0.085998                 10.0             10.0     10.470736       2.750622      2.297820
   OXY   44.584999  0.658285   44.784049   43.879453   42.580106 43.169391 52.106976        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.339944     ENERGIA     1.578605              15.0           0.0             6.323961       0.086038                 10.0             10.0      9.820436       6.147548      2.383356
   WEC  109.714996  0.847072  109.915146  108.938017  107.889409 43.856098 50.534841        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 61.249046     ENERGIA     1.893032              15.0           0.0             8.438889       0.193504                 10.0             10.0      8.413110       5.529512      1.780998
   OKE   77.630096  1.031500   78.306249   76.781901   74.294120 38.796881 48.686715        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.575226     ENERGIA     2.262657              15.0           0.0             0.000000       0.298491                 10.0             10.0     10.293983      10.082807      2.637289
   WSO  381.769989  6.931061  383.089924  379.276074  366.353795 37.790125 48.524459        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.133065  FINANCIERO     2.295108              15.0           0.0             9.905997       3.656820                 10.0             10.0      6.423764      10.988887      2.862489
   STE  261.549988  2.330935  261.119099  261.202866  258.862890 43.624383 50.603480        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.701079  FINANCIERO     1.879304              15.0           5.0            10.084583       1.038195                 10.0             10.0      5.099849       5.738055      1.861093
  VOYA   76.260002  0.733820   76.095649   76.144004   75.390798 46.052571 51.800158        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.691893  FINANCIERO     1.639968              15.0           5.0             8.832989       0.129036                 10.0             10.0     10.004523       3.552686      1.532690
   PNC  222.554993  1.901794  222.456379  220.600105  213.196350 45.600547 52.679034        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.445907  FINANCIERO     1.464193              15.0           5.0            14.340704       0.793906                 10.0             10.0      0.000000       3.959507      1.887596
   MAR  315.984985  2.949777  316.281694  317.551876  311.963088 46.818070 47.635071        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.930004  FINANCIERO     2.472986              15.0           5.0            12.781221       1.390471                 10.0              0.0     11.203722       2.863737      0.217867
  MDLZ   57.945000  0.688571   57.928262   57.366281   56.183782 42.507339 51.067487        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.557516       SALUD     1.786503              15.0           0.0            15.222168       0.103278                 10.0             10.0     10.419467       6.743395      2.282706
   GHC 1155.959961 11.385289 1153.485732 1152.630035 1128.254595 47.700420 50.337085        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.577748       SALUD     1.932583              15.0           0.0             9.045823       6.192392                 10.0             10.0      5.634218       2.069622      0.703111
   HSY  192.550003  2.027430  192.143059  192.114356  187.922023 49.994464 50.692107        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.663511       SALUD     1.861579              15.0           5.0             9.576994       0.865424                 10.0             10.0      5.168494       0.004982      0.186038
  VRTX  469.700012  5.231421  473.428227  466.890203  457.047564 46.527045 48.236383        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.835497       SALUD     2.352723              15.0           0.0             0.000000       2.689299                 10.0             10.0     11.211991       3.125660      0.455824
  MNST   80.120003  0.568821   80.527821   80.005585   77.452914 38.987696 45.026397        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 54.746089       SALUD     2.994721              15.0           0.0             0.000000       0.035110                 10.0             10.0      5.194864       9.911073      1.610320
2026-02-06 18:18:09,229 INFO === RUN PIPELINE START 2026-02-06T17:18:09.229366 UTC ===
2026-02-06 18:18:09,229 INFO Stage=fetch attempt 1/2
2026-02-06 18:18:09,230 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2026-02-06 18:20:09,508 INFO Salida (1_fetch_indicators.py): returncode=0 (t=120.3s)
2026-02-06 18:20:09,508 WARNING stderr: 2026-02-06 18:18:10,774 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2026-02-06 18:18:10,792 INFO Batch 1/6: downloading 200 tickers (of 200)
2026-02-06 18:18:18,771 ERROR 
32 Failed downloads:
2026-02-06 18:18:18,771 ERROR ['BAYN', 'ADS', 'BP.LS', 'CMIN3', 'AC', 'CHK', 'AIXA', 'ALO', 'CNC.MI', 'BBSE3', 'CERN', 'COOP', 'BHIA3', 'CAP', 'CPFE3', 'AMNB', 'AYDEN', 'AGUA', 'BAS', 'BC8', 'ALFAA', 'ANTM']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-02-06 18:18:18,771 ERROR ['ACS', 'CIE', 'CEZ', 'COL', 'BNP', 'ANA', 'CABK', 'AYV', 'AF', 'BMW']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-02-06 18:18:20,194 ERROR 
1 Failed download:
2026-02-06 18:18:20,194 ERROR ['AC']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-02-06 18:18:20,195 WARNING No data after 1h fallback for AC
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-02-06 18:18:20,344 ERROR 
1 Failed download:
2026-02-06 18:18:20,344 ERROR ['ACS']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2026-02-06 18:18:20,345 WARNING No data after 1h fallback for ACS
A:\pilim\Downloads\Financier
2026-02-06 18:20:09,508 INFO Stage fetch completado correctamente.
2026-02-06 18:20:09,509 INFO Stage=score attempt 1/2
2026-02-06 18:20:09,509 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-02-06 18:20:10,062 INFO Salida (2_score_select.py): returncode=0 (t=0.6s)
2026-02-06 18:20:10,062 WARNING stderr: 2026-02-06 18:20:09,951 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-02-06 18:20:09,959 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1095)
2026-02-06 18:20:09,971 INFO Hard filters (relaxed): total=1095 passed=130 rejected=965 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-02-06 18:20:09,971 INFO Optional failures distribution (fail_count:rows)={0: 38, 1: 158, 2: 202, 3: 570, 4: 108, 5: 19}
2026-02-06 18:20:09,984 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-02-06 18:20:09,995 INFO Scoring computed. Score stats: min=16.40 median=52.10 max=75.03
2026-02-06 18:20:09,998 INFO Selected top 5 per sector -> 25 rows
2026-02-06 18:20:09,998 INFO Selected 25 < min_target 40 -> rellenando con top global 15
2026-02-06 18:20:10,008 INFO Wrote selected csv: intermediate/candidates.csv
2026-02-06 18:20:10,011 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2026-02-06 18:20:10,011 INFO SUMMARY: total_indicators=1095 passed=130 selected=40 rejected=965
2026-02-06 18:20:10,012 INFO Sector=COMMODITIES -> CBT, PHM, ADM, STX, CW, HII, TOL, BG, BAS.DE, AA, FLR, KNX, OR.PA
2026-02-06 18:20:10,012 INFO Sector=ENERGIA -> DTE, ED, D, SU, LNT
2026-02-06 18:20:10,012 INFO Sector=FINANCIERO -> PLAY, BNR, LTH, IBKR, COR, LTM, VSH, REG, CBRE
2026-02-06 18:20:10,012 INFO Sector=SALUD -> PCVX, VRTX, GHC, ICUI, TEVA
2026-02-06 18:20:10,012 INFO Sector=TECNOLOGÍA -> LRCX, MU, VICR, ADI, RHI, VRT, TECH, NOVT
2026-02-06 18:20:10,062 INFO Stage score completado correctamente.
2026-02-06 18:20:10,062 INFO Stage=export attempt 1/2
2026-02-06 18:20:10,063 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2026-02-06 18:20:27,446 INFO Salida (3_export_sheets.py): returncode=0 (t=17.4s)
2026-02-06 18:20:27,446 WARNING stderr: 2026-02-06 18:20:11,113 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2026-02-06 18:20:11,114 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2026-02-06 18:20:11,119 INFO export_sheets: Usando columna de sector: Sector
2026-02-06 18:20:11,120 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2026-02-06 18:20:12,807 INFO export_sheets: Spreadsheet abierto: Trades
2026-02-06 18:20:12,807 INFO export_sheets: Procesando hoja config: 'SALUD'
2026-02-06 18:20:13,984 INFO export_sheets: Ticker VRTX omitido en 'SALUD' por duplicado reciente.
2026-02-06 18:20:14,937 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A21:H24 (cols=8) filas=4 (tickers: PCVX, GHC, ICUI, TEVA)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-06 18:20:15,688 INFO export_sheets: Hoja 'SALUD': escritas 4 filas correctamente (preservando columnas derecha).
2026-02-06 18:20:15,688 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2026-02-06 18:20:19,217 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A10:H14 (cols=8) filas=5 (tickers: DTE, ED, D, SU, LNT)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-06 18:20:19,458 INFO export_sheets: Hoja 'ENERGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-02-06 18:20:19,458 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2026-02-06 18:20:21,542 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A15:H19 (cols=8) filas=5 (tickers: CBT, PHM, ADM, STX, CW)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-06 18:20:22,277 INFO export_sheets: Hoja 'COMMODITIES': escritas 5 filas correctamente (preservando columnas derecha).
2026-02-06 18:20:22,277 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2026-02-06 18:20:24,362 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A20:H24 (cols=8) filas=5 (tickers: LRCX, MU, VICR, ADI, RHI)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-06 18:20:24,584 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-02-06 18:20:24,584 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2026-02-06 18:20:27,146 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A27:H31 (cols=8) filas=5 (tickers: PLAY, BNR, LTH, IBKR, COR)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_val
2026-02-06 18:20:27,446 INFO Stage export completado correctamente.
2026-02-06 18:20:27,447 INFO === RUN PIPELINE END 2026-02-06T17:20:27.447136 UTC (duración 138.2 s) ===
2026-02-06 18:20:27,792 INFO Resumen candidatos: total=40 (preview):
2026-02-06 18:20:27,802 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector  _sc_rsi_low  _sc_mfi_rsi_soft  _sc_macd_pos  _sc_ema15_close_gap  _sc_atr_score  _sc_ema150_distance  _sc_ema50_below  _sc_fib_soft  _sc_mfi_score  _sc_mfi_diff
   CBT   75.139999  2.248214   75.610823   73.647938   70.574893 36.321751 51.575036        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.843519 COMMODITIES     1.684993              15.0           0.0             9.298520       1.652771            10.000000             10.0      7.829269      12.310424      4.067543
   PHM  132.550003  3.013929  132.577320  129.315884  126.354324 51.834333 55.115174        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 70.740494 COMMODITIES     0.976965              15.0           5.0            15.709966       2.386056            10.000000             10.0     10.792616       0.000000      0.874891
   ADM   66.732498  1.486164   66.596044   66.421065   63.690609 44.156547 49.847918        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 68.010925 COMMODITIES     2.030416              15.0           0.0            13.061886       0.922995            10.000000             10.0     10.218821       5.259108      1.517699
   STX  425.445007 17.229943  417.161409  397.323009  347.805322 42.897809 55.343421        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 64.569458 COMMODITIES     0.931316              15.0           0.0             0.615436      16.000000            10.000000             10.0      2.311904       6.391972      3.318830
    CW  652.500000 16.553576  640.686789  644.710179  618.321780 49.966931 53.364082        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 63.356466 COMMODITIES     1.327184              15.0           0.0             0.000000      15.352278            10.000000             10.0     10.741336       0.029763      0.905907
   DTE  135.634995  1.590492  135.725444  135.063314  133.771328 30.417554 50.582200        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 75.031892     ENERGIA     1.883560               0.0           5.0            14.180202       1.022905            10.000000             10.0      9.943784      17.624202      5.377239
    ED  107.800003  1.215348  107.983246  105.979957  102.879639 43.035589 54.246587        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.575172     ENERGIA     1.150683              15.0           0.0            11.175244       0.663649            10.000000             10.0      5.328028       6.267970      2.989599
     D   62.048801  0.655229   61.940607   61.032043   60.239984 53.754658 57.573692        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.494438     ENERGIA     0.485262              15.0           5.0            10.715992       0.127251            10.000000             10.0      7.147524       0.000000      1.018409
    SU   53.345001  0.838750   53.243232   52.047700   48.877433 43.662697 54.832793        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.135997     ENERGIA     1.033441              15.0           0.0            12.117291       0.303000            10.000000             10.0      0.000000       5.703573      2.978692
   LNT   66.510002  0.591787   66.564561   66.444570   66.320564 41.830884 50.259030        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 56.865331     ENERGIA     1.948194              15.0           5.0            13.049819       0.066496             2.201112             10.0      0.000000       7.352204      2.247505
  PLAY   19.379999  0.555757   19.372272   19.324111   18.396788 40.822489 49.643409        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 72.289822  FINANCIERO     2.071318              15.0           0.0            15.555056       0.031992            10.000000             10.0      9.019449       8.259760      2.352245
   BNR   32.990002  1.963928   33.059609   32.696329   27.153718 41.697559 48.338611        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.546315  FINANCIERO     2.332278              15.0           0.0            14.865833       1.380525            10.000000             10.0      8.724535       7.472197      1.770947
   LTH   29.400000  0.532143   29.343762   29.016915   27.962185 45.175598 51.293751        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 67.026612  FINANCIERO     1.741250              15.0           0.0            12.618167       0.009378            10.000000             10.0     11.684347       4.341962      1.631508
  IBKR   74.019997  1.840072   72.899557   73.772296   71.519602 35.331045 51.534531        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.536706  FINANCIERO     1.693094              15.0           0.0             0.000000       1.261914            10.000000             10.0     10.058710      13.202059      4.320930
   COR  357.730011  8.004283  352.614784  352.376545  350.457571 35.080240 54.347320        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 64.946954  FINANCIERO     1.130536              15.0           5.0             0.000000       7.165061             8.085685             10.0      0.000000      13.427784      5.137888
  PCVX   55.314999  1.539543   54.857779   53.273618   49.932418 36.557987 54.869367        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 71.005270       SALUD     1.026127              15.0           0.0             6.496504       0.974113            10.000000             10.0     10.527680      12.097812      4.883035
  VRTX  470.859985  6.379434  468.339455  467.837897  459.791751 39.027552 52.212591        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 69.262582       SALUD     1.557482              15.0           0.0             3.356721       5.609027            10.000000             10.0     10.348139       9.875203      3.516010
   GHC 1187.079956 15.879979 1175.853809 1165.448680 1141.091710 57.329023 58.882488        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.905228       SALUD     0.223502              15.0           5.0             0.000000      14.707208            10.000000             10.0     10.560260       0.000000      0.414257
  ICUI  152.580002  2.508921  150.950685  151.063120  149.464763 41.180424 55.445008        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.118371       SALUD     0.910998              15.0           5.0             0.000000       1.902436            10.000000             10.0      5.563429       7.937618      3.803889
  TEVA   34.744999  0.763357   34.940040   33.883518   31.913873 40.231305 52.050539        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.360867       SALUD     1.589892              15.0           0.0             7.823862       0.230800            10.000000             10.0      1.772692       8.791825      3.151795
2026-02-11 22:20:36,143 INFO === RUN PIPELINE START 2026-02-11T21:20:36.143053 UTC ===
2026-02-11 22:20:36,143 INFO Stage=fetch attempt 1/2
2026-02-11 22:20:36,143 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 1_fetch_indicators.py
2026-02-11 22:22:38,011 INFO Salida (1_fetch_indicators.py): returncode=0 (t=121.9s)
2026-02-11 22:22:38,011 WARNING stderr: 2026-02-11 22:20:37,811 INFO Starting fetch for 1147 tickers in batches of 200 (workers=8)
2026-02-11 22:20:37,828 INFO Batch 1/6: downloading 200 tickers (of 200)
2026-02-11 22:20:40,687 ERROR HTTP Error 404: 
2026-02-11 22:20:46,553 ERROR 
33 Failed downloads:
2026-02-11 22:20:46,553 ERROR ['CHK', 'COOP', 'AC', 'ALO', 'BHIA3', 'CPFE3', 'ANTM', 'ADS', 'AIXA', 'BC8', 'CNC.MI', 'AYDEN', 'BBSE3', 'BP.LS', 'BAS', 'CAP', 'AGUA', 'CMIN3', 'AMNB', 'ALFAA', 'CERN', 'BAYN']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-02-11 22:20:46,553 ERROR ['BMW', 'COL', 'AF', 'ANDR', 'AYV', 'CABK', 'BNP', 'ACS', 'CIE', 'CEZ', 'ANA']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-02-11 22:20:48,046 ERROR 
1 Failed download:
2026-02-11 22:20:48,046 ERROR ['AC']: YFPricesMissingError('possibly delisted; no price data found  (period=60d) (Yahoo error = "No data found, symbol may be delisted")')
2026-02-11 22:20:48,049 WARNING No data after 1h fallback for AC
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
A:\pilim\Downloads\Financiero\1_fetch_indicators.py:394: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  df2h = df.resample('2H').agg(agg).dropna(how='any')
2026-02-11 22:20:48,207 ERROR 
1 Failed download:
2026-02-11 22:20:48,207 ERROR ['ACS']: YFPricesMissingError('possibly delisted; no price data found  (period=60d)')
2026-02-11 22:20:48,208 WARNING No data
2026-02-11 22:22:38,011 INFO Stage fetch completado correctamente.
2026-02-11 22:22:38,012 INFO Stage=score attempt 1/2
2026-02-11 22:22:38,013 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 2_score_select.py
2026-02-11 22:22:38,540 INFO Salida (2_score_select.py): returncode=0 (t=0.5s)
2026-02-11 22:22:38,540 WARNING stderr: 2026-02-11 22:22:38,432 WARNING Could not read parquet intermediate/indicators.parquet: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2026-02-11 22:22:38,439 INFO Loaded indicators from csv: intermediate/indicators.csv (rows=1094)
2026-02-11 22:22:38,450 INFO Hard filters (relaxed): total=1094 passed=140 rejected=954 allowed_failures=1 optional_checks=['ema15_above_price', 'ema50_below_price', 'price_above_ema150', 'distance_ok', 'rsi_ok', 'mfi_ok'] enforce_mfi_hard=True
2026-02-11 22:22:38,451 INFO Optional failures distribution (fail_count:rows)={0: 85, 1: 156, 2: 170, 3: 566, 4: 84, 5: 33}
2026-02-11 22:22:38,463 INFO Wrote rejected sample to intermediate\rejected_sample_relaxed.csv
2026-02-11 22:22:38,475 INFO Scoring computed. Score stats: min=11.92 median=49.30 max=74.00
2026-02-11 22:22:38,477 INFO Selected top 5 per sector -> 26 rows
2026-02-11 22:22:38,477 INFO Selected 26 < min_target 40 -> rellenando con top global 14
2026-02-11 22:22:38,488 INFO Wrote selected csv: intermediate/candidates.csv
2026-02-11 22:22:38,492 INFO Wrote sheet-ready CSV: intermediate/candidates.sheet_ready.csv
2026-02-11 22:22:38,492 INFO SUMMARY: total_indicators=1094 passed=140 selected=40 rejected=954
2026-02-11 22:22:38,493 INFO Sector=COMMODITIES -> BCC, ROCK, STX, TREX, CBT, RTX, WMS, ZWS, KMT, EMR
2026-02-11 22:22:38,493 INFO Sector=ENERGIA -> NWE, WHD, MPLX, TTEK, WEC
2026-02-11 22:22:38,493 INFO Sector=ENERGia -> EQT
2026-02-11 22:22:38,493 INFO Sector=FINANCIERO -> PBH, TKO, DG, MLAB, MKL, LBRT, YUM, URI, STT, CRI, ULTA, KMX, SHAK, CNA
2026-02-11 22:22:38,493 INFO Sector=SALUD -> AMGN, POST, IONS, RPRX, BMY
2026-02-11 22:22:38,494 INFO Sector=TECNOLOGÍA -> HSAI, AAPL, AKAM, AIN, NSIT
2026-02-11 22:22:38,540 INFO Stage score completado correctamente.
2026-02-11 22:22:38,540 INFO Stage=export attempt 1/2
2026-02-11 22:22:38,541 INFO Ejecutando: 'C:\Users\pilim\AppData\Local\Programs\Python\Python313\python.exe' 3_export_sheets.py
2026-02-11 22:23:03,208 INFO Salida (3_export_sheets.py): returncode=0 (t=24.7s)
2026-02-11 22:23:03,208 WARNING stderr: 2026-02-11 22:22:39,790 INFO export_sheets: CONFIG: creds_path=creds/gsheets-service.json spreadsheet_id=1e8fOwMOn-EkmsAAdN4Ybo1YS8RcUAHuXZ5SHns2DHTo candidates=intermediate/candidates.sheet_ready.csv sheets=['SALUD', 'ENERGIA', 'COMMODITIES', 'TECNOLOGÍA', 'FINANCIERO']
2026-02-11 22:22:39,791 INFO export_sheets: Leyendo candidates desde: intermediate/candidates.sheet_ready.csv
2026-02-11 22:22:39,795 INFO export_sheets: Usando columna de sector: Sector
2026-02-11 22:22:39,796 INFO export_sheets: Autenticando gspread con creds/gsheets-service.json
2026-02-11 22:22:41,866 INFO export_sheets: Spreadsheet abierto: Trades
2026-02-11 22:22:41,866 INFO export_sheets: Procesando hoja config: 'SALUD'
2026-02-11 22:22:45,402 INFO export_sheets: Escribiendo bloque en 'SALUD' rango A23:H27 (cols=8) filas=5 (tickers: AMGN, POST, IONS, RPRX, BMY)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-11 22:22:46,204 INFO export_sheets: Hoja 'SALUD': escritas 5 filas correctamente (preservando columnas derecha).
2026-02-11 22:22:46,204 INFO export_sheets: Procesando hoja config: 'ENERGIA'
2026-02-11 22:22:48,294 INFO export_sheets: Ticker WEC omitido en 'ENERGÍA' por duplicado reciente.
2026-02-11 22:22:49,718 INFO export_sheets: Escribiendo bloque en 'ENERGÍA' rango A10:H13 (cols=8) filas=4 (tickers: NWE, WHD, MPLX, TTEK)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-11 22:22:50,452 INFO export_sheets: Hoja 'ENERGÍA': escritas 4 filas correctamente (preservando columnas derecha).
2026-02-11 22:22:50,452 INFO export_sheets: Procesando hoja config: 'COMMODITIES'
2026-02-11 22:22:52,702 INFO export_sheets: Ticker CBT omitido en 'COMMODITIES' por duplicado reciente.
2026-02-11 22:22:54,182 INFO export_sheets: Escribiendo bloque en 'COMMODITIES' rango A18:H21 (cols=8) filas=4 (tickers: BCC, ROCK, STX, TREX)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-11 22:22:54,892 INFO export_sheets: Hoja 'COMMODITIES': escritas 4 filas correctamente (preservando columnas derecha).
2026-02-11 22:22:54,892 INFO export_sheets: Procesando hoja config: 'TECNOLOGÍA'
2026-02-11 22:22:58,510 INFO export_sheets: Escribiendo bloque en 'TECNOLOGÍA' rango A25:H29 (cols=8) filas=5 (tickers: HSAI, AAPL, AKAM, AIN, NSIT)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named arguments (range_name=, values=)
  ws.update(range_to_update, merged_rows, value_input_option=cfg.get("append_value_input_option", "USER_ENTERED"))
2026-02-11 22:22:59,206 INFO export_sheets: Hoja 'TECNOLOGÍA': escritas 5 filas correctamente (preservando columnas derecha).
2026-02-11 22:22:59,206 INFO export_sheets: Procesando hoja config: 'FINANCIERO'
2026-02-11 22:23:02,410 INFO export_sheets: Escribiendo bloque en 'FINANCIERO' rango A30:H34 (cols=8) filas=5 (tickers: PBH, TKO, DG, MLAB, MKL)
A:\pilim\Downloads\Financiero\3_export_sheets.py:355: DeprecationWarning: The order of arguments in worksheet.update() has changed. Please pass values first and range_name secondor used named ar
2026-02-11 22:23:03,208 INFO Stage export completado correctamente.
2026-02-11 22:23:03,209 INFO === RUN PIPELINE END 2026-02-11T21:23:03.209202 UTC (duración 147.1 s) ===
2026-02-11 22:23:03,582 INFO Resumen candidatos: total=40 (preview):
2026-02-11 22:23:03,593 INFO TICKER      PRECIO    ATR 2H      EMA 15      EMA 50     EMA 150       MFI       RSI  ENTRADA 1  ENTRADA 2  STOP  TARGET 1  TARGET 2  MONTO  G/P  G/P POT%    _Score      Sector  _sc_rsi_low  _sc_mfi_rsi_soft  _sc_macd_pos  _sc_ema15_close_gap  _sc_atr_score  _sc_ema150_distance  _sc_ema50_below  _sc_fib_soft  _sc_mfi_score  _sc_mfi_diff
   BCC   89.385002  1.192495   89.306571   86.871253   82.185262 35.037941 54.763052        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 69.200840 COMMODITIES     1.047390              15.0           0.0            13.895339       0.532229            10.000000             10.0      0.000000      13.465854      5.260030
  ROCK   54.099998  0.885307   53.895319   53.004140   52.423966 40.704633 55.126869        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 68.650267 COMMODITIES     0.974626              15.0           0.0             8.601724       0.293999            10.000000             10.0     11.568158       8.365830      3.845929
   STX  407.070007 10.590866  410.030397  403.584259  357.803641 42.145451 47.012010        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 66.288190 COMMODITIES     2.597598              15.0           0.0             7.055268       7.820843            10.000000             10.0      5.447637       7.069094      1.297749
  TREX   44.029999  0.610500   44.026853   43.169590   40.578616 39.315195 53.275237        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 65.599955 COMMODITIES     1.344953              15.0           0.0            15.835118       0.080881            10.000000             10.0      0.000000       9.616325      3.722678
   CBT   75.949997  1.099665   75.751537   74.435377   71.381417 49.132828 53.897193        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.956588 COMMODITIES     1.220561              15.0           5.0            10.224873       0.460238            10.000000             10.0      8.999964       0.780455      1.270497
   NWE   68.504997  0.670956   68.342295   68.098210   67.151311 51.588795 51.764238        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.473345     ENERGIA     1.647152              15.0           5.0             8.240223       0.127766            10.000000             10.0      8.411418       0.000000      0.046785
   WHD   57.340000  0.816956   57.299141   56.487998   52.766250 44.795214 51.887215        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.838606     ENERGIA     1.622557              15.0           0.0            14.399550       0.240992            10.000000             10.0      0.000000       4.684308      1.891200
  MPLX   55.689999  0.506207   55.513802   55.459009   54.929385 52.433415 52.870629        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 57.191623     ENERGIA     1.425874              15.0           5.0             4.861714       0.000000            10.000000             10.0     10.787445       0.000000      0.116590
  TTEK   40.450001  0.735699   41.332306   39.835912   37.597604 31.004714 46.146998        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.955316     ENERGIA     2.770600               0.0           0.0             0.000000       0.177975            10.000000             10.0     11.873041      17.095758      4.037942
   WEC  113.120003  0.827501  112.645893  111.400199  109.382618 46.136007 57.513530        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 55.324574     ENERGIA     0.497294              15.0           5.0             0.000000       0.249170            10.000000             10.0      8.066510       3.477594      3.034006
   EQT   56.930000  0.695950   56.244130   55.612199   55.140783 36.430798 58.290561        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.530589     ENERGia     0.341888              15.0           5.0             0.000000       0.147150            10.000000             10.0      0.000000      12.212281      5.829270
   PBH   66.000000  0.945879   65.943660   65.567862   64.256527 39.856348 51.367444        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 73.997753  FINANCIERO     1.726511              15.0           0.0            14.093960       0.340974            10.000000             10.0     10.637395       9.129287      3.069626
   TKO  210.220001  2.833304  210.872016  207.030163  204.145410 40.704180 52.985204        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 67.490074  FINANCIERO     1.402959              15.0           0.0             8.635989       1.804708            10.000000             10.0      9.005240       8.366238      3.274940
    DG  147.169998  1.543931  147.073861  146.592993  141.220691 37.423703 51.038869        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 66.553816  FINANCIERO     1.792226              15.0           0.0            14.007437       0.804775            10.000000             10.0      0.000000      11.318668      3.630711
  MLAB   91.099998  1.669937   91.440034   88.470828   84.555825 27.451592 52.957857        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 66.112926  FINANCIERO     1.408429               0.0           0.0             9.484106       0.902494            10.000000             10.0     11.809793      15.706433      6.801670
   MKL 2099.000000 21.137556 2092.611732 2074.242185 2082.424589 31.949713 54.447838        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 62.525724  FINANCIERO     1.110432               0.0           0.0             6.328845      16.000000             6.841687             10.0      0.000000      16.245259      5.999500
  AMGN  366.450012  4.884979  367.619791  358.766655  345.107101 45.831853 52.012624        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 63.602724       SALUD     1.597475              15.0           0.0             8.337138       3.395820            10.000000             10.0      9.872752       3.751332      1.648205
  POST  110.860001  1.846606  110.401051  106.267223  102.608375 46.536682 57.396762        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 60.333260       SALUD     0.520648              15.0           0.0             8.046819       1.039504            10.000000             10.0      9.713281       3.116986      2.896021
  IONS   84.330002  0.999794   84.082345   83.426631   81.258345 44.179939 51.704207        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 59.075173       SALUD     1.659159              15.0           0.0             8.073351       0.382786            10.000000             10.0      6.715352       5.238055      2.006471
  RPRX   44.259998  0.530714   44.231343   42.965814   41.201042 44.364387 58.081542        NaN        NaN   NaN       NaN       NaN    NaN  NaN       NaN 58.482681       SALUD     0.383692              15.0           0.0            14.272202       0.019006            10.000000             10.0      0.077821       5.072052      3.657908
